var Za=Object.defineProperty;var to=(ke,Fe,Ne)=>Fe in ke?Za(ke,Fe,{enumerable:!0,configurable:!0,writable:!0,value:Ne}):ke[Fe]=Ne;var me=(ke,Fe,Ne)=>(to(ke,typeof Fe!="symbol"?Fe+"":Fe,Ne),Ne),dn=(ke,Fe,Ne)=>{if(!Fe.has(ke))throw TypeError("Cannot "+Ne)};var t=(ke,Fe,Ne)=>(dn(ke,Fe,"read from private field"),Ne?Ne.call(ke):Fe.get(ke)),l=(ke,Fe,Ne)=>{if(Fe.has(ke))throw TypeError("Cannot add the same private member more than once");Fe instanceof WeakSet?Fe.add(ke):Fe.set(ke,Ne)},C=(ke,Fe,Ne,ws)=>(dn(ke,Fe,"write to private field"),ws?ws.call(ke,Ne):Fe.set(ke,Ne),Ne);var us=(ke,Fe,Ne,ws)=>({set _(an){C(ke,Fe,an,Ne)},get _(){return t(ke,Fe,ws)}}),S=(ke,Fe,Ne)=>(dn(ke,Fe,"access private method"),Ne);(async()=>{(function(){const Lt=document.createElement("link").relList;if(Lt&&Lt.supports&&Lt.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))lt(d);new MutationObserver(d=>{for(const et of d)if(et.type==="childList")for(const I of et.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&lt(I)}).observe(document,{childList:!0,subtree:!0});function _t(d){const et={};return d.integrity&&(et.integrity=d.integrity),d.referrerPolicy&&(et.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?et.credentials="include":d.crossOrigin==="anonymous"?et.credentials="omit":et.credentials="same-origin",et}function lt(d){if(d.ep)return;d.ep=!0;const et=_t(d);fetch(d.href,et)}})();const ke=document.querySelectorAll(".drawer"),Fe=document.querySelectorAll(".drawer__dialog"),Ne=document.querySelectorAll('[data-role="drawer"]');Ne.forEach(Lt=>Lt.addEventListener("click",ws)),ke.forEach(Lt=>Lt.addEventListener("click",ws)),Fe.forEach(Lt=>Lt.addEventListener("click",_t=>{_t.stopPropagation()}));function ws(){ke.forEach(Lt=>Lt.classList.toggle("drawer_show")),Ne.forEach(Lt=>Lt.classList.toggle("toggler_show"))}const an=document.querySelectorAll('[data-role="drop-down"]'),Ea=document.querySelectorAll(".drop-down");an.forEach(Lt=>Lt.addEventListener("click",Sa));function Sa(){const Lt=document.querySelector(this.dataset.target);Ea.forEach(_t=>{_t.id!==Lt.id&&_t.classList.remove("drop-down_open")}),Lt.classList.toggle("drop-down_open")}const Ta=document.getElementById("js-modal-area"),Ca=document.querySelectorAll(".modal"),Ma=document.querySelectorAll('[data-role="modal"]'),La=document.querySelectorAll(".modal__dialog");Ca.forEach(Lt=>{Ia(),document.getElementById("js-modal-area").appendChild(Lt)}),Ma.forEach(Lt=>{Lt.addEventListener("click",Pa)}),La.forEach(Lt=>Lt.addEventListener("click",Ra));function Pa(){document.querySelector(this.dataset.target).classList.toggle("modal_open")}function Ra(Lt){Lt.stopPropagation()}function Ia(){if(!Ta){const Lt=document.createElement("div");Lt.setAttribute("id","js-modal-area"),Lt.style.zIndex="100",Lt.style.position="relative",document.body.appendChild(Lt)}}function ka(){const Lt=document.querySelector('[data-role="modal-open"]');Lt&&Lt.dataset.errors!="{}"&&document.querySelector(Lt.dataset.target).classList.add("modal_open")}window.onload=ka,document.querySelectorAll(".password__toggler").forEach(Lt=>Lt.addEventListener("click",Fa));function Fa(){const Lt=document.querySelector(this.dataset.target);Lt.type=Lt.type==="password"?"text":"password"}const Da="modulepreload",Oa=function(Lt){return"/"+Lt},ar={},ps=function(Lt,_t,lt){let d=Promise.resolve();if(_t&&_t.length>0){const et=document.getElementsByTagName("link"),I=document.querySelector("meta[property=csp-nonce]"),Y=(I==null?void 0:I.nonce)||(I==null?void 0:I.getAttribute("nonce"));d=Promise.all(_t.map(gt=>{if(gt=Oa(gt),gt in ar)return;ar[gt]=!0;const X=gt.endsWith(".css"),B=X?'[rel="stylesheet"]':"";if(lt)for(let Q=et.length-1;Q>=0;Q--){const q=et[Q];if(q.href===gt&&(!X||q.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${gt}"]${B}`))return;const D=document.createElement("link");if(D.rel=X?"stylesheet":Da,X||(D.as="script",D.crossOrigin=""),D.href=gt,Y&&D.setAttribute("nonce",Y),document.head.appendChild(D),X)return new Promise((Q,q)=>{D.addEventListener("load",Q),D.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${gt}`)))})}))}return d.then(()=>Lt()).catch(et=>{const I=new Event("vite:preloadError",{cancelable:!0});if(I.payload=et,window.dispatchEvent(I),!I.defaultPrevented)throw et})};var Na={976:(Lt,_t,lt)=>{var ve,Wt,Ps,Me,ur,Se,pr,J,s,n,c,f,o,A,b,y,u,a,h,i,r,g,E,v,k,gr,F,Ni,p,un,H,pn,m,L,N,Z,ct,mt,St,gn,te,Zt,Ae,fe,fr,pe,fn;lt.d(_t,{AnnotationLayer:()=>ge,FreeTextAnnotationElement:()=>Et,InkAnnotationElement:()=>Tt,StampAnnotationElement:()=>le});var d=lt(292),et=lt(419),I=lt(792);function Y(ie){return Math.floor(Math.max(0,Math.min(1,ie))*255).toString(16).padStart(2,"0")}function gt(ie){return Math.max(0,Math.min(255,255*ie))}class X{static CMYK_G([M,x,j,it]){return["G",1-Math.min(1,.3*M+.59*j+.11*x+it)]}static G_CMYK([M]){return["CMYK",0,0,0,1-M]}static G_RGB([M]){return["RGB",M,M,M]}static G_rgb([M]){return M=gt(M),[M,M,M]}static G_HTML([M]){const x=Y(M);return`#${x}${x}${x}`}static RGB_G([M,x,j]){return["G",.3*M+.59*x+.11*j]}static RGB_rgb(M){return M.map(gt)}static RGB_HTML(M){return`#${M.map(Y).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([M,x,j,it]){return["RGB",1-Math.min(1,M+it),1-Math.min(1,j+it),1-Math.min(1,x+it)]}static CMYK_rgb([M,x,j,it]){return[gt(1-Math.min(1,M+it)),gt(1-Math.min(1,j+it)),gt(1-Math.min(1,x+it))]}static CMYK_HTML(M){const x=this.CMYK_RGB(M).slice(1);return this.RGB_HTML(x)}static RGB_CMYK([M,x,j]){const it=1-M,dt=1-x,At=1-j,bt=Math.min(it,dt,At);return["CMYK",it,dt,At,bt]}}var B=lt(284);const D=1e3,Q=9,q=new WeakSet;function R(ie){return{width:ie[2]-ie[0],height:ie[3]-ie[1]}}class K{static create(M){switch(M.data.annotationType){case d.AnnotationType.LINK:return new nt(M);case d.AnnotationType.TEXT:return new vt(M);case d.AnnotationType.WIDGET:switch(M.data.fieldType){case"Tx":return new z(M);case"Btn":return M.data.radioButton?new O(M):M.data.checkBox?new V(M):new st(M);case"Ch":return new ot(M);case"Sig":return new $(M)}return new at(M);case d.AnnotationType.POPUP:return new yt(M);case d.AnnotationType.FREETEXT:return new Et(M);case d.AnnotationType.LINE:return new Ot(M);case d.AnnotationType.SQUARE:return new Mt(M);case d.AnnotationType.CIRCLE:return new Bt(M);case d.AnnotationType.POLYLINE:return new jt(M);case d.AnnotationType.CARET:return new ht(M);case d.AnnotationType.INK:return new Tt(M);case d.AnnotationType.POLYGON:return new Jt(M);case d.AnnotationType.HIGHLIGHT:return new Vt(M);case d.AnnotationType.UNDERLINE:return new Ut(M);case d.AnnotationType.SQUIGGLY:return new ee(M);case d.AnnotationType.STRIKEOUT:return new ne(M);case d.AnnotationType.STAMP:return new le(M);case d.AnnotationType.FILEATTACHMENT:return new Ce(M);default:return new W(M)}}}const be=class be{constructor(M,{isRenderable:x=!1,ignoreBorder:j=!1,createQuadrilaterals:it=!1}={}){l(this,ve,!1);this.isRenderable=x,this.data=M.data,this.layer=M.layer,this.linkService=M.linkService,this.downloadManager=M.downloadManager,this.imageResourcesPath=M.imageResourcesPath,this.renderForms=M.renderForms,this.svgFactory=M.svgFactory,this.annotationStorage=M.annotationStorage,this.enableScripting=M.enableScripting,this.hasJSActions=M.hasJSActions,this._fieldObjects=M.fieldObjects,this.parent=M.parent,x&&(this.container=this._createContainer(j)),it&&this._createQuadrilaterals()}static _hasPopupData({titleObj:M,contentsObj:x,richText:j}){return!!(M!=null&&M.str||x!=null&&x.str||j!=null&&j.str)}get hasPopupData(){return be._hasPopupData(this.data)}_createContainer(M){const{data:x,parent:{page:j,viewport:it}}=this,dt=document.createElement("section");dt.setAttribute("data-annotation-id",x.id),this instanceof at||(dt.tabIndex=D),dt.style.zIndex=this.parent.zIndex++,x.popupRef&&dt.setAttribute("aria-haspopup","dialog"),x.alternativeText&&(dt.title=x.alternativeText),x.noRotate&&dt.classList.add("norotate");const{pageWidth:At,pageHeight:bt,pageX:zt,pageY:Nt}=it.rawDims;if(!x.rect||this instanceof yt){const{rotation:kt}=x;return!x.hasOwnCanvas&&kt!==0&&this.setRotation(kt,dt),dt}const{width:Pt,height:Kt}=R(x.rect),Dt=d.Util.normalizeRect([x.rect[0],j.view[3]-x.rect[1]+j.view[1],x.rect[2],j.view[3]-x.rect[3]+j.view[1]]);if(!M&&x.borderStyle.width>0){dt.style.borderWidth=`${x.borderStyle.width}px`;const kt=x.borderStyle.horizontalCornerRadius,Yt=x.borderStyle.verticalCornerRadius;if(kt>0||Yt>0){const he=`calc(${kt}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;dt.style.borderRadius=he}else if(this instanceof O){const he=`calc(${Pt}px * var(--scale-factor)) / calc(${Kt}px * var(--scale-factor))`;dt.style.borderRadius=he}switch(x.borderStyle.style){case d.AnnotationBorderStyleType.SOLID:dt.style.borderStyle="solid";break;case d.AnnotationBorderStyleType.DASHED:dt.style.borderStyle="dashed";break;case d.AnnotationBorderStyleType.BEVELED:(0,d.warn)("Unimplemented border style: beveled");break;case d.AnnotationBorderStyleType.INSET:(0,d.warn)("Unimplemented border style: inset");break;case d.AnnotationBorderStyleType.UNDERLINE:dt.style.borderBottomStyle="solid";break}const ce=x.borderColor||null;ce?(C(this,ve,!0),dt.style.borderColor=d.Util.makeHexColor(ce[0]|0,ce[1]|0,ce[2]|0)):dt.style.borderWidth=0}dt.style.left=`${100*(Dt[0]-zt)/At}%`,dt.style.top=`${100*(Dt[1]-Nt)/bt}%`;const{rotation:wt}=x;return x.hasOwnCanvas||wt===0?(dt.style.width=`${100*Pt/At}%`,dt.style.height=`${100*Kt/bt}%`):this.setRotation(wt,dt),dt}setRotation(M,x=this.container){if(!this.data.rect)return;const{pageWidth:j,pageHeight:it}=this.parent.viewport.rawDims,{width:dt,height:At}=R(this.data.rect);let bt,zt;M%180===0?(bt=100*dt/j,zt=100*At/it):(bt=100*At/j,zt=100*dt/it),x.style.width=`${bt}%`,x.style.height=`${zt}%`,x.setAttribute("data-main-rotation",(360-M)%360)}get _commonActions(){const M=(x,j,it)=>{const dt=it.detail[x],At=dt[0],bt=dt.slice(1);it.target.style[j]=X[`${At}_HTML`](bt),this.annotationStorage.setValue(this.data.id,{[j]:X[`${At}_rgb`](bt)})};return(0,d.shadow)(this,"_commonActions",{display:x=>{const{display:j}=x.detail,it=j%2===1;this.container.style.visibility=it?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:it,noPrint:j===1||j===2})},print:x=>{this.annotationStorage.setValue(this.data.id,{noPrint:!x.detail.print})},hidden:x=>{const{hidden:j}=x.detail;this.container.style.visibility=j?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:j,noView:j})},focus:x=>{setTimeout(()=>x.target.focus({preventScroll:!1}),0)},userName:x=>{x.target.title=x.detail.userName},readonly:x=>{x.target.disabled=x.detail.readonly},required:x=>{this._setRequired(x.target,x.detail.required)},bgColor:x=>{M("bgColor","backgroundColor",x)},fillColor:x=>{M("fillColor","backgroundColor",x)},fgColor:x=>{M("fgColor","color",x)},textColor:x=>{M("textColor","color",x)},borderColor:x=>{M("borderColor","borderColor",x)},strokeColor:x=>{M("strokeColor","borderColor",x)},rotation:x=>{const j=x.detail.rotation;this.setRotation(j),this.annotationStorage.setValue(this.data.id,{rotation:j})}})}_dispatchEventFromSandbox(M,x){var it;const j=this._commonActions;for(const dt of Object.keys(x.detail))(it=M[dt]||j[dt])==null||it(x)}_setDefaultPropertiesFromJS(M){if(!this.enableScripting)return;const x=this.annotationStorage.getRawValue(this.data.id);if(!x)return;const j=this._commonActions;for(const[it,dt]of Object.entries(x)){const At=j[it];if(At){const bt={detail:{[it]:dt},target:M};At(bt),delete x[it]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:M}=this.data;if(!M)return;const[x,j,it,dt]=this.data.rect;if(M.length===1){const[,{x:Yt,y:ce},{x:he,y:_e}]=M[0];if(it===Yt&&dt===ce&&x===he&&j===_e)return}const{style:At}=this.container;let bt;if(t(this,ve)){const{borderColor:Yt,borderWidth:ce}=At;At.borderWidth=0,bt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Yt}" stroke-width="${ce}">`],this.container.classList.add("hasBorder")}const zt=it-x,Nt=dt-j,{svgFactory:Pt}=this,Kt=Pt.createElement("svg");Kt.classList.add("quadrilateralsContainer"),Kt.setAttribute("width",0),Kt.setAttribute("height",0);const Dt=Pt.createElement("defs");Kt.append(Dt);const wt=Pt.createElement("clipPath"),kt=`clippath_${this.data.id}`;wt.setAttribute("id",kt),wt.setAttribute("clipPathUnits","objectBoundingBox"),Dt.append(wt);for(const[,{x:Yt,y:ce},{x:he,y:_e}]of M){const Te=Pt.createElement("rect"),Je=(he-x)/zt,We=(dt-ce)/Nt,je=(Yt-he)/zt,Ze=(ce-_e)/Nt;Te.setAttribute("x",Je),Te.setAttribute("y",We),Te.setAttribute("width",je),Te.setAttribute("height",Ze),wt.append(Te),bt==null||bt.push(`<rect vector-effect="non-scaling-stroke" x="${Je}" y="${We}" width="${je}" height="${Ze}"/>`)}t(this,ve)&&(bt.push("</g></svg>')"),At.backgroundImage=bt.join("")),this.container.append(Kt),this.container.style.clipPath=`url(#${kt})`}_createPopup(){const{container:M,data:x}=this;M.setAttribute("aria-haspopup","dialog");const j=new yt({data:{color:x.color,titleObj:x.titleObj,modificationDate:x.modificationDate,contentsObj:x.contentsObj,richText:x.richText,parentRect:x.rect,borderStyle:0,id:`popup_${x.id}`,rotation:x.rotation},parent:this.parent,elements:[this]});this.parent.div.append(j.render())}render(){(0,d.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(M,x=null){const j=[];if(this._fieldObjects){const it=this._fieldObjects[M];if(it)for(const{page:dt,id:At,exportValues:bt}of it){if(dt===-1||At===x)continue;const zt=typeof bt=="string"?bt:null,Nt=document.querySelector(`[data-element-id="${At}"]`);if(Nt&&!q.has(Nt)){(0,d.warn)(`_getElementsByName - element not allowed: ${At}`);continue}j.push({id:At,exportValue:zt,domElement:Nt})}return j}for(const it of document.getElementsByName(M)){const{exportValue:dt}=it,At=it.getAttribute("data-element-id");At!==x&&q.has(it)&&j.push({id:At,exportValue:dt,domElement:it})}return j}show(){var M;this.container&&(this.container.hidden=!1),(M=this.popup)==null||M.maybeShow()}hide(){var M;this.container&&(this.container.hidden=!0),(M=this.popup)==null||M.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const M=this.getElementsToTriggerPopup();if(Array.isArray(M))for(const x of M)x.classList.add("highlightArea");else M.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:M,data:{id:x}}=this;this.container.addEventListener("dblclick",()=>{var j;(j=this.linkService.eventBus)==null||j.dispatch("switchannotationeditormode",{source:this,mode:M,editId:x})})}};ve=new WeakMap;let W=be;class nt extends W{constructor(x,j=null){super(x,{isRenderable:!0,ignoreBorder:!!(j!=null&&j.ignoreBorder),createQuadrilaterals:!0});l(this,Wt);l(this,Me);l(this,Se);this.isTooltipOnly=x.data.isTooltipOnly}render(){const{data:x,linkService:j}=this,it=document.createElement("a");it.setAttribute("data-element-id",x.id);let dt=!1;return x.url?(j.addLinkAttributes(it,x.url,x.newWindow),dt=!0):x.action?(this._bindNamedAction(it,x.action),dt=!0):x.attachment?(S(this,Me,ur).call(this,it,x.attachment,x.attachmentDest),dt=!0):x.setOCGState?(S(this,Se,pr).call(this,it,x.setOCGState),dt=!0):x.dest?(this._bindLink(it,x.dest),dt=!0):(x.actions&&(x.actions.Action||x.actions["Mouse Up"]||x.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(it,x),dt=!0),x.resetForm?(this._bindResetFormAction(it,x.resetForm),dt=!0):this.isTooltipOnly&&!dt&&(this._bindLink(it,""),dt=!0)),this.container.classList.add("linkAnnotation"),dt&&this.container.append(it),this.container}_bindLink(x,j){x.href=this.linkService.getDestinationHash(j),x.onclick=()=>(j&&this.linkService.goToDestination(j),!1),(j||j==="")&&S(this,Wt,Ps).call(this)}_bindNamedAction(x,j){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeNamedAction(j),!1),S(this,Wt,Ps).call(this)}_bindJSAction(x,j){x.href=this.linkService.getAnchorUrl("");const it=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const dt of Object.keys(j.actions)){const At=it.get(dt);At&&(x[At]=()=>{var bt;return(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:j.id,name:dt}}),!1})}x.onclick||(x.onclick=()=>!1),S(this,Wt,Ps).call(this)}_bindResetFormAction(x,j){const it=x.onclick;if(it||(x.href=this.linkService.getAnchorUrl("")),S(this,Wt,Ps).call(this),!this._fieldObjects){(0,d.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),it||(x.onclick=()=>!1);return}x.onclick=()=>{var Kt;it==null||it();const{fields:dt,refs:At,include:bt}=j,zt=[];if(dt.length!==0||At.length!==0){const Dt=new Set(At);for(const wt of dt){const kt=this._fieldObjects[wt]||[];for(const{id:Yt}of kt)Dt.add(Yt)}for(const wt of Object.values(this._fieldObjects))for(const kt of wt)Dt.has(kt.id)===bt&&zt.push(kt)}else for(const Dt of Object.values(this._fieldObjects))zt.push(...Dt);const Nt=this.annotationStorage,Pt=[];for(const Dt of zt){const{id:wt}=Dt;switch(Pt.push(wt),Dt.type){case"text":{const Yt=Dt.defaultValue||"";Nt.setValue(wt,{value:Yt});break}case"checkbox":case"radiobutton":{const Yt=Dt.defaultValue===Dt.exportValues;Nt.setValue(wt,{value:Yt});break}case"combobox":case"listbox":{const Yt=Dt.defaultValue||"";Nt.setValue(wt,{value:Yt});break}default:continue}const kt=document.querySelector(`[data-element-id="${wt}"]`);if(kt){if(!q.has(kt)){(0,d.warn)(`_bindResetFormAction - element not allowed: ${wt}`);continue}}else continue;kt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Kt=this.linkService.eventBus)==null||Kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Pt,name:"ResetForm"}})),!1}}}Wt=new WeakSet,Ps=function(){this.container.setAttribute("data-internal-link","")},Me=new WeakSet,ur=function(x,j,it=null){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>{var dt;return(dt=this.downloadManager)==null||dt.openOrDownloadData(j.content,j.filename,it),!1},S(this,Wt,Ps).call(this)},Se=new WeakSet,pr=function(x,j){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeSetOCGState(j),!1),S(this,Wt,Ps).call(this)};class vt extends W{constructor(M){super(M,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const M=document.createElement("img");return M.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",M.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),M.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(M),this.container}}class at extends W{render(){return this.container}showElementAndHideCanvas(M){var x;this.data.hasOwnCanvas&&(((x=M.previousSibling)==null?void 0:x.nodeName)==="CANVAS"&&(M.previousSibling.hidden=!0),M.hidden=!1)}_getKeyModifier(M){return d.FeatureTest.platform.isMac?M.metaKey:M.ctrlKey}_setEventListener(M,x,j,it,dt){j.includes("mouse")?M.addEventListener(j,At=>{var bt;(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:dt(At),shift:At.shiftKey,modifier:this._getKeyModifier(At)}})}):M.addEventListener(j,At=>{var bt;if(j==="blur"){if(!x.focused||!At.relatedTarget)return;x.focused=!1}else if(j==="focus"){if(x.focused)return;x.focused=!0}dt&&((bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:it,value:dt(At)}}))})}_setEventListeners(M,x,j,it){var dt,At,bt;for(const[zt,Nt]of j)(Nt==="Action"||(dt=this.data.actions)!=null&&dt[Nt])&&((Nt==="Focus"||Nt==="Blur")&&(x||(x={focused:!1})),this._setEventListener(M,x,zt,Nt,it),Nt==="Focus"&&!((At=this.data.actions)!=null&&At.Blur)?this._setEventListener(M,x,"blur","Blur",null):Nt==="Blur"&&!((bt=this.data.actions)!=null&&bt.Focus)&&this._setEventListener(M,x,"focus","Focus",null))}_setBackgroundColor(M){const x=this.data.backgroundColor||null;M.style.backgroundColor=x===null?"transparent":d.Util.makeHexColor(x[0],x[1],x[2])}_setTextStyle(M){const x=["left","center","right"],{fontColor:j}=this.data.defaultAppearanceData,it=this.data.defaultAppearanceData.fontSize||Q,dt=M.style;let At;const bt=2,zt=Nt=>Math.round(10*Nt)/10;if(this.data.multiLine){const Nt=Math.abs(this.data.rect[3]-this.data.rect[1]-bt),Pt=Math.round(Nt/(d.LINE_FACTOR*it))||1,Kt=Nt/Pt;At=Math.min(it,zt(Kt/d.LINE_FACTOR))}else{const Nt=Math.abs(this.data.rect[3]-this.data.rect[1]-bt);At=Math.min(it,zt(Nt/d.LINE_FACTOR))}dt.fontSize=`calc(${At}px * var(--scale-factor))`,dt.color=d.Util.makeHexColor(j[0],j[1],j[2]),this.data.textAlignment!==null&&(dt.textAlign=x[this.data.textAlignment])}_setRequired(M,x){x?M.setAttribute("required",!0):M.removeAttribute("required"),M.setAttribute("aria-required",x)}}class z extends at{constructor(M){const x=M.renderForms||M.data.hasOwnCanvas||!M.data.hasAppearance&&!!M.data.fieldValue;super(M,{isRenderable:x})}setPropertyOnSiblings(M,x,j,it){const dt=this.annotationStorage;for(const At of this._getElementsByName(M.name,M.id))At.domElement&&(At.domElement[x]=j),dt.setValue(At.id,{[it]:j})}render(){var it,dt;const M=this.annotationStorage,x=this.data.id;this.container.classList.add("textWidgetAnnotation");let j=null;if(this.renderForms){const At=M.getValue(x,{value:this.data.fieldValue});let bt=At.value||"";const zt=M.getValue(x,{charLimit:this.data.maxLen}).charLimit;zt&&bt.length>zt&&(bt=bt.slice(0,zt));let Nt=At.formattedValue||((it=this.data.textContent)==null?void 0:it.join(`
`))||null;Nt&&this.data.comb&&(Nt=Nt.replaceAll(/\s+/g,""));const Pt={userValue:bt,formattedValue:Nt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(j=document.createElement("textarea"),j.textContent=Nt??bt,this.data.doNotScroll&&(j.style.overflowY="hidden")):(j=document.createElement("input"),j.type="text",j.setAttribute("value",Nt??bt),this.data.doNotScroll&&(j.style.overflowX="hidden")),this.data.hasOwnCanvas&&(j.hidden=!0),q.add(j),j.setAttribute("data-element-id",x),j.disabled=this.data.readOnly,j.name=this.data.fieldName,j.tabIndex=D,this._setRequired(j,this.data.required),zt&&(j.maxLength=zt),j.addEventListener("input",Dt=>{M.setValue(x,{value:Dt.target.value}),this.setPropertyOnSiblings(j,"value",Dt.target.value,"value"),Pt.formattedValue=null}),j.addEventListener("resetform",Dt=>{const wt=this.data.defaultFieldValue??"";j.value=Pt.userValue=wt,Pt.formattedValue=null});let Kt=Dt=>{const{formattedValue:wt}=Pt;wt!=null&&(Dt.target.value=wt),Dt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){j.addEventListener("focus",wt=>{var Yt;if(Pt.focused)return;const{target:kt}=wt;Pt.userValue&&(kt.value=Pt.userValue),Pt.lastCommittedValue=kt.value,Pt.commitKey=1,(Yt=this.data.actions)!=null&&Yt.Focus||(Pt.focused=!0)}),j.addEventListener("updatefromsandbox",wt=>{this.showElementAndHideCanvas(wt.target);const kt={value(Yt){Pt.userValue=Yt.detail.value??"",M.setValue(x,{value:Pt.userValue.toString()}),Yt.target.value=Pt.userValue},formattedValue(Yt){const{formattedValue:ce}=Yt.detail;Pt.formattedValue=ce,ce!=null&&Yt.target!==document.activeElement&&(Yt.target.value=ce),M.setValue(x,{formattedValue:ce})},selRange(Yt){Yt.target.setSelectionRange(...Yt.detail.selRange)},charLimit:Yt=>{var Te;const{charLimit:ce}=Yt.detail,{target:he}=Yt;if(ce===0){he.removeAttribute("maxLength");return}he.setAttribute("maxLength",ce);let _e=Pt.userValue;!_e||_e.length<=ce||(_e=_e.slice(0,ce),he.value=Pt.userValue=_e,M.setValue(x,{value:_e}),(Te=this.linkService.eventBus)==null||Te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:_e,willCommit:!0,commitKey:1,selStart:he.selectionStart,selEnd:he.selectionEnd}}))}};this._dispatchEventFromSandbox(kt,wt)}),j.addEventListener("keydown",wt=>{var ce;Pt.commitKey=1;let kt=-1;if(wt.key==="Escape"?kt=0:wt.key==="Enter"&&!this.data.multiLine?kt=2:wt.key==="Tab"&&(Pt.commitKey=3),kt===-1)return;const{value:Yt}=wt.target;Pt.lastCommittedValue!==Yt&&(Pt.lastCommittedValue=Yt,Pt.userValue=Yt,(ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Yt,willCommit:!0,commitKey:kt,selStart:wt.target.selectionStart,selEnd:wt.target.selectionEnd}}))});const Dt=Kt;Kt=null,j.addEventListener("blur",wt=>{var Yt,ce;if(!Pt.focused||!wt.relatedTarget)return;(Yt=this.data.actions)!=null&&Yt.Blur||(Pt.focused=!1);const{value:kt}=wt.target;Pt.userValue=kt,Pt.lastCommittedValue!==kt&&((ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:kt,willCommit:!0,commitKey:Pt.commitKey,selStart:wt.target.selectionStart,selEnd:wt.target.selectionEnd}})),Dt(wt)}),(dt=this.data.actions)!=null&&dt.Keystroke&&j.addEventListener("beforeinput",wt=>{var We;Pt.lastCommittedValue=null;const{data:kt,target:Yt}=wt,{value:ce,selectionStart:he,selectionEnd:_e}=Yt;let Te=he,Je=_e;switch(wt.inputType){case"deleteWordBackward":{const je=ce.substring(0,he).match(/\w*[^\w]*$/);je&&(Te-=je[0].length);break}case"deleteWordForward":{const je=ce.substring(he).match(/^[^\w]*\w*/);je&&(Je+=je[0].length);break}case"deleteContentBackward":he===_e&&(Te-=1);break;case"deleteContentForward":he===_e&&(Je+=1);break}wt.preventDefault(),(We=this.linkService.eventBus)==null||We.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:ce,change:kt||"",willCommit:!1,selStart:Te,selEnd:Je}})}),this._setEventListeners(j,Pt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.value)}if(Kt&&j.addEventListener("blur",Kt),this.data.comb){const Dt=(this.data.rect[2]-this.data.rect[0])/zt;j.classList.add("comb"),j.style.letterSpacing=`calc(${Dt}px * var(--scale-factor) - 1ch)`}}else j=document.createElement("div"),j.textContent=this.data.fieldValue,j.style.verticalAlign="middle",j.style.display="table-cell",this.data.hasOwnCanvas&&(j.hidden=!0);return this._setTextStyle(j),this._setBackgroundColor(j),this._setDefaultPropertiesFromJS(j),this.container.append(j),this.container}}class $ extends at{constructor(M){super(M,{isRenderable:!!M.data.hasOwnCanvas})}}class V extends at{constructor(M){super(M,{isRenderable:M.renderForms})}render(){const M=this.annotationStorage,x=this.data,j=x.id;let it=M.getValue(j,{value:x.exportValue===x.fieldValue}).value;typeof it=="string"&&(it=it!=="Off",M.setValue(j,{value:it})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const dt=document.createElement("input");return q.add(dt),dt.setAttribute("data-element-id",j),dt.disabled=x.readOnly,this._setRequired(dt,this.data.required),dt.type="checkbox",dt.name=x.fieldName,it&&dt.setAttribute("checked",!0),dt.setAttribute("exportValue",x.exportValue),dt.tabIndex=D,dt.addEventListener("change",At=>{const{name:bt,checked:zt}=At.target;for(const Nt of this._getElementsByName(bt,j)){const Pt=zt&&Nt.exportValue===x.exportValue;Nt.domElement&&(Nt.domElement.checked=Pt),M.setValue(Nt.id,{value:Pt})}M.setValue(j,{value:zt})}),dt.addEventListener("resetform",At=>{const bt=x.defaultFieldValue||"Off";At.target.checked=bt===x.exportValue}),this.enableScripting&&this.hasJSActions&&(dt.addEventListener("updatefromsandbox",At=>{const bt={value(zt){zt.target.checked=zt.detail.value!=="Off",M.setValue(j,{value:zt.target.checked})}};this._dispatchEventFromSandbox(bt,At)}),this._setEventListeners(dt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],At=>At.target.checked)),this._setBackgroundColor(dt),this._setDefaultPropertiesFromJS(dt),this.container.append(dt),this.container}}class O extends at{constructor(M){super(M,{isRenderable:M.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const M=this.annotationStorage,x=this.data,j=x.id;let it=M.getValue(j,{value:x.fieldValue===x.buttonValue}).value;if(typeof it=="string"&&(it=it!==x.buttonValue,M.setValue(j,{value:it})),it)for(const At of this._getElementsByName(x.fieldName,j))M.setValue(At.id,{value:!1});const dt=document.createElement("input");if(q.add(dt),dt.setAttribute("data-element-id",j),dt.disabled=x.readOnly,this._setRequired(dt,this.data.required),dt.type="radio",dt.name=x.fieldName,it&&dt.setAttribute("checked",!0),dt.tabIndex=D,dt.addEventListener("change",At=>{const{name:bt,checked:zt}=At.target;for(const Nt of this._getElementsByName(bt,j))M.setValue(Nt.id,{value:!1});M.setValue(j,{value:zt})}),dt.addEventListener("resetform",At=>{const bt=x.defaultFieldValue;At.target.checked=bt!=null&&bt===x.buttonValue}),this.enableScripting&&this.hasJSActions){const At=x.buttonValue;dt.addEventListener("updatefromsandbox",bt=>{const zt={value:Nt=>{const Pt=At===Nt.detail.value;for(const Kt of this._getElementsByName(Nt.target.name)){const Dt=Pt&&Kt.id===j;Kt.domElement&&(Kt.domElement.checked=Dt),M.setValue(Kt.id,{value:Dt})}}};this._dispatchEventFromSandbox(zt,bt)}),this._setEventListeners(dt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],bt=>bt.target.checked)}return this._setBackgroundColor(dt),this._setDefaultPropertiesFromJS(dt),this.container.append(dt),this.container}}class st extends nt{constructor(M){super(M,{ignoreBorder:M.data.hasAppearance})}render(){const M=super.render();M.classList.add("buttonWidgetAnnotation","pushButton");const x=M.lastChild;return this.enableScripting&&this.hasJSActions&&x&&(this._setDefaultPropertiesFromJS(x),x.addEventListener("updatefromsandbox",j=>{this._dispatchEventFromSandbox({},j)})),M}}class ot extends at{constructor(M){super(M,{isRenderable:M.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const M=this.annotationStorage,x=this.data.id,j=M.getValue(x,{value:this.data.fieldValue}),it=document.createElement("select");q.add(it),it.setAttribute("data-element-id",x),it.disabled=this.data.readOnly,this._setRequired(it,this.data.required),it.name=this.data.fieldName,it.tabIndex=D;let dt=this.data.combo&&this.data.options.length>0;this.data.combo||(it.size=this.data.options.length,this.data.multiSelect&&(it.multiple=!0)),it.addEventListener("resetform",Pt=>{const Kt=this.data.defaultFieldValue;for(const Dt of it.options)Dt.selected=Dt.value===Kt});for(const Pt of this.data.options){const Kt=document.createElement("option");Kt.textContent=Pt.displayValue,Kt.value=Pt.exportValue,j.value.includes(Pt.exportValue)&&(Kt.setAttribute("selected",!0),dt=!1),it.append(Kt)}let At=null;if(dt){const Pt=document.createElement("option");Pt.value=" ",Pt.setAttribute("hidden",!0),Pt.setAttribute("selected",!0),it.prepend(Pt),At=()=>{Pt.remove(),it.removeEventListener("input",At),At=null},it.addEventListener("input",At)}const bt=Pt=>{const Kt=Pt?"value":"textContent",{options:Dt,multiple:wt}=it;return wt?Array.prototype.filter.call(Dt,kt=>kt.selected).map(kt=>kt[Kt]):Dt.selectedIndex===-1?null:Dt[Dt.selectedIndex][Kt]};let zt=bt(!1);const Nt=Pt=>{const Kt=Pt.target.options;return Array.prototype.map.call(Kt,Dt=>({displayValue:Dt.textContent,exportValue:Dt.value}))};return this.enableScripting&&this.hasJSActions?(it.addEventListener("updatefromsandbox",Pt=>{const Kt={value(Dt){At==null||At();const wt=Dt.detail.value,kt=new Set(Array.isArray(wt)?wt:[wt]);for(const Yt of it.options)Yt.selected=kt.has(Yt.value);M.setValue(x,{value:bt(!0)}),zt=bt(!1)},multipleSelection(Dt){it.multiple=!0},remove(Dt){const wt=it.options,kt=Dt.detail.remove;wt[kt].selected=!1,it.remove(kt),wt.length>0&&Array.prototype.findIndex.call(wt,Yt=>Yt.selected)===-1&&(wt[0].selected=!0),M.setValue(x,{value:bt(!0),items:Nt(Dt)}),zt=bt(!1)},clear(Dt){for(;it.length!==0;)it.remove(0);M.setValue(x,{value:null,items:[]}),zt=bt(!1)},insert(Dt){const{index:wt,displayValue:kt,exportValue:Yt}=Dt.detail.insert,ce=it.children[wt],he=document.createElement("option");he.textContent=kt,he.value=Yt,ce?ce.before(he):it.append(he),M.setValue(x,{value:bt(!0),items:Nt(Dt)}),zt=bt(!1)},items(Dt){const{items:wt}=Dt.detail;for(;it.length!==0;)it.remove(0);for(const kt of wt){const{displayValue:Yt,exportValue:ce}=kt,he=document.createElement("option");he.textContent=Yt,he.value=ce,it.append(he)}it.options.length>0&&(it.options[0].selected=!0),M.setValue(x,{value:bt(!0),items:Nt(Dt)}),zt=bt(!1)},indices(Dt){const wt=new Set(Dt.detail.indices);for(const kt of Dt.target.options)kt.selected=wt.has(kt.index);M.setValue(x,{value:bt(!0)}),zt=bt(!1)},editable(Dt){Dt.target.disabled=!Dt.detail.editable}};this._dispatchEventFromSandbox(Kt,Pt)}),it.addEventListener("input",Pt=>{var Dt;const Kt=bt(!0);M.setValue(x,{value:Kt}),Pt.preventDefault(),(Dt=this.linkService.eventBus)==null||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:zt,changeEx:Kt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(it,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Pt=>Pt.target.value)):it.addEventListener("input",function(Pt){M.setValue(x,{value:bt(!0)})}),this.data.combo&&this._setTextStyle(it),this._setBackgroundColor(it),this._setDefaultPropertiesFromJS(it),this.container.append(it),this.container}}class yt extends W{constructor(M){const{data:x,elements:j}=M;super(M,{isRenderable:W._hasPopupData(x)}),this.elements=j}render(){this.container.classList.add("popupAnnotation");const M=new It({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),x=[];for(const j of this.elements)j.popup=M,x.push(j.data.id),j.addHighlightArea();return this.container.setAttribute("aria-controls",x.map(j=>`${d.AnnotationPrefix}${j}`).join(",")),this.container}}class It{constructor({container:M,color:x,elements:j,titleObj:it,modificationDate:dt,contentsObj:At,richText:bt,parent:zt,rect:Nt,parentRect:Pt,open:Kt}){l(this,k);l(this,F);l(this,p);l(this,H);l(this,J,S(this,k,gr).bind(this));l(this,s,S(this,H,pn).bind(this));l(this,n,S(this,p,un).bind(this));l(this,c,S(this,F,Ni).bind(this));l(this,f,null);l(this,o,null);l(this,A,null);l(this,b,null);l(this,y,null);l(this,u,null);l(this,a,null);l(this,h,!1);l(this,i,null);l(this,r,null);l(this,g,null);l(this,E,null);l(this,v,!1);var Dt;C(this,o,M),C(this,E,it),C(this,A,At),C(this,g,bt),C(this,u,zt),C(this,f,x),C(this,r,Nt),C(this,a,Pt),C(this,y,j),C(this,b,et.PDFDateString.toDateObject(dt)),this.trigger=j.flatMap(wt=>wt.getElementsToTriggerPopup());for(const wt of this.trigger)wt.addEventListener("click",t(this,c)),wt.addEventListener("mouseenter",t(this,n)),wt.addEventListener("mouseleave",t(this,s)),wt.classList.add("popupTriggerArea");for(const wt of j)(Dt=wt.container)==null||Dt.addEventListener("keydown",t(this,J));t(this,o).hidden=!0,Kt&&S(this,F,Ni).call(this)}render(){if(t(this,i))return;const{page:{view:M},viewport:{rawDims:{pageWidth:x,pageHeight:j,pageX:it,pageY:dt}}}=t(this,u),At=C(this,i,document.createElement("div"));if(At.className="popup",t(this,f)){const _e=At.style.outlineColor=d.Util.makeHexColor(...t(this,f));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?At.style.backgroundColor=`color-mix(in srgb, ${_e} 30%, white)`:At.style.backgroundColor=d.Util.makeHexColor(...t(this,f).map(Te=>Math.floor(.7*(255-Te)+Te)))}const bt=document.createElement("span");bt.className="header";const zt=document.createElement("h1");if(bt.append(zt),{dir:zt.dir,str:zt.textContent}=t(this,E),At.append(bt),t(this,b)){const _e=document.createElement("span");_e.classList.add("popupDate"),_e.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),_e.setAttribute("data-l10n-args",JSON.stringify({date:t(this,b).toLocaleDateString(),time:t(this,b).toLocaleTimeString()})),bt.append(_e)}const Nt=t(this,A),Pt=t(this,g);if(Pt!=null&&Pt.str&&(!(Nt!=null&&Nt.str)||Nt.str===Pt.str))B.XfaLayer.render({xfaHtml:Pt.html,intent:"richText",div:At}),At.lastChild.classList.add("richText","popupContent");else{const _e=this._formatContents(Nt);At.append(_e)}let Kt=!!t(this,a),Dt=Kt?t(this,a):t(this,r);for(const _e of t(this,y))if(!Dt||d.Util.intersect(_e.data.rect,Dt)!==null){Dt=_e.data.rect,Kt=!0;break}const wt=d.Util.normalizeRect([Dt[0],M[3]-Dt[1]+M[1],Dt[2],M[3]-Dt[3]+M[1]]),kt=Kt?Dt[2]-Dt[0]+5:0,Yt=wt[0]+kt,ce=wt[1],{style:he}=t(this,o);he.left=`${100*(Yt-it)/x}%`,he.top=`${100*(ce-dt)/j}%`,t(this,o).append(At)}_formatContents({str:M,dir:x}){const j=document.createElement("p");j.classList.add("popupContent"),j.dir=x;const it=M.split(/(?:\r\n?|\n)/);for(let dt=0,At=it.length;dt<At;++dt){const bt=it[dt];j.append(document.createTextNode(bt)),dt<At-1&&j.append(document.createElement("br"))}return j}forceHide(){C(this,v,this.isVisible),t(this,v)&&(t(this,o).hidden=!0)}maybeShow(){t(this,v)&&(C(this,v,!1),t(this,o).hidden=!1)}get isVisible(){return t(this,o).hidden===!1}}J=new WeakMap,s=new WeakMap,n=new WeakMap,c=new WeakMap,f=new WeakMap,o=new WeakMap,A=new WeakMap,b=new WeakMap,y=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,i=new WeakMap,r=new WeakMap,g=new WeakMap,E=new WeakMap,v=new WeakMap,k=new WeakSet,gr=function(M){M.altKey||M.shiftKey||M.ctrlKey||M.metaKey||(M.key==="Enter"||M.key==="Escape"&&t(this,h))&&S(this,F,Ni).call(this)},F=new WeakSet,Ni=function(){C(this,h,!t(this,h)),t(this,h)?(S(this,p,un).call(this),t(this,o).addEventListener("click",t(this,c)),t(this,o).addEventListener("keydown",t(this,J))):(S(this,H,pn).call(this),t(this,o).removeEventListener("click",t(this,c)),t(this,o).removeEventListener("keydown",t(this,J)))},p=new WeakSet,un=function(){t(this,i)||this.render(),this.isVisible?t(this,h)&&t(this,o).classList.add("focused"):(t(this,o).hidden=!1,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)+1e3)},H=new WeakSet,pn=function(){t(this,o).classList.remove("focused"),!(t(this,h)||!this.isVisible)&&(t(this,o).hidden=!0,t(this,o).style.zIndex=parseInt(t(this,o).style.zIndex)-1e3)};class Et extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0}),this.textContent=M.data.textContent,this.textPosition=M.data.textPosition,this.annotationEditorType=d.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const M=document.createElement("div");M.classList.add("annotationTextContent"),M.setAttribute("role","comment");for(const x of this.textContent){const j=document.createElement("span");j.textContent=x,M.append(j)}this.container.append(M)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Ot extends W{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,m,null)}render(){this.container.classList.add("lineAnnotation");const x=this.data,{width:j,height:it}=R(x.rect),dt=this.svgFactory.create(j,it,!0),At=C(this,m,this.svgFactory.createElement("svg:line"));return At.setAttribute("x1",x.rect[2]-x.lineCoordinates[0]),At.setAttribute("y1",x.rect[3]-x.lineCoordinates[1]),At.setAttribute("x2",x.rect[2]-x.lineCoordinates[2]),At.setAttribute("y2",x.rect[3]-x.lineCoordinates[3]),At.setAttribute("stroke-width",x.borderStyle.width||1),At.setAttribute("stroke","transparent"),At.setAttribute("fill","transparent"),dt.append(At),this.container.append(dt),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,m)}addHighlightArea(){this.container.classList.add("highlightArea")}}m=new WeakMap;class Mt extends W{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,L,null)}render(){this.container.classList.add("squareAnnotation");const x=this.data,{width:j,height:it}=R(x.rect),dt=this.svgFactory.create(j,it,!0),At=x.borderStyle.width,bt=C(this,L,this.svgFactory.createElement("svg:rect"));return bt.setAttribute("x",At/2),bt.setAttribute("y",At/2),bt.setAttribute("width",j-At),bt.setAttribute("height",it-At),bt.setAttribute("stroke-width",At||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),dt.append(bt),this.container.append(dt),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,L)}addHighlightArea(){this.container.classList.add("highlightArea")}}L=new WeakMap;class Bt extends W{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,N,null)}render(){this.container.classList.add("circleAnnotation");const x=this.data,{width:j,height:it}=R(x.rect),dt=this.svgFactory.create(j,it,!0),At=x.borderStyle.width,bt=C(this,N,this.svgFactory.createElement("svg:ellipse"));return bt.setAttribute("cx",j/2),bt.setAttribute("cy",it/2),bt.setAttribute("rx",j/2-At/2),bt.setAttribute("ry",it/2-At/2),bt.setAttribute("stroke-width",At||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),dt.append(bt),this.container.append(dt),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,N)}addHighlightArea(){this.container.classList.add("highlightArea")}}N=new WeakMap;class jt extends W{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,Z,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:j,height:it}=R(x.rect),dt=this.svgFactory.create(j,it,!0);let At=[];for(const zt of x.vertices){const Nt=zt.x-x.rect[0],Pt=x.rect[3]-zt.y;At.push(Nt+","+Pt)}At=At.join(" ");const bt=C(this,Z,this.svgFactory.createElement(this.svgElementName));return bt.setAttribute("points",At),bt.setAttribute("stroke-width",x.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),dt.append(bt),this.container.append(dt),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Z)}addHighlightArea(){this.container.classList.add("highlightArea")}}Z=new WeakMap;class Jt extends jt{constructor(M){super(M),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ht extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Tt extends W{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});l(this,ct,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=d.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:j,height:it}=R(x.rect),dt=this.svgFactory.create(j,it,!0);for(const At of x.inkLists){let bt=[];for(const Nt of At){const Pt=Nt.x-x.rect[0],Kt=x.rect[3]-Nt.y;bt.push(`${Pt},${Kt}`)}bt=bt.join(" ");const zt=this.svgFactory.createElement(this.svgElementName);t(this,ct).push(zt),zt.setAttribute("points",bt),zt.setAttribute("stroke-width",x.borderStyle.width||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),!x.popupRef&&this.hasPopupData&&this._createPopup(),dt.append(zt)}return this.container.append(dt),this.container}getElementsToTriggerPopup(){return t(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap;class Vt extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Ut extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ee extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ne extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class le extends W{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ce extends W{constructor(x){var dt;super(x,{isRenderable:!0});l(this,St);l(this,mt,null);const{filename:j,content:it}=this.data.file;this.filename=(0,et.getFilenameFromUrl)(j,!0),this.content=it,(dt=this.linkService.eventBus)==null||dt.dispatch("fileattachmentannotation",{source:this,filename:j,content:it})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:x,data:j}=this;let it;j.hasAppearance||j.fillAlpha===0?it=document.createElement("div"):(it=document.createElement("img"),it.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(j.name)?"paperclip":"pushpin"}.svg`,j.fillAlpha&&j.fillAlpha<1&&(it.style=`filter: opacity(${Math.round(j.fillAlpha*100)}%);`)),it.addEventListener("dblclick",S(this,St,gn).bind(this)),C(this,mt,it);const{isMac:dt}=d.FeatureTest.platform;return x.addEventListener("keydown",At=>{At.key==="Enter"&&(dt?At.metaKey:At.ctrlKey)&&S(this,St,gn).call(this)}),!j.popupRef&&this.hasPopupData?this._createPopup():it.classList.add("popupTriggerArea"),x.append(it),x}getElementsToTriggerPopup(){return t(this,mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}mt=new WeakMap,St=new WeakSet,gn=function(){var x;(x=this.downloadManager)==null||x.openOrDownloadData(this.content,this.filename)};class ge{constructor({div:M,accessibilityManager:x,annotationCanvasMap:j,page:it,viewport:dt}){l(this,fe);l(this,pe);l(this,te,null);l(this,Zt,null);l(this,Ae,new Map);this.div=M,C(this,te,x),C(this,Zt,j),this.page=it,this.viewport=dt,this.zIndex=0}async render(M){const{annotations:x}=M,j=this.div;(0,et.setLayerDimensions)(j,this.viewport);const it=new Map,dt={data:null,layer:j,linkService:M.linkService,downloadManager:M.downloadManager,imageResourcesPath:M.imageResourcesPath||"",renderForms:M.renderForms!==!1,svgFactory:new et.DOMSVGFactory,annotationStorage:M.annotationStorage||new I.AnnotationStorage,enableScripting:M.enableScripting===!0,hasJSActions:M.hasJSActions,fieldObjects:M.fieldObjects,parent:this,elements:null};for(const At of x){if(At.noHTML)continue;const bt=At.annotationType===d.AnnotationType.POPUP;if(bt){const Pt=it.get(At.id);if(!Pt)continue;dt.elements=Pt}else{const{width:Pt,height:Kt}=R(At.rect);if(Pt<=0||Kt<=0)continue}dt.data=At;const zt=K.create(dt);if(!zt.isRenderable)continue;if(!bt&&At.popupRef){const Pt=it.get(At.popupRef);Pt?Pt.push(zt):it.set(At.popupRef,[zt])}zt.annotationEditorType>0&&t(this,Ae).set(zt.data.id,zt);const Nt=zt.render();At.hidden&&(Nt.style.visibility="hidden"),S(this,fe,fr).call(this,Nt,At.id)}S(this,pe,fn).call(this)}update({viewport:M}){const x=this.div;this.viewport=M,(0,et.setLayerDimensions)(x,{rotation:M.rotation}),S(this,pe,fn).call(this),x.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Ae).values())}getEditableAnnotation(M){return t(this,Ae).get(M)}}te=new WeakMap,Zt=new WeakMap,Ae=new WeakMap,fe=new WeakSet,fr=function(M,x){var it;const j=M.firstChild||M;j.id=`${d.AnnotationPrefix}${x}`,this.div.append(M),(it=t(this,te))==null||it.moveElementInDOM(this.div,M,j,!1)},pe=new WeakSet,fn=function(){if(!t(this,Zt))return;const M=this.div;for(const[x,j]of t(this,Zt)){const it=M.querySelector(`[data-annotation-id="${x}"]`);if(!it)continue;const{firstChild:dt}=it;dt?dt.nodeName==="CANVAS"?dt.replaceWith(j):dt.before(j):it.append(j)}t(this,Zt).clear()}},792:(Lt,_t,lt)=>{var B,D,Q,mr,R;lt.d(_t,{AnnotationStorage:()=>gt,PrintAnnotationStorage:()=>X,SerializableEmpty:()=>Y});var d=lt(292),et=lt(310),I=lt(651);const Y=Object.freeze({map:null,hash:"",transfer:void 0});class gt{constructor(){l(this,Q);l(this,B,!1);l(this,D,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(W,nt){const vt=t(this,D).get(W);return vt===void 0?nt:Object.assign(nt,vt)}getRawValue(W){return t(this,D).get(W)}remove(W){if(t(this,D).delete(W),t(this,D).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const nt of t(this,D).values())if(nt instanceof et.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(W,nt){const vt=t(this,D).get(W);let at=!1;if(vt!==void 0)for(const[z,$]of Object.entries(nt))vt[z]!==$&&(at=!0,vt[z]=$);else at=!0,t(this,D).set(W,nt);at&&S(this,Q,mr).call(this),nt instanceof et.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(nt.constructor._type)}has(W){return t(this,D).has(W)}getAll(){return t(this,D).size>0?(0,d.objectFromMap)(t(this,D)):null}setAll(W){for(const[nt,vt]of Object.entries(W))this.setValue(nt,vt)}get size(){return t(this,D).size}resetModified(){t(this,B)&&(C(this,B,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new X(this)}get serializable(){if(t(this,D).size===0)return Y;const W=new Map,nt=new I.MurmurHash3_64,vt=[],at=Object.create(null);let z=!1;for(const[$,V]of t(this,D)){const O=V instanceof et.AnnotationEditor?V.serialize(!1,at):V;O&&(W.set($,O),nt.update(`${$}:${JSON.stringify(O)}`),z||(z=!!O.bitmap))}if(z)for(const $ of W.values())$.bitmap&&vt.push($.bitmap);return W.size>0?{map:W,hash:nt.hexdigest(),transfer:vt}:Y}get editorStats(){let W=null;const nt=new Map;for(const vt of t(this,D).values()){if(!(vt instanceof et.AnnotationEditor))continue;const at=vt.telemetryFinalData;if(!at)continue;const{type:z}=at;nt.has(z)||nt.set(z,Object.getPrototypeOf(vt).constructor),W||(W=Object.create(null));const $=W[z]||(W[z]=new Map);for(const[V,O]of Object.entries(at)){if(V==="type")continue;let st=$.get(V);st||(st=new Map,$.set(V,st));const ot=st.get(O)??0;st.set(O,ot+1)}}for(const[vt,at]of nt)W[vt]=at.computeTelemetryFinalData(W[vt]);return W}}B=new WeakMap,D=new WeakMap,Q=new WeakSet,mr=function(){t(this,B)||(C(this,B,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class X extends gt{constructor(nt){super();l(this,R,void 0);const{map:vt,hash:at,transfer:z}=nt.serializable,$=structuredClone(vt,z?{transfer:z}:null);C(this,R,{map:$,hash:at,transfer:z})}get print(){(0,d.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,R)}}R=new WeakMap},831:(Lt,_t,lt)=>{lt.a(Lt,async(d,et)=>{var O,st,ot,yt,Gs,Et,Hi,Mt,Bt,jt,Jt,ht,Ui,Vt,Ut,ee,ne,le,ci,ge,ve,mn,Wt,oe;try{let Me=function(w){if(typeof w=="string"||w instanceof URL?w={url:w}:(w instanceof ArrayBuffer||ArrayBuffer.isView(w))&&(w={data:w}),typeof w!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!w.url&&!w.data&&!w.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const m=new b,{docId:L}=m,N=w.url?re(w.url):null,Z=w.data?Se(w.data):null,ct=w.httpHeaders||null,mt=w.withCredentials===!0,St=w.password??null,$t=w.range instanceof y?w.range:null,te=Number.isInteger(w.rangeChunkSize)&&w.rangeChunkSize>0?w.rangeChunkSize:se;let Zt=w.worker instanceof r?w.worker:null;const Ae=w.verbosity,fe=typeof w.docBaseUrl=="string"&&!(0,gt.isDataScheme)(w.docBaseUrl)?w.docBaseUrl:null,Re=typeof w.cMapUrl=="string"?w.cMapUrl:null,pe=w.cMapPacked!==!1,Pe=w.CMapReaderFactory||c,ie=typeof w.standardFontDataUrl=="string"?w.standardFontDataUrl:null,M=w.StandardFontDataFactory||o,x=w.stopAtErrors!==!0,j=Number.isInteger(w.maxImageSize)&&w.maxImageSize>-1?w.maxImageSize:-1,it=w.isEvalSupported!==!1,dt=typeof w.isOffscreenCanvasSupported=="boolean"?w.isOffscreenCanvasSupported:!I.isNodeJS,At=Number.isInteger(w.canvasMaxAreaInBytes)?w.canvasMaxAreaInBytes:-1,bt=typeof w.disableFontFace=="boolean"?w.disableFontFace:I.isNodeJS,zt=w.fontExtraProperties===!0,Nt=w.enableXfa===!0,Pt=w.ownerDocument||globalThis.document,Kt=w.disableRange===!0,Dt=w.disableStream===!0,wt=w.disableAutoFetch===!0,kt=w.pdfBug===!0,Yt=$t?$t.length:w.length??NaN,ce=typeof w.useSystemFonts=="boolean"?w.useSystemFonts:!I.isNodeJS&&!bt,he=typeof w.useWorkerFetch=="boolean"?w.useWorkerFetch:Pe===gt.DOMCMapReaderFactory&&M===gt.DOMStandardFontDataFactory&&Re&&ie&&(0,gt.isValidFetchUrl)(Re,document.baseURI)&&(0,gt.isValidFetchUrl)(ie,document.baseURI),_e=w.canvasFactory||new n({ownerDocument:Pt}),Te=w.filterFactory||new f({docId:L,ownerDocument:Pt}),Je=null;(0,I.setVerbosityLevel)(Ae);const We={canvasFactory:_e,filterFactory:Te};if(he||(We.cMapReaderFactory=new Pe({baseUrl:Re,isCompressed:pe}),We.standardFontDataFactory=new M({baseUrl:ie})),!Zt){const Ve={verbosity:Ae,port:q.GlobalWorkerOptions.workerPort};Zt=Ve.port?r.fromPort(Ve):new r(Ve),m._worker=Zt}const je={docId:L,apiVersion:"4.1.392",data:Z,password:St,disableAutoFetch:wt,rangeChunkSize:te,length:Yt,docBaseUrl:fe,enableXfa:Nt,evaluatorOptions:{maxImageSize:j,disableFontFace:bt,ignoreErrors:x,isEvalSupported:it,isOffscreenCanvasSupported:dt,canvasMaxAreaInBytes:At,fontExtraProperties:zt,useSystemFonts:ce,cMapUrl:he?Re:null,standardFontDataUrl:he?ie:null}},Ze={ignoreErrors:x,isEvalSupported:it,disableFontFace:bt,fontExtraProperties:zt,enableXfa:Nt,ownerDocument:Pt,disableAutoFetch:wt,pdfBug:kt,styleElement:Je};return Zt.promise.then(function(){if(m.destroyed)throw new Error("Loading aborted");const Ve=A(Zt,je),P=new Promise(function(ut){let Rt;$t?Rt=new nt.PDFDataTransportStream($t,{disableRange:Kt,disableStream:Dt}):Z||(Rt=(Ft=>I.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,gt.isValidFetchUrl)(Ft.url)?new vt.PDFFetchStream(Ft):new z.PDFNodeStream(Ft):(0,gt.isValidFetchUrl)(Ft.url)?new vt.PDFFetchStream(Ft):new at.PDFNetworkStream(Ft))({url:N,length:Yt,httpHeaders:ct,withCredentials:mt,rangeChunkSize:te,disableRange:Kt,disableStream:Dt})),ut(Rt)});return Promise.all([Ve,P]).then(function([ut,Rt]){if(m.destroyed)throw new Error("Loading aborted");const Ft=new R.MessageHandler(L,ut,Zt.port),Xt=new g(Ft,m,Rt,Ze,We);m._transport=Xt,Ft.send("Ready",null)})}).catch(m._capability.reject),m},re=function(w){if(w instanceof URL)return w.href;try{return new URL(w,window.location).href}catch{if(I.isNodeJS&&typeof w=="string")return w}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},Se=function(w){if(I.isNodeJS&&typeof Buffer<"u"&&w instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(w instanceof Uint8Array&&w.byteLength===w.buffer.byteLength)return w;if(typeof w=="string")return(0,I.stringToBytes)(w);if(w instanceof ArrayBuffer||ArrayBuffer.isView(w)||typeof w=="object"&&!isNaN(w==null?void 0:w.length))return new Uint8Array(w);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};lt.d(_t,{PDFDataRangeTransport:()=>y,PDFWorker:()=>r,build:()=>G,getDocument:()=>Me,version:()=>F});var I=lt(292),Y=lt(792),gt=lt(419),X=lt(10),B=lt(573),D=lt(923),Q=lt(814),q=lt(164),R=lt(178),K=lt(62),W=lt(626),nt=lt(585),vt=lt(94),at=lt(457),z=lt(786),$=lt(50),V=d([B,z]);[B,z]=V.then?(await V)():V;const se=65536,J=100,s=5e3,n=I.isNodeJS?B.NodeCanvasFactory:gt.DOMCanvasFactory,c=I.isNodeJS?B.NodeCMapReaderFactory:gt.DOMCMapReaderFactory,f=I.isNodeJS?B.NodeFilterFactory:gt.DOMFilterFactory,o=I.isNodeJS?B.NodeStandardFontDataFactory:gt.DOMStandardFontDataFactory;async function A(w,m){if(w.destroyed)throw new Error("Worker was destroyed");const L=await w.messageHandler.sendWithPromise("GetDocRequest",m,m.data?[m.data.buffer]:null);if(w.destroyed)throw new Error("Worker was destroyed");return L}const p=class p{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${us(p,O)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var m,L,N;this.destroyed=!0;try{(m=this._worker)!=null&&m.port&&(this._worker._pendingDestroy=!0),await((L=this._transport)==null?void 0:L.destroy())}catch(Z){throw(N=this._worker)!=null&&N.port&&delete this._worker._pendingDestroy,Z}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};O=new WeakMap,l(p,O,0);let b=p;class y{constructor(m,L,N=!1,Z=null){this.length=m,this.initialData=L,this.progressiveDone=N,this.contentDispositionFilename=Z,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(m){this._rangeListeners.push(m)}addProgressListener(m){this._progressListeners.push(m)}addProgressiveReadListener(m){this._progressiveReadListeners.push(m)}addProgressiveDoneListener(m){this._progressiveDoneListeners.push(m)}onDataRange(m,L){for(const N of this._rangeListeners)N(m,L)}onDataProgress(m,L){this._readyCapability.promise.then(()=>{for(const N of this._progressListeners)N(m,L)})}onDataProgressiveRead(m){this._readyCapability.promise.then(()=>{for(const L of this._progressiveReadListeners)L(m)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const m of this._progressiveDoneListeners)m()})}transportReady(){this._readyCapability.resolve()}requestDataRange(m,L){(0,I.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class u{constructor(m,L){this._pdfInfo=m,this._transport=L}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,I.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(m){return this._transport.getPage(m)}getPageIndex(m){return this._transport.getPageIndex(m)}getDestinations(){return this._transport.getDestinations()}getDestination(m){return this._transport.getDestination(m)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:m="display"}={}){const{renderingIntent:L}=this._transport.getRenderingIntent(m);return this._transport.getOptionalContentConfig(L)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(m=!1){return this._transport.startCleanup(m||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class a{constructor(m,L,N,Z=!1){l(this,yt);l(this,Et);l(this,st,null);l(this,ot,!1);this._pageIndex=m,this._pageInfo=L,this._transport=N,this._stats=Z?new gt.StatTimer:null,this._pdfBug=Z,this.commonObjs=N.commonObjs,this.objs=new v,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:m,rotation:L=this.rotate,offsetX:N=0,offsetY:Z=0,dontFlip:ct=!1}={}){return new gt.PageViewport({viewBox:this.view,scale:m,rotation:L,offsetX:N,offsetY:Z,dontFlip:ct})}getAnnotations({intent:m="display"}={}){const{renderingIntent:L}=this._transport.getRenderingIntent(m);return this._transport.getAnnotations(this._pageIndex,L)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,I.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var m;return((m=this._transport._htmlForXfa)==null?void 0:m.children[this._pageIndex])||null}render({canvasContext:m,viewport:L,intent:N="display",annotationMode:Z=I.AnnotationMode.ENABLE,transform:ct=null,background:mt=null,optionalContentConfigPromise:St=null,annotationCanvasMap:$t=null,pageColors:te=null,printAnnotationStorage:Zt=null}){var j,it;(j=this._stats)==null||j.time("Overall");const Ae=this._transport.getRenderingIntent(N,Z,Zt),{renderingIntent:fe,cacheKey:Re}=Ae;C(this,ot,!1),S(this,Et,Hi).call(this),St||(St=this._transport.getOptionalContentConfig(fe));let pe=this._intentStates.get(Re);pe||(pe=Object.create(null),this._intentStates.set(Re,pe)),pe.streamReaderCancelTimeout&&(clearTimeout(pe.streamReaderCancelTimeout),pe.streamReaderCancelTimeout=null);const Pe=!!(fe&I.RenderingIntentFlag.PRINT);pe.displayReadyCapability||(pe.displayReadyCapability=Promise.withResolvers(),pe.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(Ae));const ie=dt=>{var At,bt;pe.renderTasks.delete(M),(this._maybeCleanupAfterRender||Pe)&&C(this,ot,!0),S(this,yt,Gs).call(this,!Pe),dt?(M.capability.reject(dt),this._abortOperatorList({intentState:pe,reason:dt instanceof Error?dt:new Error(dt)})):M.capability.resolve(),(At=this._stats)==null||At.timeEnd("Rendering"),(bt=this._stats)==null||bt.timeEnd("Overall")},M=new U({callback:ie,params:{canvasContext:m,viewport:L,transform:ct,background:mt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:$t,operatorList:pe.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Pe,pdfBug:this._pdfBug,pageColors:te});(pe.renderTasks||(pe.renderTasks=new Set)).add(M);const x=M.task;return Promise.all([pe.displayReadyCapability.promise,St]).then(([dt,At])=>{var bt;if(this.destroyed){ie();return}if((bt=this._stats)==null||bt.time("Rendering"),!(At.renderingIntent&fe))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:dt,optionalContentConfig:At}),M.operatorListChanged()}).catch(ie),x}getOperatorList({intent:m="display",annotationMode:L=I.AnnotationMode.ENABLE,printAnnotationStorage:N=null}={}){var $t;function Z(){mt.operatorList.lastChunk&&(mt.opListReadCapability.resolve(mt.operatorList),mt.renderTasks.delete(St))}const ct=this._transport.getRenderingIntent(m,L,N,!0);let mt=this._intentStates.get(ct.cacheKey);mt||(mt=Object.create(null),this._intentStates.set(ct.cacheKey,mt));let St;return mt.opListReadCapability||(St=Object.create(null),St.operatorListChanged=Z,mt.opListReadCapability=Promise.withResolvers(),(mt.renderTasks||(mt.renderTasks=new Set)).add(St),mt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},($t=this._stats)==null||$t.time("Page Request"),this._pumpOperatorList(ct)),mt.opListReadCapability.promise}streamTextContent({includeMarkedContent:m=!1,disableNormalization:L=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:m===!0,disableNormalization:L===!0},{highWaterMark:100,size(N){return N.items.length}})}getTextContent(m={}){if(this._transport._htmlForXfa)return this.getXfa().then(N=>$.XfaText.textContent(N));const L=this.streamTextContent(m);return new Promise(function(N,Z){function ct(){mt.read().then(function({value:$t,done:te}){if(te){N(St);return}Object.assign(St.styles,$t.styles),St.items.push(...$t.items),ct()},Z)}const mt=L.getReader(),St={items:[],styles:Object.create(null)};ct()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const m=[];for(const L of this._intentStates.values())if(this._abortOperatorList({intentState:L,reason:new Error("Page was destroyed."),force:!0}),!L.opListReadCapability)for(const N of L.renderTasks)m.push(N.completed),N.cancel();return this.objs.clear(),C(this,ot,!1),S(this,Et,Hi).call(this),Promise.all(m)}cleanup(m=!1){C(this,ot,!0);const L=S(this,yt,Gs).call(this,!1);return m&&L&&this._stats&&(this._stats=new gt.StatTimer),L}_startRenderPage(m,L){var Z,ct;const N=this._intentStates.get(L);N&&((Z=this._stats)==null||Z.timeEnd("Page Request"),(ct=N.displayReadyCapability)==null||ct.resolve(m))}_renderPageChunk(m,L){for(let N=0,Z=m.length;N<Z;N++)L.operatorList.fnArray.push(m.fnArray[N]),L.operatorList.argsArray.push(m.argsArray[N]);L.operatorList.lastChunk=m.lastChunk,L.operatorList.separateAnnots=m.separateAnnots;for(const N of L.renderTasks)N.operatorListChanged();m.lastChunk&&S(this,yt,Gs).call(this,!0)}_pumpOperatorList({renderingIntent:m,cacheKey:L,annotationStorageSerializable:N}){const{map:Z,transfer:ct}=N,mt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:m,cacheKey:L,annotationStorage:Z},ct).getReader(),St=this._intentStates.get(L);St.streamReader=mt;const $t=()=>{mt.read().then(({value:te,done:Zt})=>{if(Zt){St.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(te,St),$t())},te=>{if(St.streamReader=null,!this._transport.destroyed){if(St.operatorList){St.operatorList.lastChunk=!0;for(const Zt of St.renderTasks)Zt.operatorListChanged();S(this,yt,Gs).call(this,!0)}if(St.displayReadyCapability)St.displayReadyCapability.reject(te);else if(St.opListReadCapability)St.opListReadCapability.reject(te);else throw te}})};$t()}_abortOperatorList({intentState:m,reason:L,force:N=!1}){if(m.streamReader){if(m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null),!N){if(m.renderTasks.size>0)return;if(L instanceof gt.RenderingCancelledException){let Z=J;L.extraDelay>0&&L.extraDelay<1e3&&(Z+=L.extraDelay),m.streamReaderCancelTimeout=setTimeout(()=>{m.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:m,reason:L,force:!0})},Z);return}}if(m.streamReader.cancel(new I.AbortException(L.message)).catch(()=>{}),m.streamReader=null,!this._transport.destroyed){for(const[Z,ct]of this._intentStates)if(ct===m){this._intentStates.delete(Z);break}this.cleanup()}}}get stats(){return this._stats}}st=new WeakMap,ot=new WeakMap,yt=new WeakSet,Gs=function(m=!1){if(S(this,Et,Hi).call(this),!t(this,ot)||this.destroyed)return!1;if(m)return C(this,st,setTimeout(()=>{C(this,st,null),S(this,yt,Gs).call(this,!1)},s)),!1;for(const{renderTasks:L,operatorList:N}of this._intentStates.values())if(L.size>0||!N.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),C(this,ot,!1),!0},Et=new WeakSet,Hi=function(){t(this,st)&&(clearTimeout(t(this,st)),C(this,st,null))};class h{constructor(){l(this,Mt,new Set);l(this,Bt,Promise.resolve())}postMessage(m,L){const N={data:structuredClone(m,L?{transfer:L}:null)};t(this,Bt).then(()=>{for(const Z of t(this,Mt))Z.call(this,N)})}addEventListener(m,L){t(this,Mt).add(L)}removeEventListener(m,L){t(this,Mt).delete(L)}terminate(){t(this,Mt).clear()}}Mt=new WeakMap,Bt=new WeakMap;const i={isWorkerDisabled:!1,fakeWorkerId:0};I.isNodeJS&&(i.isWorkerDisabled=!0,(jt=q.GlobalWorkerOptions).workerSrc||(jt.workerSrc="./pdf.worker.mjs")),i.isSameOrigin=function(w,m){let L;try{if(L=new URL(w),!L.origin||L.origin==="null")return!1}catch{return!1}const N=new URL(m,L);return L.origin===N.origin},i.createCDNWrapper=function(w){const m=`await import("${w}");`;return URL.createObjectURL(new Blob([m],{type:"text/javascript"}))};const _=class _{constructor({name:m=null,port:L=null,verbosity:N=(0,I.getVerbosityLevel)()}={}){var Z;if(this.name=m,this.destroyed=!1,this.verbosity=N,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,L){if((Z=t(_,Jt))!=null&&Z.has(L))throw new Error("Cannot use more than one PDFWorker per port.");(t(_,Jt)||C(_,Jt,new WeakMap)).set(L,this),this._initializeFromPort(L);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(m){this._port=m,this._messageHandler=new R.MessageHandler("main","worker",m),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!i.isWorkerDisabled&&!t(_,ht,Ui)){let{workerSrc:m}=_;try{i.isSameOrigin(window.location.href,m)||(m=i.createCDNWrapper(new URL(m,window.location).href));const L=new Worker(m,{type:"module"}),N=new R.MessageHandler("main","worker",L),Z=()=>{L.removeEventListener("error",ct),N.destroy(),L.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},ct=()=>{this._webWorker||Z()};L.addEventListener("error",ct),N.on("test",St=>{if(L.removeEventListener("error",ct),this.destroyed){Z();return}St?(this._messageHandler=N,this._port=L,this._webWorker=L,this._readyCapability.resolve(),N.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),N.destroy(),L.terminate())}),N.on("ready",St=>{if(L.removeEventListener("error",ct),this.destroyed){Z();return}try{mt()}catch{this._setupFakeWorker()}});const mt=()=>{const St=new Uint8Array;N.send("test",St,[St.buffer])};mt();return}catch{(0,I.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){i.isWorkerDisabled||((0,I.warn)("Setting up fake worker."),i.isWorkerDisabled=!0),_._setupFakeWorkerGlobal.then(m=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const L=new h;this._port=L;const N=`fake${i.fakeWorkerId++}`,Z=new R.MessageHandler(N+"_worker",N,L);m.setup(Z,L);const ct=new R.MessageHandler(N,N+"_worker",L);this._messageHandler=ct,this._readyCapability.resolve(),ct.send("configure",{verbosity:this.verbosity})}).catch(m=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${m.message}".`))})}destroy(){var m;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(m=t(_,Jt))==null||m.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(m){var N;if(!(m!=null&&m.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const L=(N=t(this,Jt))==null?void 0:N.get(m.port);if(L){if(L._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return L}return new _(m)}static get workerSrc(){if(q.GlobalWorkerOptions.workerSrc)return q.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const m=async()=>t(this,ht,Ui)?t(this,ht,Ui):(await ps(()=>import(this.workerSrc).then(async L=>(await L.__tla,L)),[])).WorkerMessageHandler;return(0,I.shadow)(this,"_setupFakeWorkerGlobal",m())}};Jt=new WeakMap,ht=new WeakSet,Ui=function(){var m;try{return((m=globalThis.pdfjsWorker)==null?void 0:m.WorkerMessageHandler)||null}catch{return null}},l(_,ht),l(_,Jt,void 0);let r=_;class g{constructor(m,L,N,Z,ct){l(this,le);l(this,Vt,new Map);l(this,Ut,new Map);l(this,ee,new Map);l(this,ne,null);this.messageHandler=m,this.loadingTask=L,this.commonObjs=new v,this.fontLoader=new X.FontLoader({ownerDocument:Z.ownerDocument,styleElement:Z.styleElement}),this._params=Z,this.canvasFactory=ct.canvasFactory,this.filterFactory=ct.filterFactory,this.cMapReaderFactory=ct.cMapReaderFactory,this.standardFontDataFactory=ct.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=N,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,I.shadow)(this,"annotationStorage",new Y.AnnotationStorage)}getRenderingIntent(m,L=I.AnnotationMode.ENABLE,N=null,Z=!1){let ct=I.RenderingIntentFlag.DISPLAY,mt=Y.SerializableEmpty;switch(m){case"any":ct=I.RenderingIntentFlag.ANY;break;case"display":break;case"print":ct=I.RenderingIntentFlag.PRINT;break;default:(0,I.warn)(`getRenderingIntent - invalid intent: ${m}`)}switch(L){case I.AnnotationMode.DISABLE:ct+=I.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case I.AnnotationMode.ENABLE:break;case I.AnnotationMode.ENABLE_FORMS:ct+=I.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case I.AnnotationMode.ENABLE_STORAGE:ct+=I.RenderingIntentFlag.ANNOTATIONS_STORAGE,mt=(ct&I.RenderingIntentFlag.PRINT&&N instanceof Y.PrintAnnotationStorage?N:this.annotationStorage).serializable;break;default:(0,I.warn)(`getRenderingIntent - invalid annotationMode: ${L}`)}return Z&&(ct+=I.RenderingIntentFlag.OPLIST),{renderingIntent:ct,cacheKey:`${ct}_${mt.hash}`,annotationStorageSerializable:mt}}destroy(){var N;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(N=t(this,ne))==null||N.reject(new Error("Worker was destroyed during onPassword callback"));const m=[];for(const Z of t(this,Ut).values())m.push(Z._destroy());t(this,Ut).clear(),t(this,ee).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const L=this.messageHandler.sendWithPromise("Terminate",null);return m.push(L),Promise.all(m).then(()=>{var Z;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Vt).clear(),this.filterFactory.destroy(),(0,Q.cleanupTextLayer)(),(Z=this._networkStream)==null||Z.cancelAllRequests(new I.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:m,loadingTask:L}=this;m.on("GetReader",(N,Z)=>{(0,I.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=ct=>{this._lastProgress={loaded:ct.loaded,total:ct.total}},Z.onPull=()=>{this._fullReader.read().then(function({value:ct,done:mt}){if(mt){Z.close();return}(0,I.assert)(ct instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Z.enqueue(new Uint8Array(ct),1,[ct])}).catch(ct=>{Z.error(ct)})},Z.onCancel=ct=>{this._fullReader.cancel(ct),Z.ready.catch(mt=>{if(!this.destroyed)throw mt})}}),m.on("ReaderHeadersReady",N=>{const Z=Promise.withResolvers(),ct=this._fullReader;return ct.headersReady.then(()=>{var mt;(!ct.isStreamingSupported||!ct.isRangeSupported)&&(this._lastProgress&&((mt=L.onProgress)==null||mt.call(L,this._lastProgress)),ct.onProgress=St=>{var $t;($t=L.onProgress)==null||$t.call(L,{loaded:St.loaded,total:St.total})}),Z.resolve({isStreamingSupported:ct.isStreamingSupported,isRangeSupported:ct.isRangeSupported,contentLength:ct.contentLength})},Z.reject),Z.promise}),m.on("GetRangeReader",(N,Z)=>{(0,I.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const ct=this._networkStream.getRangeReader(N.begin,N.end);if(!ct){Z.close();return}Z.onPull=()=>{ct.read().then(function({value:mt,done:St}){if(St){Z.close();return}(0,I.assert)(mt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Z.enqueue(new Uint8Array(mt),1,[mt])}).catch(mt=>{Z.error(mt)})},Z.onCancel=mt=>{ct.cancel(mt),Z.ready.catch(St=>{if(!this.destroyed)throw St})}}),m.on("GetDoc",({pdfInfo:N})=>{this._numPages=N.numPages,this._htmlForXfa=N.htmlForXfa,delete N.htmlForXfa,L._capability.resolve(new u(N,this))}),m.on("DocException",function(N){let Z;switch(N.name){case"PasswordException":Z=new I.PasswordException(N.message,N.code);break;case"InvalidPDFException":Z=new I.InvalidPDFException(N.message);break;case"MissingPDFException":Z=new I.MissingPDFException(N.message);break;case"UnexpectedResponseException":Z=new I.UnexpectedResponseException(N.message,N.status);break;case"UnknownErrorException":Z=new I.UnknownErrorException(N.message,N.details);break;default:(0,I.unreachable)("DocException - expected a valid Error.")}L._capability.reject(Z)}),m.on("PasswordRequest",N=>{if(C(this,ne,Promise.withResolvers()),L.onPassword){const Z=ct=>{ct instanceof Error?t(this,ne).reject(ct):t(this,ne).resolve({password:ct})};try{L.onPassword(Z,N.code)}catch(ct){t(this,ne).reject(ct)}}else t(this,ne).reject(new I.PasswordException(N.message,N.code));return t(this,ne).promise}),m.on("DataLoaded",N=>{var Z;(Z=L.onProgress)==null||Z.call(L,{loaded:N.length,total:N.length}),this.downloadInfoCapability.resolve(N)}),m.on("StartRenderPage",N=>{this.destroyed||t(this,Ut).get(N.pageIndex)._startRenderPage(N.transparency,N.cacheKey)}),m.on("commonobj",([N,Z,ct])=>{var mt;if(this.destroyed||this.commonObjs.has(N))return null;switch(Z){case"Font":const St=this._params;if("error"in ct){const Ae=ct.error;(0,I.warn)(`Error during font loading: ${Ae}`),this.commonObjs.resolve(N,Ae);break}const $t=St.pdfBug&&((mt=globalThis.FontInspector)!=null&&mt.enabled)?(Ae,fe)=>globalThis.FontInspector.fontAdded(Ae,fe):null,te=new X.FontFaceObject(ct,{isEvalSupported:St.isEvalSupported,disableFontFace:St.disableFontFace,ignoreErrors:St.ignoreErrors,inspectFont:$t});this.fontLoader.bind(te).catch(()=>m.sendWithPromise("FontFallback",{id:N})).finally(()=>{!St.fontExtraProperties&&te.data&&(te.data=null),this.commonObjs.resolve(N,te)});break;case"CopyLocalImage":const{imageRef:Zt}=ct;(0,I.assert)(Zt,"The imageRef must be defined.");for(const Ae of t(this,Ut).values())for(const[,fe]of Ae.objs)if(fe.ref===Zt)return fe.dataLen?(this.commonObjs.resolve(N,structuredClone(fe)),fe.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(N,ct);break;default:throw new Error(`Got unknown common object type ${Z}`)}return null}),m.on("obj",([N,Z,ct,mt])=>{var $t;if(this.destroyed)return;const St=t(this,Ut).get(Z);if(!St.objs.has(N)){if(St._intentStates.size===0){($t=mt==null?void 0:mt.bitmap)==null||$t.close();return}switch(ct){case"Image":St.objs.resolve(N,mt),(mt==null?void 0:mt.dataLen)>I.MAX_IMAGE_SIZE_TO_CACHE&&(St._maybeCleanupAfterRender=!0);break;case"Pattern":St.objs.resolve(N,mt);break;default:throw new Error(`Got unknown object type ${ct}`)}}}),m.on("DocProgress",N=>{var Z;this.destroyed||((Z=L.onProgress)==null||Z.call(L,{loaded:N.loaded,total:N.total}))}),m.on("FetchBuiltInCMap",N=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(N):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),m.on("FetchStandardFontData",N=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(N):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var N;this.annotationStorage.size<=0&&(0,I.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:m,transfer:L}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:m,filename:((N=this._fullReader)==null?void 0:N.filename)??null},L).finally(()=>{this.annotationStorage.resetModified()})}getPage(m){if(!Number.isInteger(m)||m<=0||m>this._numPages)return Promise.reject(new Error("Invalid page request."));const L=m-1,N=t(this,ee).get(L);if(N)return N;const Z=this.messageHandler.sendWithPromise("GetPage",{pageIndex:L}).then(ct=>{if(this.destroyed)throw new Error("Transport destroyed");const mt=new a(L,ct,this,this._params.pdfBug);return t(this,Ut).set(L,mt),mt});return t(this,ee).set(L,Z),Z}getPageIndex(m){return typeof m!="object"||m===null||!Number.isInteger(m.num)||m.num<0||!Number.isInteger(m.gen)||m.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:m.num,gen:m.gen})}getAnnotations(m,L){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:m,intent:L})}getFieldObjects(){return S(this,le,ci).call(this,"GetFieldObjects")}hasJSActions(){return S(this,le,ci).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(m){return typeof m!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:m})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return S(this,le,ci).call(this,"GetDocJSActions")}getPageJSActions(m){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:m})}getStructTree(m){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:m})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(m){return S(this,le,ci).call(this,"GetOptionalContentConfig").then(L=>new W.OptionalContentConfig(L,m))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const m="GetMetadata",L=t(this,Vt).get(m);if(L)return L;const N=this.messageHandler.sendWithPromise(m,null).then(Z=>{var ct,mt;return{info:Z[0],metadata:Z[1]?new K.Metadata(Z[1]):null,contentDispositionFilename:((ct=this._fullReader)==null?void 0:ct.filename)??null,contentLength:((mt=this._fullReader)==null?void 0:mt.contentLength)??null}});return t(this,Vt).set(m,N),N}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(m=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const L of t(this,Ut).values())if(!L.cleanup())throw new Error(`startCleanup: Page ${L.pageNumber} is currently rendering.`);this.commonObjs.clear(),m||this.fontLoader.clear(),t(this,Vt).clear(),this.filterFactory.destroy(!0),(0,Q.cleanupTextLayer)()}}get loadingParams(){const{disableAutoFetch:m,enableXfa:L}=this._params;return(0,I.shadow)(this,"loadingParams",{disableAutoFetch:m,enableXfa:L})}}Vt=new WeakMap,Ut=new WeakMap,ee=new WeakMap,ne=new WeakMap,le=new WeakSet,ci=function(m,L=null){const N=t(this,Vt).get(m);if(N)return N;const Z=this.messageHandler.sendWithPromise(m,L);return t(this,Vt).set(m,Z),Z};const E=Symbol("INITIAL_DATA");class v{constructor(){l(this,ve);l(this,ge,Object.create(null))}get(m,L=null){if(L){const Z=S(this,ve,mn).call(this,m);return Z.promise.then(()=>L(Z.data)),null}const N=t(this,ge)[m];if(!N||N.data===E)throw new Error(`Requesting object that isn't resolved yet ${m}.`);return N.data}has(m){const L=t(this,ge)[m];return!!L&&L.data!==E}resolve(m,L=null){const N=S(this,ve,mn).call(this,m);N.data=L,N.resolve()}clear(){var m;for(const L in t(this,ge)){const{data:N}=t(this,ge)[L];(m=N==null?void 0:N.bitmap)==null||m.close()}C(this,ge,Object.create(null))}*[Symbol.iterator](){for(const m in t(this,ge)){const{data:L}=t(this,ge)[m];L!==E&&(yield[m,L])}}}ge=new WeakMap,ve=new WeakSet,mn=function(m){var L;return(L=t(this,ge))[m]||(L[m]={...Promise.withResolvers(),data:E})};class k{constructor(m){l(this,Wt,null);C(this,Wt,m),this.onContinue=null}get promise(){return t(this,Wt).capability.promise}cancel(m=0){t(this,Wt).cancel(null,m)}get separateAnnots(){const{separateAnnots:m}=t(this,Wt).operatorList;if(!m)return!1;const{annotationCanvasMap:L}=t(this,Wt);return m.form||m.canvas&&(L==null?void 0:L.size)>0}}Wt=new WeakMap;const H=class H{constructor({callback:m,params:L,objs:N,commonObjs:Z,annotationCanvasMap:ct,operatorList:mt,pageIndex:St,canvasFactory:$t,filterFactory:te,useRequestAnimationFrame:Zt=!1,pdfBug:Ae=!1,pageColors:fe=null}){this.callback=m,this.params=L,this.objs=N,this.commonObjs=Z,this.annotationCanvasMap=ct,this.operatorListIdx=null,this.operatorList=mt,this._pageIndex=St,this.canvasFactory=$t,this.filterFactory=te,this._pdfBug=Ae,this.pageColors=fe,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Zt===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new k(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=L.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:m=!1,optionalContentConfig:L}){var St,$t;if(this.cancelled)return;if(this._canvas){if(t(H,oe).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(H,oe).add(this._canvas)}this._pdfBug&&((St=globalThis.StepperManager)!=null&&St.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:N,viewport:Z,transform:ct,background:mt}=this.params;this.gfx=new D.CanvasGraphics(N,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:L},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:ct,viewport:Z,transparency:m,background:mt}),this.operatorListIdx=0,this.graphicsReady=!0,($t=this.graphicsReadyCallback)==null||$t.call(this)}cancel(m=null,L=0){var N;this.running=!1,this.cancelled=!0,(N=this.gfx)==null||N.endDrawing(),t(H,oe).delete(this._canvas),this.callback(m||new gt.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,L))}operatorListChanged(){var m;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(m=this.stepper)==null||m.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(H,oe).delete(this._canvas),this.callback())))}};oe=new WeakMap,l(H,oe,new WeakSet);let U=H;const F="4.1.392",G="fcb76a78d";et()}catch(Me){et(Me)}})},583:(Lt,_t,lt)=>{lt.d(_t,{BaseCMapReaderFactory:()=>Y,BaseCanvasFactory:()=>I,BaseFilterFactory:()=>et,BaseSVGFactory:()=>X,BaseStandardFontDataFactory:()=>gt});var d=lt(292);class et{constructor(){this.constructor===et&&(0,d.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(D){return"none"}addHCMFilter(D,Q){return"none"}addHighlightHCMFilter(D,Q,q,R,K){return"none"}destroy(D=!1){}}class I{constructor(){this.constructor===I&&(0,d.unreachable)("Cannot initialize BaseCanvasFactory.")}create(D,Q){if(D<=0||Q<=0)throw new Error("Invalid canvas size");const q=this._createCanvas(D,Q);return{canvas:q,context:q.getContext("2d")}}reset(D,Q,q){if(!D.canvas)throw new Error("Canvas is not specified");if(Q<=0||q<=0)throw new Error("Invalid canvas size");D.canvas.width=Q,D.canvas.height=q}destroy(D){if(!D.canvas)throw new Error("Canvas is not specified");D.canvas.width=0,D.canvas.height=0,D.canvas=null,D.context=null}_createCanvas(D,Q){(0,d.unreachable)("Abstract method `_createCanvas` called.")}}class Y{constructor({baseUrl:D=null,isCompressed:Q=!0}){this.constructor===Y&&(0,d.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=D,this.isCompressed=Q}async fetch({name:D}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!D)throw new Error("CMap name must be specified.");const Q=this.baseUrl+D+(this.isCompressed?".bcmap":""),q=this.isCompressed?d.CMapCompressionType.BINARY:d.CMapCompressionType.NONE;return this._fetchData(Q,q).catch(R=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${Q}`)})}_fetchData(D,Q){(0,d.unreachable)("Abstract method `_fetchData` called.")}}class gt{constructor({baseUrl:D=null}){this.constructor===gt&&(0,d.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=D}async fetch({filename:D}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!D)throw new Error("Font filename must be specified.");const Q=`${this.baseUrl}${D}`;return this._fetchData(Q).catch(q=>{throw new Error(`Unable to load font data at: ${Q}`)})}_fetchData(D){(0,d.unreachable)("Abstract method `_fetchData` called.")}}class X{constructor(){this.constructor===X&&(0,d.unreachable)("Cannot initialize BaseSVGFactory.")}create(D,Q,q=!1){if(D<=0||Q<=0)throw new Error("Invalid SVG dimensions");const R=this._createSVG("svg:svg");return R.setAttribute("version","1.1"),q||(R.setAttribute("width",`${D}px`),R.setAttribute("height",`${Q}px`)),R.setAttribute("preserveAspectRatio","none"),R.setAttribute("viewBox",`0 0 ${D} ${Q}`),R}createElement(D){if(typeof D!="string")throw new Error("Invalid SVG element type");return this._createSVG(D)}_createSVG(D){(0,d.unreachable)("Abstract method `_createSVG` called.")}}},923:(Lt,_t,lt)=>{var oe,bn,re,vn;lt.d(_t,{CanvasGraphics:()=>be});var d=lt(292),et=lt(419);const I={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Y(J,s){if(!s)return;const n=s[2]-s[0],c=s[3]-s[1],f=new Path2D;f.rect(s[0],s[1],n,c),J.clip(f)}class gt{constructor(){this.constructor===gt&&(0,d.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,d.unreachable)("Abstract method `getPattern` called.")}}class X extends gt{constructor(s){super(),this._type=s[1],this._bbox=s[2],this._colorStops=s[3],this._p0=s[4],this._p1=s[5],this._r0=s[6],this._r1=s[7],this.matrix=null}_createGradient(s){let n;this._type==="axial"?n=s.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=s.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const c of this._colorStops)n.addColorStop(c[0],c[1]);return n}getPattern(s,n,c,f){let o;if(f===I.STROKE||f===I.FILL){const A=n.current.getClippedPathBoundingBox(f,(0,et.getCurrentTransform)(s))||[0,0,0,0],b=Math.ceil(A[2]-A[0])||1,y=Math.ceil(A[3]-A[1])||1,u=n.cachedCanvases.getCanvas("pattern",b,y,!0),a=u.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.translate(-A[0],-A[1]),c=d.Util.transform(c,[1,0,0,1,A[0],A[1]]),a.transform(...n.baseTransform),this.matrix&&a.transform(...this.matrix),Y(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),o=s.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(c);o.setTransform(h)}else Y(s,this._bbox),o=this._createGradient(s);return o}}function B(J,s,n,c,f,o,A,b){const y=s.coords,u=s.colors,a=J.data,h=J.width*4;let i;y[n+1]>y[c+1]&&(i=n,n=c,c=i,i=o,o=A,A=i),y[c+1]>y[f+1]&&(i=c,c=f,f=i,i=A,A=b,b=i),y[n+1]>y[c+1]&&(i=n,n=c,c=i,i=o,o=A,A=i);const r=(y[n]+s.offsetX)*s.scaleX,g=(y[n+1]+s.offsetY)*s.scaleY,E=(y[c]+s.offsetX)*s.scaleX,v=(y[c+1]+s.offsetY)*s.scaleY,k=(y[f]+s.offsetX)*s.scaleX,U=(y[f+1]+s.offsetY)*s.scaleY;if(g>=U)return;const F=u[o],G=u[o+1],p=u[o+2],_=u[A],H=u[A+1],w=u[A+2],m=u[b],L=u[b+1],N=u[b+2],Z=Math.round(g),ct=Math.round(U);let mt,St,$t,te,Zt,Ae,fe,Re;for(let pe=Z;pe<=ct;pe++){if(pe<v){const j=pe<g?0:(g-pe)/(g-v);mt=r-(r-E)*j,St=F-(F-_)*j,$t=G-(G-H)*j,te=p-(p-w)*j}else{let j;pe>U?j=1:v===U?j=0:j=(v-pe)/(v-U),mt=E-(E-k)*j,St=_-(_-m)*j,$t=H-(H-L)*j,te=w-(w-N)*j}let Pe;pe<g?Pe=0:pe>U?Pe=1:Pe=(g-pe)/(g-U),Zt=r-(r-k)*Pe,Ae=F-(F-m)*Pe,fe=G-(G-L)*Pe,Re=p-(p-N)*Pe;const ie=Math.round(Math.min(mt,Zt)),M=Math.round(Math.max(mt,Zt));let x=h*pe+ie*4;for(let j=ie;j<=M;j++)Pe=(mt-j)/(mt-Zt),Pe<0?Pe=0:Pe>1&&(Pe=1),a[x++]=St-(St-Ae)*Pe|0,a[x++]=$t-($t-fe)*Pe|0,a[x++]=te-(te-Re)*Pe|0,a[x++]=255}}function D(J,s,n){const c=s.coords,f=s.colors;let o,A;switch(s.type){case"lattice":const b=s.verticesPerRow,y=Math.floor(c.length/b)-1,u=b-1;for(o=0;o<y;o++){let a=o*b;for(let h=0;h<u;h++,a++)B(J,n,c[a],c[a+1],c[a+b],f[a],f[a+1],f[a+b]),B(J,n,c[a+b+1],c[a+1],c[a+b],f[a+b+1],f[a+1],f[a+b])}break;case"triangles":for(o=0,A=c.length;o<A;o+=3)B(J,n,c[o],c[o+1],c[o+2],f[o],f[o+1],f[o+2]);break;default:throw new Error("illegal figure")}}class Q extends gt{constructor(s){super(),this._coords=s[2],this._colors=s[3],this._figures=s[4],this._bounds=s[5],this._bbox=s[7],this._background=s[8],this.matrix=null}_createMeshCanvas(s,n,c){const f=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),A=Math.ceil(this._bounds[2])-f,b=Math.ceil(this._bounds[3])-o,y=Math.min(Math.ceil(Math.abs(A*s[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(b*s[1]*1.1)),3e3),a=A/y,h=b/u,i={coords:this._coords,colors:this._colors,offsetX:-f,offsetY:-o,scaleX:1/a,scaleY:1/h},r=y+2*2,g=u+2*2,E=c.getCanvas("mesh",r,g,!1),v=E.context,k=v.createImageData(y,u);if(n){const U=k.data;for(let F=0,G=U.length;F<G;F+=4)U[F]=n[0],U[F+1]=n[1],U[F+2]=n[2],U[F+3]=255}for(const U of this._figures)D(k,U,i);return v.putImageData(k,2,2),{canvas:E.canvas,offsetX:f-2*a,offsetY:o-2*h,scaleX:a,scaleY:h}}getPattern(s,n,c,f){Y(s,this._bbox);let o;if(f===I.SHADING)o=d.Util.singularValueDecompose2dScale((0,et.getCurrentTransform)(s));else if(o=d.Util.singularValueDecompose2dScale(n.baseTransform),this.matrix){const b=d.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*b[0],o[1]*b[1]]}const A=this._createMeshCanvas(o,f===I.SHADING?null:this._background,n.cachedCanvases);return f!==I.SHADING&&(s.setTransform(...n.baseTransform),this.matrix&&s.transform(...this.matrix)),s.translate(A.offsetX,A.offsetY),s.scale(A.scaleX,A.scaleY),s.createPattern(A.canvas,"no-repeat")}}class q extends gt{getPattern(){return"hotpink"}}function R(J){switch(J[0]){case"RadialAxial":return new X(J);case"Mesh":return new Q(J);case"Dummy":return new q}throw new Error(`Unknown IR type: ${J[0]}`)}const K={COLORED:1,UNCOLORED:2},Wt=class Wt{constructor(s,n,c,f,o){this.operatorList=s[2],this.matrix=s[3]||[1,0,0,1,0,0],this.bbox=s[4],this.xstep=s[5],this.ystep=s[6],this.paintType=s[7],this.tilingType=s[8],this.color=n,this.ctx=c,this.canvasGraphicsFactory=f,this.baseTransform=o}createPatternCanvas(s){const n=this.operatorList,c=this.bbox,f=this.xstep,o=this.ystep,A=this.paintType,b=this.tilingType,y=this.color,u=this.canvasGraphicsFactory;(0,d.info)("TilingType: "+b);const a=c[0],h=c[1],i=c[2],r=c[3],g=d.Util.singularValueDecompose2dScale(this.matrix),E=d.Util.singularValueDecompose2dScale(this.baseTransform),v=[g[0]*E[0],g[1]*E[1]],k=this.getSizeAndScale(f,this.ctx.canvas.width,v[0]),U=this.getSizeAndScale(o,this.ctx.canvas.height,v[1]),F=s.cachedCanvases.getCanvas("pattern",k.size,U.size,!0),G=F.context,p=u.createCanvasGraphics(G);p.groupLevel=s.groupLevel,this.setFillAndStrokeStyleToContext(p,A,y);let _=a,H=h,w=i,m=r;return a<0&&(_=0,w+=Math.abs(a)),h<0&&(H=0,m+=Math.abs(h)),G.translate(-(k.scale*_),-(U.scale*H)),p.transform(k.scale,0,0,U.scale,0,0),G.save(),this.clipBbox(p,_,H,w,m),p.baseTransform=(0,et.getCurrentTransform)(p.ctx),p.executeOperatorList(n),p.endDrawing(),{canvas:F.canvas,scaleX:k.scale,scaleY:U.scale,offsetX:_,offsetY:H}}getSizeAndScale(s,n,c){s=Math.abs(s);const f=Math.max(Wt.MAX_PATTERN_SIZE,n);let o=Math.ceil(s*c);return o>=f?o=f:c=o/s,{scale:c,size:o}}clipBbox(s,n,c,f,o){const A=f-n,b=o-c;s.ctx.rect(n,c,A,b),s.current.updateRectMinMax((0,et.getCurrentTransform)(s.ctx),[n,c,f,o]),s.clip(),s.endPath()}setFillAndStrokeStyleToContext(s,n,c){const f=s.ctx,o=s.current;switch(n){case K.COLORED:const A=this.ctx;f.fillStyle=A.fillStyle,f.strokeStyle=A.strokeStyle,o.fillColor=A.fillStyle,o.strokeColor=A.strokeStyle;break;case K.UNCOLORED:const b=d.Util.makeHexColor(c[0],c[1],c[2]);f.fillStyle=b,f.strokeStyle=b,o.fillColor=b,o.strokeColor=b;break;default:throw new d.FormatError(`Unsupported paint type: ${n}`)}}getPattern(s,n,c,f){let o=c;f!==I.SHADING&&(o=d.Util.transform(o,n.baseTransform),this.matrix&&(o=d.Util.transform(o,this.matrix)));const A=this.createPatternCanvas(n);let b=new DOMMatrix(o);b=b.translate(A.offsetX,A.offsetY),b=b.scale(1/A.scaleX,1/A.scaleY);const y=s.createPattern(A.canvas,"repeat");return y.setTransform(b),y}};me(Wt,"MAX_PATTERN_SIZE",3e3);let W=Wt;function nt({src:J,srcPos:s=0,dest:n,width:c,height:f,nonBlackColor:o=4294967295,inverseDecode:A=!1}){const b=d.FeatureTest.isLittleEndian?4278190080:255,[y,u]=A?[o,b]:[b,o],a=c>>3,h=c&7,i=J.length;n=new Uint32Array(n.buffer);let r=0;for(let g=0;g<f;g++){for(const v=s+a;s<v;s++){const k=s<i?J[s]:255;n[r++]=k&128?u:y,n[r++]=k&64?u:y,n[r++]=k&32?u:y,n[r++]=k&16?u:y,n[r++]=k&8?u:y,n[r++]=k&4?u:y,n[r++]=k&2?u:y,n[r++]=k&1?u:y}if(h===0)continue;const E=s<i?J[s++]:255;for(let v=0;v<h;v++)n[r++]=E&1<<7-v?u:y}return{srcPos:s,destPos:r}}const vt=16,at=100,z=4096,$=15,V=10,O=1e3,st=16;function ot(J,s){if(J._removeMirroring)throw new Error("Context is already forwarding operations.");J.__originalSave=J.save,J.__originalRestore=J.restore,J.__originalRotate=J.rotate,J.__originalScale=J.scale,J.__originalTranslate=J.translate,J.__originalTransform=J.transform,J.__originalSetTransform=J.setTransform,J.__originalResetTransform=J.resetTransform,J.__originalClip=J.clip,J.__originalMoveTo=J.moveTo,J.__originalLineTo=J.lineTo,J.__originalBezierCurveTo=J.bezierCurveTo,J.__originalRect=J.rect,J.__originalClosePath=J.closePath,J.__originalBeginPath=J.beginPath,J._removeMirroring=()=>{J.save=J.__originalSave,J.restore=J.__originalRestore,J.rotate=J.__originalRotate,J.scale=J.__originalScale,J.translate=J.__originalTranslate,J.transform=J.__originalTransform,J.setTransform=J.__originalSetTransform,J.resetTransform=J.__originalResetTransform,J.clip=J.__originalClip,J.moveTo=J.__originalMoveTo,J.lineTo=J.__originalLineTo,J.bezierCurveTo=J.__originalBezierCurveTo,J.rect=J.__originalRect,J.closePath=J.__originalClosePath,J.beginPath=J.__originalBeginPath,delete J._removeMirroring},J.save=function(){s.save(),this.__originalSave()},J.restore=function(){s.restore(),this.__originalRestore()},J.translate=function(n,c){s.translate(n,c),this.__originalTranslate(n,c)},J.scale=function(n,c){s.scale(n,c),this.__originalScale(n,c)},J.transform=function(n,c,f,o,A,b){s.transform(n,c,f,o,A,b),this.__originalTransform(n,c,f,o,A,b)},J.setTransform=function(n,c,f,o,A,b){s.setTransform(n,c,f,o,A,b),this.__originalSetTransform(n,c,f,o,A,b)},J.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},J.rotate=function(n){s.rotate(n),this.__originalRotate(n)},J.clip=function(n){s.clip(n),this.__originalClip(n)},J.moveTo=function(n,c){s.moveTo(n,c),this.__originalMoveTo(n,c)},J.lineTo=function(n,c){s.lineTo(n,c),this.__originalLineTo(n,c)},J.bezierCurveTo=function(n,c,f,o,A,b){s.bezierCurveTo(n,c,f,o,A,b),this.__originalBezierCurveTo(n,c,f,o,A,b)},J.rect=function(n,c,f,o){s.rect(n,c,f,o),this.__originalRect(n,c,f,o)},J.closePath=function(){s.closePath(),this.__originalClosePath()},J.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class yt{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,n,c){let f;return this.cache[s]!==void 0?(f=this.cache[s],this.canvasFactory.reset(f,n,c)):(f=this.canvasFactory.create(n,c),this.cache[s]=f),f}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const n=this.cache[s];this.canvasFactory.destroy(n),delete this.cache[s]}}}function It(J,s,n,c,f,o,A,b,y,u){const[a,h,i,r,g,E]=(0,et.getCurrentTransform)(J);if(h===0&&i===0){const U=A*a+g,F=Math.round(U),G=b*r+E,p=Math.round(G),_=(A+y)*a+g,H=Math.abs(Math.round(_)-F)||1,w=(b+u)*r+E,m=Math.abs(Math.round(w)-p)||1;return J.setTransform(Math.sign(a),0,0,Math.sign(r),F,p),J.drawImage(s,n,c,f,o,0,0,H,m),J.setTransform(a,h,i,r,g,E),[H,m]}if(a===0&&r===0){const U=b*i+g,F=Math.round(U),G=A*h+E,p=Math.round(G),_=(b+u)*i+g,H=Math.abs(Math.round(_)-F)||1,w=(A+y)*h+E,m=Math.abs(Math.round(w)-p)||1;return J.setTransform(0,Math.sign(h),Math.sign(i),0,F,p),J.drawImage(s,n,c,f,o,0,0,m,H),J.setTransform(a,h,i,r,g,E),[m,H]}J.drawImage(s,n,c,f,o,A,b,y,u);const v=Math.hypot(a,h),k=Math.hypot(i,r);return[v*y,k*u]}function Et(J){const{width:s,height:n}=J;if(s>O||n>O)return null;const c=1e3,f=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=s+1;let A=new Uint8Array(o*(n+1)),b,y,u;const a=s+7&-8;let h=new Uint8Array(a*n),i=0;for(const v of J.data){let k=128;for(;k>0;)h[i++]=v&k?0:255,k>>=1}let r=0;for(i=0,h[i]!==0&&(A[0]=1,++r),y=1;y<s;y++)h[i]!==h[i+1]&&(A[y]=h[i]?2:1,++r),i++;for(h[i]!==0&&(A[y]=2,++r),b=1;b<n;b++){i=b*a,u=b*o,h[i-a]!==h[i]&&(A[u]=h[i]?1:8,++r);let v=(h[i]?4:0)+(h[i-a]?8:0);for(y=1;y<s;y++)v=(v>>2)+(h[i+1]?4:0)+(h[i-a+1]?8:0),f[v]&&(A[u+y]=f[v],++r),i++;if(h[i-a]!==h[i]&&(A[u+y]=h[i]?2:4,++r),r>c)return null}for(i=a*(n-1),u=b*o,h[i]!==0&&(A[u]=8,++r),y=1;y<s;y++)h[i]!==h[i+1]&&(A[u+y]=h[i]?4:8,++r),i++;if(h[i]!==0&&(A[u+y]=4,++r),r>c)return null;const g=new Int32Array([0,o,-1,0,-o,0,0,0,1]),E=new Path2D;for(b=0;r&&b<=n;b++){let v=b*o;const k=v+s;for(;v<k&&!A[v];)v++;if(v===k)continue;E.moveTo(v%o,b);const U=v;let F=A[v];do{const G=g[F];do v+=G;while(!A[v]);const p=A[v];p!==5&&p!==10?(F=p,A[v]=0):(F=p&51*F>>4,A[v]&=F>>2|F<<2),E.lineTo(v%o,v/o|0),A[v]||--r}while(U!==v);--b}return h=null,A=null,function(v){v.save(),v.scale(1/s,-1/n),v.translate(0,-n),v.fill(E),v.beginPath(),v.restore()}}class Ot{constructor(s,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=d.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=d.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,n])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,n){this.x=s,this.y=n}updatePathMinMax(s,n,c){[n,c]=d.Util.applyTransform([n,c],s),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,c),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,c)}updateRectMinMax(s,n){const c=d.Util.applyTransform(n,s),f=d.Util.applyTransform(n.slice(2),s),o=d.Util.applyTransform([n[0],n[3]],s),A=d.Util.applyTransform([n[2],n[1]],s);this.minX=Math.min(this.minX,c[0],f[0],o[0],A[0]),this.minY=Math.min(this.minY,c[1],f[1],o[1],A[1]),this.maxX=Math.max(this.maxX,c[0],f[0],o[0],A[0]),this.maxY=Math.max(this.maxY,c[1],f[1],o[1],A[1])}updateScalingPathMinMax(s,n){d.Util.scaleMinMax(s,n),this.minX=Math.min(this.minX,n[0]),this.minY=Math.min(this.minY,n[1]),this.maxX=Math.max(this.maxX,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(s,n,c,f,o,A,b,y,u,a){const h=d.Util.bezierBoundingBox(n,c,f,o,A,b,y,u,a);a||this.updateRectMinMax(s,h)}getPathBoundingBox(s=I.FILL,n=null){const c=[this.minX,this.minY,this.maxX,this.maxY];if(s===I.STROKE){n||(0,d.unreachable)("Stroke bounding box must include transform.");const f=d.Util.singularValueDecompose2dScale(n),o=f[0]*this.lineWidth/2,A=f[1]*this.lineWidth/2;c[0]-=o,c[1]-=A,c[2]+=o,c[3]+=A}return c}updateClipFromPath(){const s=d.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=I.FILL,n=null){return d.Util.intersect(this.clipBox,this.getPathBoundingBox(s,n))}}function Mt(J,s){if(typeof ImageData<"u"&&s instanceof ImageData){J.putImageData(s,0,0);return}const n=s.height,c=s.width,f=n%st,o=(n-f)/st,A=f===0?o:o+1,b=J.createImageData(c,st);let y=0,u;const a=s.data,h=b.data;let i,r,g,E;if(s.kind===d.ImageKind.GRAYSCALE_1BPP){const v=a.byteLength,k=new Uint32Array(h.buffer,0,h.byteLength>>2),U=k.length,F=c+7>>3,G=4294967295,p=d.FeatureTest.isLittleEndian?4278190080:255;for(i=0;i<A;i++){for(g=i<o?st:f,u=0,r=0;r<g;r++){const _=v-y;let H=0;const w=_>F?c:_*8-7,m=w&-8;let L=0,N=0;for(;H<m;H+=8)N=a[y++],k[u++]=N&128?G:p,k[u++]=N&64?G:p,k[u++]=N&32?G:p,k[u++]=N&16?G:p,k[u++]=N&8?G:p,k[u++]=N&4?G:p,k[u++]=N&2?G:p,k[u++]=N&1?G:p;for(;H<w;H++)L===0&&(N=a[y++],L=128),k[u++]=N&L?G:p,L>>=1}for(;u<U;)k[u++]=0;J.putImageData(b,0,i*st)}}else if(s.kind===d.ImageKind.RGBA_32BPP){for(r=0,E=c*st*4,i=0;i<o;i++)h.set(a.subarray(y,y+E)),y+=E,J.putImageData(b,0,r),r+=st;i<A&&(E=c*f*4,h.set(a.subarray(y,y+E)),J.putImageData(b,0,r))}else if(s.kind===d.ImageKind.RGB_24BPP)for(g=st,E=c*g,i=0;i<A;i++){for(i>=o&&(g=f,E=c*g),u=0,r=E;r--;)h[u++]=a[y++],h[u++]=a[y++],h[u++]=a[y++],h[u++]=255;J.putImageData(b,0,i*st)}else throw new Error(`bad image kind: ${s.kind}`)}function Bt(J,s){if(s.bitmap){J.drawImage(s.bitmap,0,0);return}const n=s.height,c=s.width,f=n%st,o=(n-f)/st,A=f===0?o:o+1,b=J.createImageData(c,st);let y=0;const u=s.data,a=b.data;for(let h=0;h<A;h++){const i=h<o?st:f;({srcPos:y}=nt({src:u,srcPos:y,dest:a,width:c,height:i,nonBlackColor:0})),J.putImageData(b,0,h*st)}}function jt(J,s){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const c of n)J[c]!==void 0&&(s[c]=J[c]);J.setLineDash!==void 0&&(s.setLineDash(J.getLineDash()),s.lineDashOffset=J.lineDashOffset)}function Jt(J){if(J.strokeStyle=J.fillStyle="#000000",J.fillRule="nonzero",J.globalAlpha=1,J.lineWidth=1,J.lineCap="butt",J.lineJoin="miter",J.miterLimit=10,J.globalCompositeOperation="source-over",J.font="10px sans-serif",J.setLineDash!==void 0&&(J.setLineDash([]),J.lineDashOffset=0),!d.isNodeJS){const{filter:s}=J;s!=="none"&&s!==""&&(J.filter="none")}}function ht(J,s,n,c){const f=J.length;for(let o=3;o<f;o+=4){const A=J[o];if(A===0)J[o-3]=s,J[o-2]=n,J[o-1]=c;else if(A<255){const b=255-A;J[o-3]=J[o-3]*A+s*b>>8,J[o-2]=J[o-2]*A+n*b>>8,J[o-1]=J[o-1]*A+c*b>>8}}}function Tt(J,s,n){const c=J.length,f=1/255;for(let o=3;o<c;o+=4){const A=n?n[J[o]]:J[o];s[o]=s[o]*A*f|0}}function Vt(J,s,n){const c=J.length;for(let f=3;f<c;f+=4){const o=J[f-3]*77+J[f-2]*152+J[f-1]*28;s[f]=n?s[f]*n[o>>8]>>8:s[f]*o>>16}}function Ut(J,s,n,c,f,o,A,b,y,u,a){const h=!!o,i=h?o[0]:0,r=h?o[1]:0,g=h?o[2]:0,E=f==="Luminosity"?Vt:Tt,v=Math.min(c,Math.ceil(1048576/n));for(let k=0;k<c;k+=v){const U=Math.min(v,c-k),F=J.getImageData(b-u,k+(y-a),n,U),G=s.getImageData(b,k+y,n,U);h&&ht(F.data,i,r,g),E(F.data,G.data,A),s.putImageData(G,b,k+y)}}function ee(J,s,n,c){const f=c[0],o=c[1],A=c[2]-f,b=c[3]-o;A===0||b===0||(Ut(s.context,n,A,b,s.subtype,s.backdrop,s.transferMap,f,o,s.offsetX,s.offsetY),J.save(),J.globalAlpha=1,J.globalCompositeOperation="source-over",J.setTransform(1,0,0,1,0,0),J.drawImage(n.canvas,0,0),J.restore())}function ne(J,s){const n=d.Util.singularValueDecompose2dScale(J);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const c=Math.fround((globalThis.devicePixelRatio||1)*et.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:n[0]<=c||n[1]<=c}const le=["butt","round","square"],Ce=["miter","round","bevel"],ge={},ve={},se=class se{constructor(s,n,c,f,o,{optionalContentConfig:A,markedContentStack:b=null},y,u){l(this,oe);l(this,re);this.ctx=s,this.current=new Ot(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=c,this.canvasFactory=f,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=b||[],this.optionalContentConfig=A,this.cachedCanvases=new yt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=y,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,n=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):n}beginDrawing({transform:s,viewport:n,transparency:c=!1,background:f=null}){const o=this.ctx.canvas.width,A=this.ctx.canvas.height,b=this.ctx.fillStyle;if(this.ctx.fillStyle=f||"#ffffff",this.ctx.fillRect(0,0,o,A),this.ctx.fillStyle=b,c){const y=this.cachedCanvases.getCanvas("transparent",o,A);this.compositeCtx=this.ctx,this.transparentCanvas=y.canvas,this.ctx=y.context,this.ctx.save(),this.ctx.transform(...(0,et.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Jt(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,et.getCurrentTransform)(this.ctx)}executeOperatorList(s,n,c,f){const o=s.argsArray,A=s.fnArray;let b=n||0;const y=o.length;if(y===b)return b;const u=y-b>V&&typeof c=="function",a=u?Date.now()+$:0;let h=0;const i=this.commonObjs,r=this.objs;let g;for(;;){if(f!==void 0&&b===f.nextBreakPoint)return f.breakIt(b,c),b;if(g=A[b],g!==d.OPS.dependency)this[g].apply(this,o[b]);else for(const E of o[b]){const v=E.startsWith("g_")?i:r;if(!v.has(E))return v.get(E,c),b}if(b++,b===y)return b;if(u&&++h>V){if(Date.now()>a)return c(),b;h=0}}}endDrawing(){S(this,oe,bn).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const n of s.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);s.clear()}this._cachedBitmapsMap.clear(),S(this,re,vn).call(this)}_scaleImage(s,n){const c=s.width,f=s.height;let o=Math.max(Math.hypot(n[0],n[1]),1),A=Math.max(Math.hypot(n[2],n[3]),1),b=c,y=f,u="prescale1",a,h;for(;o>2&&b>1||A>2&&y>1;){let i=b,r=y;o>2&&b>1&&(i=b>=16384?Math.floor(b/2)-1||1:Math.ceil(b/2),o/=b/i),A>2&&y>1&&(r=y>=16384?Math.floor(y/2)-1||1:Math.ceil(y)/2,A/=y/r),a=this.cachedCanvases.getCanvas(u,i,r),h=a.context,h.clearRect(0,0,i,r),h.drawImage(s,0,0,b,y,0,0,i,r),s=a.canvas,b=i,y=r,u=u==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:b,paintHeight:y}}_createMaskCanvas(s){const n=this.ctx,{width:c,height:f}=s,o=this.current.fillColor,A=this.current.patternFill,b=(0,et.getCurrentTransform)(n);let y,u,a,h;if((s.bitmap||s.data)&&s.count>1){const w=s.bitmap||s.data.buffer;u=JSON.stringify(A?b:[b.slice(0,4),o]),y=this._cachedBitmapsMap.get(w),y||(y=new Map,this._cachedBitmapsMap.set(w,y));const m=y.get(u);if(m&&!A){const L=Math.round(Math.min(b[0],b[2])+b[4]),N=Math.round(Math.min(b[1],b[3])+b[5]);return{canvas:m,offsetX:L,offsetY:N}}a=m}a||(h=this.cachedCanvases.getCanvas("maskCanvas",c,f),Bt(h.context,s));let i=d.Util.transform(b,[1/c,0,0,-1/f,0,0]);i=d.Util.transform(i,[1,0,0,1,0,-f]);const[r,g,E,v]=d.Util.getAxialAlignedBoundingBox([0,0,c,f],i),k=Math.round(E-r)||1,U=Math.round(v-g)||1,F=this.cachedCanvases.getCanvas("fillCanvas",k,U),G=F.context,p=r,_=g;G.translate(-p,-_),G.transform(...i),a||(a=this._scaleImage(h.canvas,(0,et.getCurrentTransformInverse)(G)),a=a.img,y&&A&&y.set(u,a)),G.imageSmoothingEnabled=ne((0,et.getCurrentTransform)(G),s.interpolate),It(G,a,0,0,a.width,a.height,0,0,c,f),G.globalCompositeOperation="source-in";const H=d.Util.transform((0,et.getCurrentTransformInverse)(G),[1,0,0,1,-p,-_]);return G.fillStyle=A?o.getPattern(n,this,H,I.FILL):o,G.fillRect(0,0,c,f),y&&!A&&(this.cachedCanvases.delete("fillCanvas"),y.set(u,F.canvas)),{canvas:F.canvas,offsetX:Math.round(p),offsetY:Math.round(_)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=le[s]}setLineJoin(s){this.ctx.lineJoin=Ce[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,n){const c=this.ctx;c.setLineDash!==void 0&&(c.setLineDash(s),c.lineDashOffset=n)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[n,c]of s)switch(n){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c[0],c[1]);break;case"CA":this.current.strokeAlpha=c;break;case"ca":this.current.fillAlpha=c,this.ctx.globalAlpha=c;break;case"BM":this.ctx.globalCompositeOperation=c;break;case"SMask":this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,n=this.ctx.canvas.height,c="smaskGroupAt"+this.groupLevel,f=this.cachedCanvases.getCanvas(c,s,n);this.suspendedCtx=this.ctx,this.ctx=f.context;const o=this.ctx;o.setTransform(...(0,et.getCurrentTransform)(this.suspendedCtx)),jt(this.suspendedCtx,o),ot(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),jt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,c=this.suspendedCtx;ee(c,n,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(jt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),jt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,n,c,f,o,A){this.ctx.transform(s,n,c,f,o,A),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,n,c){const f=this.ctx,o=this.current;let A=o.x,b=o.y,y,u;const a=(0,et.getCurrentTransform)(f),h=a[0]===0&&a[3]===0||a[1]===0&&a[2]===0,i=h?c.slice(0):null;for(let r=0,g=0,E=s.length;r<E;r++)switch(s[r]|0){case d.OPS.rectangle:A=n[g++],b=n[g++];const v=n[g++],k=n[g++],U=A+v,F=b+k;f.moveTo(A,b),v===0||k===0?f.lineTo(U,F):(f.lineTo(U,b),f.lineTo(U,F),f.lineTo(A,F)),h||o.updateRectMinMax(a,[A,b,U,F]),f.closePath();break;case d.OPS.moveTo:A=n[g++],b=n[g++],f.moveTo(A,b),h||o.updatePathMinMax(a,A,b);break;case d.OPS.lineTo:A=n[g++],b=n[g++],f.lineTo(A,b),h||o.updatePathMinMax(a,A,b);break;case d.OPS.curveTo:y=A,u=b,A=n[g+4],b=n[g+5],f.bezierCurveTo(n[g],n[g+1],n[g+2],n[g+3],A,b),o.updateCurvePathMinMax(a,y,u,n[g],n[g+1],n[g+2],n[g+3],A,b,i),g+=6;break;case d.OPS.curveTo2:y=A,u=b,f.bezierCurveTo(A,b,n[g],n[g+1],n[g+2],n[g+3]),o.updateCurvePathMinMax(a,y,u,A,b,n[g],n[g+1],n[g+2],n[g+3],i),A=n[g+2],b=n[g+3],g+=4;break;case d.OPS.curveTo3:y=A,u=b,A=n[g+2],b=n[g+3],f.bezierCurveTo(n[g],n[g+1],A,b,A,b),o.updateCurvePathMinMax(a,y,u,n[g],n[g+1],A,b,A,b,i),g+=4;break;case d.OPS.closePath:f.closePath();break}h&&o.updateScalingPathMinMax(a,i),o.setCurrentPoint(A,b)}closePath(){this.ctx.closePath()}stroke(s=!0){const n=this.ctx,c=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof c=="object"&&(c!=null&&c.getPattern)?(n.save(),n.strokeStyle=c.getPattern(n,this,(0,et.getCurrentTransformInverse)(n),I.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const n=this.ctx,c=this.current.fillColor,f=this.current.patternFill;let o=!1;f&&(n.save(),n.fillStyle=c.getPattern(n,this,(0,et.getCurrentTransformInverse)(n),I.FILL),o=!0);const A=this.current.getClippedPathBoundingBox();this.contentVisible&&A!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),o&&n.restore(),s&&this.consumePath(A)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ge}eoClip(){this.pendingClip=ve}beginText(){this.current.textMatrix=d.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,n=this.ctx;if(s===void 0){n.beginPath();return}n.save(),n.beginPath();for(const c of s)n.setTransform(...c.transform),n.translate(c.x,c.y),c.addToPath(n,c.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,n){var a;const c=this.commonObjs.get(s),f=this.current;if(!c)throw new Error(`Can't find font for ${s}`);if(f.fontMatrix=c.fontMatrix||d.FONT_IDENTITY_MATRIX,(f.fontMatrix[0]===0||f.fontMatrix[3]===0)&&(0,d.warn)("Invalid font matrix for font "+s),n<0?(n=-n,f.fontDirection=-1):f.fontDirection=1,this.current.font=c,this.current.fontSize=n,c.isType3Font)return;const o=c.loadedName||"sans-serif",A=((a=c.systemFontInfo)==null?void 0:a.css)||`"${o}", ${c.fallbackName}`;let b="normal";c.black?b="900":c.bold&&(b="bold");const y=c.italic?"italic":"normal";let u=n;n<vt?u=vt:n>at&&(u=at),this.current.fontSizeScale=n/u,this.ctx.font=`${y} ${b} ${u}px ${A}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,n){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=n}setLeadingMoveText(s,n){this.setLeading(-n),this.moveText(s,n)}setTextMatrix(s,n,c,f,o,A){this.current.textMatrix=[s,n,c,f,o,A],this.current.textMatrixScale=Math.hypot(s,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,n,c,f){const o=this.ctx,A=this.current,b=A.font,y=A.textRenderingMode,u=A.fontSize/A.fontSizeScale,a=y&d.TextRenderingMode.FILL_STROKE_MASK,h=!!(y&d.TextRenderingMode.ADD_TO_PATH_FLAG),i=A.patternFill&&!b.missingFile;let r;(b.disableFontFace||h||i)&&(r=b.getPathGenerator(this.commonObjs,s)),b.disableFontFace||i?(o.save(),o.translate(n,c),o.beginPath(),r(o,u),f&&o.setTransform(...f),(a===d.TextRenderingMode.FILL||a===d.TextRenderingMode.FILL_STROKE)&&o.fill(),(a===d.TextRenderingMode.STROKE||a===d.TextRenderingMode.FILL_STROKE)&&o.stroke(),o.restore()):((a===d.TextRenderingMode.FILL||a===d.TextRenderingMode.FILL_STROKE)&&o.fillText(s,n,c),(a===d.TextRenderingMode.STROKE||a===d.TextRenderingMode.FILL_STROKE)&&o.strokeText(s,n,c)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,et.getCurrentTransform)(o),x:n,y:c,fontSize:u,addToPath:r})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const n=s.getImageData(0,0,10,10).data;let c=!1;for(let f=3;f<n.length;f+=4)if(n[f]>0&&n[f]<255){c=!0;break}return(0,d.shadow)(this,"isFontSubpixelAAEnabled",c)}showText(s){const n=this.current,c=n.font;if(c.isType3Font)return this.showType3Text(s);const f=n.fontSize;if(f===0)return;const o=this.ctx,A=n.fontSizeScale,b=n.charSpacing,y=n.wordSpacing,u=n.fontDirection,a=n.textHScale*u,h=s.length,i=c.vertical,r=i?1:-1,g=c.defaultVMetrics,E=f*n.fontMatrix[0],v=n.textRenderingMode===d.TextRenderingMode.FILL&&!c.disableFontFace&&!n.patternFill;o.save(),o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),u>0?o.scale(a,-1):o.scale(a,1);let k;if(n.patternFill){o.save();const _=n.fillColor.getPattern(o,this,(0,et.getCurrentTransformInverse)(o),I.FILL);k=(0,et.getCurrentTransform)(o),o.restore(),o.fillStyle=_}let U=n.lineWidth;const F=n.textMatrixScale;if(F===0||U===0){const _=n.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;(_===d.TextRenderingMode.STROKE||_===d.TextRenderingMode.FILL_STROKE)&&(U=this.getSinglePixelWidth())}else U/=F;if(A!==1&&(o.scale(A,A),U/=A),o.lineWidth=U,c.isInvalidPDFjsFont){const _=[];let H=0;for(const w of s)_.push(w.unicode),H+=w.width;o.fillText(_.join(""),0,0),n.x+=H*E*a,o.restore(),this.compose();return}let G=0,p;for(p=0;p<h;++p){const _=s[p];if(typeof _=="number"){G+=r*_*f/1e3;continue}let H=!1;const w=(_.isSpace?y:0)+b,m=_.fontChar,L=_.accent;let N,Z,ct=_.width;if(i){const St=_.vmetric||g,$t=-(_.vmetric?St[1]:ct*.5)*E,te=St[2]*E;ct=St?-St[0]:ct,N=$t/A,Z=(G+te)/A}else N=G/A,Z=0;if(c.remeasure&&ct>0){const St=o.measureText(m).width*1e3/f*A;if(ct<St&&this.isFontSubpixelAAEnabled){const $t=ct/St;H=!0,o.save(),o.scale($t,1),N/=$t}else ct!==St&&(N+=(ct-St)/2e3*f/A)}if(this.contentVisible&&(_.isInFont||c.missingFile)){if(v&&!L)o.fillText(m,N,Z);else if(this.paintChar(m,N,Z,k),L){const St=N+f*L.offset.x/A,$t=Z-f*L.offset.y/A;this.paintChar(L.fontChar,St,$t,k)}}const mt=i?ct*E-w*u:ct*E+w*u;G+=mt,H&&o.restore()}i?n.y-=G:n.x+=G*a,o.restore(),this.compose()}showType3Text(s){const n=this.ctx,c=this.current,f=c.font,o=c.fontSize,A=c.fontDirection,b=f.vertical?1:-1,y=c.charSpacing,u=c.wordSpacing,a=c.textHScale*A,h=c.fontMatrix||d.FONT_IDENTITY_MATRIX,i=s.length,r=c.textRenderingMode===d.TextRenderingMode.INVISIBLE;let g,E,v,k;if(!(r||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...c.textMatrix),n.translate(c.x,c.y),n.scale(a,A),g=0;g<i;++g){if(E=s[g],typeof E=="number"){k=b*E*o/1e3,this.ctx.translate(k,0),c.x+=k*a;continue}const U=(E.isSpace?u:0)+y,F=f.charProcOperatorList[E.operatorListId];if(!F){(0,d.warn)(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),n.scale(o,o),n.transform(...h),this.executeOperatorList(F),this.restore()),v=d.Util.applyTransform([E.width,0],h)[0]*o+U,n.translate(v,0),c.x+=v*a}n.restore(),this.processingType3=null}}setCharWidth(s,n){}setCharWidthAndBounds(s,n,c,f,o,A){this.ctx.rect(c,f,o-c,A-f),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let n;if(s[0]==="TilingPattern"){const c=s[1],f=this.baseTransform||(0,et.getCurrentTransform)(this.ctx),o={createCanvasGraphics:A=>new se(A,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new W(s,c,this.ctx,o,f)}else n=this._getPattern(s[1],s[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,n,c){const f=d.Util.makeHexColor(s,n,c);this.ctx.strokeStyle=f,this.current.strokeColor=f}setFillRGBColor(s,n,c){const f=d.Util.makeHexColor(s,n,c);this.ctx.fillStyle=f,this.current.fillColor=f,this.current.patternFill=!1}_getPattern(s,n=null){let c;return this.cachedPatterns.has(s)?c=this.cachedPatterns.get(s):(c=R(this.getObject(s)),this.cachedPatterns.set(s,c)),n&&(c.matrix=n),c}shadingFill(s){if(!this.contentVisible)return;const n=this.ctx;this.save();const c=this._getPattern(s);n.fillStyle=c.getPattern(n,this,(0,et.getCurrentTransformInverse)(n),I.SHADING);const f=(0,et.getCurrentTransformInverse)(n);if(f){const{width:o,height:A}=n.canvas,[b,y,u,a]=d.Util.getAxialAlignedBoundingBox([0,0,o,A],f);this.ctx.fillRect(b,y,u-b,a-y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,d.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,d.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,et.getCurrentTransform)(this.ctx),n)){const c=n[2]-n[0],f=n[3]-n[1];this.ctx.rect(n[0],n[1],c,f),this.current.updateRectMinMax((0,et.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;s.isolated||(0,d.info)("TODO: Support non-isolated groups."),s.knockout&&(0,d.warn)("Knockout groups not supported.");const c=(0,et.getCurrentTransform)(n);if(s.matrix&&n.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let f=d.Util.getAxialAlignedBoundingBox(s.bbox,(0,et.getCurrentTransform)(n));const o=[0,0,n.canvas.width,n.canvas.height];f=d.Util.intersect(f,o)||[0,0,0,0];const A=Math.floor(f[0]),b=Math.floor(f[1]);let y=Math.max(Math.ceil(f[2])-A,1),u=Math.max(Math.ceil(f[3])-b,1),a=1,h=1;y>z&&(a=y/z,y=z),u>z&&(h=u/z,u=z),this.current.startNewPathAndClipBox([0,0,y,u]);let i="groupAt"+this.groupLevel;s.smask&&(i+="_smask_"+this.smaskCounter++%2);const r=this.cachedCanvases.getCanvas(i,y,u),g=r.context;g.scale(1/a,1/h),g.translate(-A,-b),g.transform(...c),s.smask?this.smaskStack.push({canvas:r.canvas,context:g,offsetX:A,offsetY:b,scaleX:a,scaleY:h,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(A,b),n.scale(a,h),n.save()),jt(n,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,c=this.groupStack.pop();if(this.ctx=c,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const f=(0,et.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...f);const o=d.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],f);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(s,n,c,f,o){if(S(this,oe,bn).call(this),Jt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const A=n[2]-n[0],b=n[3]-n[1];if(o&&this.annotationCanvasMap){c=c.slice(),c[4]-=n[0],c[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=A,n[3]=b;const[y,u]=d.Util.singularValueDecompose2dScale((0,et.getCurrentTransform)(this.ctx)),{viewportScale:a}=this,h=Math.ceil(A*this.outputScaleX*a),i=Math.ceil(b*this.outputScaleY*a);this.annotationCanvas=this.canvasFactory.create(h,i);const{canvas:r,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(s,r),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(y,0,0,-u,0,b*u),Jt(this.ctx)}else Jt(this.ctx),this.ctx.rect(n[0],n[1],A,b),this.ctx.clip(),this.endPath()}this.current=new Ot(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...c),this.transform(...f)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),S(this,re,vn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const n=s.count;s=this.getObject(s.data,s),s.count=n;const c=this.ctx,f=this.processingType3;if(f&&(f.compiled===void 0&&(f.compiled=Et(s)),f.compiled)){f.compiled(c);return}const o=this._createMaskCanvas(s),A=o.canvas;c.save(),c.setTransform(1,0,0,1,0,0),c.drawImage(A,o.offsetX,o.offsetY),c.restore(),this.compose()}paintImageMaskXObjectRepeat(s,n,c=0,f=0,o,A){if(!this.contentVisible)return;s=this.getObject(s.data,s);const b=this.ctx;b.save();const y=(0,et.getCurrentTransform)(b);b.transform(n,c,f,o,0,0);const u=this._createMaskCanvas(s);b.setTransform(1,0,0,1,u.offsetX-y[4],u.offsetY-y[5]);for(let a=0,h=A.length;a<h;a+=2){const i=d.Util.transform(y,[n,c,f,o,A[a],A[a+1]]),[r,g]=d.Util.applyTransform([0,0],i);b.drawImage(u.canvas,r,g)}b.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const n=this.ctx,c=this.current.fillColor,f=this.current.patternFill;for(const o of s){const{data:A,width:b,height:y,transform:u}=o,a=this.cachedCanvases.getCanvas("maskCanvas",b,y),h=a.context;h.save();const i=this.getObject(A,o);Bt(h,i),h.globalCompositeOperation="source-in",h.fillStyle=f?c.getPattern(h,this,(0,et.getCurrentTransformInverse)(n),I.FILL):c,h.fillRect(0,0,b,y),h.restore(),n.save(),n.transform(...u),n.scale(1,-1),It(n,a.canvas,0,0,b,y,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const n=this.getObject(s);if(!n){(0,d.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(s,n,c,f){if(!this.contentVisible)return;const o=this.getObject(s);if(!o){(0,d.warn)("Dependent image isn't ready yet");return}const A=o.width,b=o.height,y=[];for(let u=0,a=f.length;u<a;u+=2)y.push({transform:[n,0,0,c,f[u],f[u+1]],x:0,y:0,w:A,h:b});this.paintInlineImageXObjectGroup(o,y)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:n,width:c,height:f}=s,o=this.cachedCanvases.getCanvas("inlineImage",c,f),A=o.context;return A.filter=this.current.transferMaps,A.drawImage(n,0,0),A.filter="none",o.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const n=s.width,c=s.height,f=this.ctx;if(this.save(),!d.isNodeJS){const{filter:b}=f;b!=="none"&&b!==""&&(f.filter="none")}f.scale(1/n,-1/c);let o;if(s.bitmap)o=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)o=s;else{const b=this.cachedCanvases.getCanvas("inlineImage",n,c).context;Mt(b,s),o=this.applyTransferMapsToCanvas(b)}const A=this._scaleImage(o,(0,et.getCurrentTransformInverse)(f));f.imageSmoothingEnabled=ne((0,et.getCurrentTransform)(f),s.interpolate),It(f,A.img,0,0,A.paintWidth,A.paintHeight,0,-c,n,c),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,n){if(!this.contentVisible)return;const c=this.ctx;let f;if(s.bitmap)f=s.bitmap;else{const o=s.width,A=s.height,b=this.cachedCanvases.getCanvas("inlineImage",o,A).context;Mt(b,s),f=this.applyTransferMapsToCanvas(b)}for(const o of n)c.save(),c.transform(...o.transform),c.scale(1,-1),It(c,f,o.x,o.y,o.w,o.h,0,-1,1,1),c.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,n){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,n){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const c=this.ctx;this.pendingClip&&(n||(this.pendingClip===ve?c.clip("evenodd"):c.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),c.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,et.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const n=Math.abs(s[0]*s[3]-s[2]*s[1]),c=Math.hypot(s[0],s[2]),f=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(c,f)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:n,b:c,c:f,d:o}=this.ctx.getTransform();let A,b;if(c===0&&f===0){const y=Math.abs(n),u=Math.abs(o);if(y===u)if(s===0)A=b=1/y;else{const a=y*s;A=b=a<1?1/a:1}else if(s===0)A=1/y,b=1/u;else{const a=y*s,h=u*s;A=a<1?1/a:1,b=h<1?1/h:1}}else{const y=Math.abs(n*o-c*f),u=Math.hypot(n,c),a=Math.hypot(f,o);if(s===0)A=a/y,b=u/y;else{const h=s*y;A=a>h?a/h:1,b=u>h?u/h:1}}this._cachedScaleForStroking[0]=A,this._cachedScaleForStroking[1]=b}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:n}=this,{lineWidth:c}=this.current,[f,o]=this.getScaleForStroking();if(n.lineWidth=c||1,f===1&&o===1){n.stroke();return}const A=n.getLineDash();if(s&&n.save(),n.scale(f,o),A.length>0){const b=Math.max(f,o);n.setLineDash(A.map(y=>y/b)),n.lineDashOffset/=b}n.stroke(),s&&n.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};oe=new WeakSet,bn=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},re=new WeakSet,vn=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const n=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}};let be=se;for(const J in d.OPS)be.prototype[J]!==void 0&&(be.prototype[d.OPS[J]]=be.prototype[J])},419:(Lt,_t,lt)=>{var jt,Jt,ht,Tt,Vt,Ut,ee,qs,le,Ws,ge,js,be,An,oe,zi,re,Bi,se,di,s,ui;lt.d(_t,{DOMCMapReaderFactory:()=>D,DOMCanvasFactory:()=>X,DOMFilterFactory:()=>gt,DOMSVGFactory:()=>q,DOMStandardFontDataFactory:()=>Q,PDFDateString:()=>st,PageViewport:()=>R,PixelsPerInch:()=>Y,RenderingCancelledException:()=>K,StatTimer:()=>z,fetchData:()=>B,getColorValues:()=>It,getCurrentTransform:()=>Et,getCurrentTransformInverse:()=>Ot,getFilenameFromUrl:()=>vt,getPdfFilenameFromUrl:()=>at,getRGB:()=>yt,getXfaPageViewport:()=>ot,isDataScheme:()=>W,isPdfFile:()=>nt,isValidFetchUrl:()=>$,noContextMenu:()=>V,setLayerDimensions:()=>Mt});var d=lt(583),et=lt(292);const I="http://www.w3.org/2000/svg",Bt=class Bt{};me(Bt,"CSS",96),me(Bt,"PDF",72),me(Bt,"PDF_TO_CSS_UNITS",Bt.CSS/Bt.PDF);let Y=Bt;class gt extends d.BaseFilterFactory{constructor({docId:o,ownerDocument:A=globalThis.document}={}){super();l(this,ee);l(this,le);l(this,ge);l(this,be);l(this,oe);l(this,re);l(this,se);l(this,s);l(this,jt,void 0);l(this,Jt,void 0);l(this,ht,void 0);l(this,Tt,void 0);l(this,Vt,void 0);l(this,Ut,0);C(this,ht,o),C(this,Tt,A)}addFilter(o){if(!o)return"none";let A=t(this,ee,qs).get(o);if(A)return A;let b,y,u,a;if(o.length===1){const g=o[0],E=new Array(256);for(let v=0;v<256;v++)E[v]=g[v]/255;a=b=y=u=E.join(",")}else{const[g,E,v]=o,k=new Array(256),U=new Array(256),F=new Array(256);for(let G=0;G<256;G++)k[G]=g[G]/255,U[G]=E[G]/255,F[G]=v[G]/255;b=k.join(","),y=U.join(","),u=F.join(","),a=`${b}${y}${u}`}if(A=t(this,ee,qs).get(a),A)return t(this,ee,qs).set(o,A),A;const h=`g_${t(this,ht)}_transfer_map_${us(this,Ut)._++}`,i=`url(#${h})`;t(this,ee,qs).set(o,i),t(this,ee,qs).set(a,i);const r=S(this,oe,zi).call(this,h);return S(this,se,di).call(this,b,y,u,r),i}addHCMFilter(o,A){var k;const b=`${o}-${A}`,y="base";let u=t(this,le,Ws).get(y);if((u==null?void 0:u.key)===b||(u?((k=u.filter)==null||k.remove(),u.key=b,u.url="none",u.filter=null):(u={key:b,url:"none",filter:null},t(this,le,Ws).set(y,u)),!o||!A))return u.url;const a=S(this,s,ui).call(this,o);o=et.Util.makeHexColor(...a);const h=S(this,s,ui).call(this,A);if(A=et.Util.makeHexColor(...h),t(this,ge,js).style.color="",o==="#000000"&&A==="#ffffff"||o===A)return u.url;const i=new Array(256);for(let U=0;U<=255;U++){const F=U/255;i[U]=F<=.03928?F/12.92:((F+.055)/1.055)**2.4}const r=i.join(","),g=`g_${t(this,ht)}_hcm_filter`,E=u.filter=S(this,oe,zi).call(this,g);S(this,se,di).call(this,r,r,r,E),S(this,be,An).call(this,E);const v=(U,F)=>{const G=a[U]/255,p=h[U]/255,_=new Array(F+1);for(let H=0;H<=F;H++)_[H]=G+H/F*(p-G);return _.join(",")};return S(this,se,di).call(this,v(0,5),v(1,5),v(2,5),E),u.url=`url(#${g})`,u.url}addHighlightHCMFilter(o,A,b,y,u){var p;const a=`${A}-${b}-${y}-${u}`;let h=t(this,le,Ws).get(o);if((h==null?void 0:h.key)===a||(h?((p=h.filter)==null||p.remove(),h.key=a,h.url="none",h.filter=null):(h={key:a,url:"none",filter:null},t(this,le,Ws).set(o,h)),!A||!b))return h.url;const[i,r]=[A,b].map(S(this,s,ui).bind(this));let g=Math.round(.2126*i[0]+.7152*i[1]+.0722*i[2]),E=Math.round(.2126*r[0]+.7152*r[1]+.0722*r[2]),[v,k]=[y,u].map(S(this,s,ui).bind(this));E<g&&([g,E,v,k]=[E,g,k,v]),t(this,ge,js).style.color="";const U=(_,H,w)=>{const m=new Array(256),L=(E-g)/w,N=_/255,Z=(H-_)/(255*w);let ct=0;for(let mt=0;mt<=w;mt++){const St=Math.round(g+mt*L),$t=N+mt*Z;for(let te=ct;te<=St;te++)m[te]=$t;ct=St+1}for(let mt=ct;mt<256;mt++)m[mt]=m[ct-1];return m.join(",")},F=`g_${t(this,ht)}_hcm_${o}_filter`,G=h.filter=S(this,oe,zi).call(this,F);return S(this,be,An).call(this,G),S(this,se,di).call(this,U(v[0],k[0],5),U(v[1],k[1],5),U(v[2],k[2],5),G),h.url=`url(#${F})`,h.url}destroy(o=!1){o&&t(this,le,Ws).size!==0||(t(this,Jt)&&(t(this,Jt).parentNode.parentNode.remove(),C(this,Jt,null)),t(this,jt)&&(t(this,jt).clear(),C(this,jt,null)),C(this,Ut,0))}}jt=new WeakMap,Jt=new WeakMap,ht=new WeakMap,Tt=new WeakMap,Vt=new WeakMap,Ut=new WeakMap,ee=new WeakSet,qs=function(){return t(this,jt)||C(this,jt,new Map)},le=new WeakSet,Ws=function(){return t(this,Vt)||C(this,Vt,new Map)},ge=new WeakSet,js=function(){if(!t(this,Jt)){const o=t(this,Tt).createElement("div"),{style:A}=o;A.visibility="hidden",A.contain="strict",A.width=A.height=0,A.position="absolute",A.top=A.left=0,A.zIndex=-1;const b=t(this,Tt).createElementNS(I,"svg");b.setAttribute("width",0),b.setAttribute("height",0),C(this,Jt,t(this,Tt).createElementNS(I,"defs")),o.append(b),b.append(t(this,Jt)),t(this,Tt).body.append(o)}return t(this,Jt)},be=new WeakSet,An=function(o){const A=t(this,Tt).createElementNS(I,"feColorMatrix");A.setAttribute("type","matrix"),A.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),o.append(A)},oe=new WeakSet,zi=function(o){const A=t(this,Tt).createElementNS(I,"filter");return A.setAttribute("color-interpolation-filters","sRGB"),A.setAttribute("id",o),t(this,ge,js).append(A),A},re=new WeakSet,Bi=function(o,A,b){const y=t(this,Tt).createElementNS(I,A);y.setAttribute("type","discrete"),y.setAttribute("tableValues",b),o.append(y)},se=new WeakSet,di=function(o,A,b,y){const u=t(this,Tt).createElementNS(I,"feComponentTransfer");y.append(u),S(this,re,Bi).call(this,u,"feFuncR",o),S(this,re,Bi).call(this,u,"feFuncG",A),S(this,re,Bi).call(this,u,"feFuncB",b)},s=new WeakSet,ui=function(o){return t(this,ge,js).style.color=o,yt(getComputedStyle(t(this,ge,js)).getPropertyValue("color"))};class X extends d.BaseCanvasFactory{constructor({ownerDocument:f=globalThis.document}={}){super(),this._document=f}_createCanvas(f,o){const A=this._document.createElement("canvas");return A.width=f,A.height=o,A}}async function B(c,f="text"){if($(c,document.baseURI)){const o=await fetch(c);if(!o.ok)throw new Error(o.statusText);switch(f){case"arraybuffer":return o.arrayBuffer();case"blob":return o.blob();case"json":return o.json()}return o.text()}return new Promise((o,A)=>{const b=new XMLHttpRequest;b.open("GET",c,!0),b.responseType=f,b.onreadystatechange=()=>{if(b.readyState===XMLHttpRequest.DONE){if(b.status===200||b.status===0){switch(f){case"arraybuffer":case"blob":case"json":o(b.response);return}o(b.responseText);return}A(new Error(b.statusText))}},b.send(null)})}class D extends d.BaseCMapReaderFactory{_fetchData(f,o){return B(f,this.isCompressed?"arraybuffer":"text").then(A=>({cMapData:A instanceof ArrayBuffer?new Uint8Array(A):(0,et.stringToBytes)(A),compressionType:o}))}}class Q extends d.BaseStandardFontDataFactory{_fetchData(f){return B(f,"arraybuffer").then(o=>new Uint8Array(o))}}class q extends d.BaseSVGFactory{_createSVG(f){return document.createElementNS(I,f)}}class R{constructor({viewBox:f,scale:o,rotation:A,offsetX:b=0,offsetY:y=0,dontFlip:u=!1}){this.viewBox=f,this.scale=o,this.rotation=A,this.offsetX=b,this.offsetY=y;const a=(f[2]+f[0])/2,h=(f[3]+f[1])/2;let i,r,g,E;switch(A%=360,A<0&&(A+=360),A){case 180:i=-1,r=0,g=0,E=1;break;case 90:i=0,r=1,g=1,E=0;break;case 270:i=0,r=-1,g=-1,E=0;break;case 0:i=1,r=0,g=0,E=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(g=-g,E=-E);let v,k,U,F;i===0?(v=Math.abs(h-f[1])*o+b,k=Math.abs(a-f[0])*o+y,U=(f[3]-f[1])*o,F=(f[2]-f[0])*o):(v=Math.abs(a-f[0])*o+b,k=Math.abs(h-f[1])*o+y,U=(f[2]-f[0])*o,F=(f[3]-f[1])*o),this.transform=[i*o,r*o,g*o,E*o,v-i*o*a-g*o*h,k-r*o*a-E*o*h],this.width=U,this.height=F}get rawDims(){const{viewBox:f}=this;return(0,et.shadow)(this,"rawDims",{pageWidth:f[2]-f[0],pageHeight:f[3]-f[1],pageX:f[0],pageY:f[1]})}clone({scale:f=this.scale,rotation:o=this.rotation,offsetX:A=this.offsetX,offsetY:b=this.offsetY,dontFlip:y=!1}={}){return new R({viewBox:this.viewBox.slice(),scale:f,rotation:o,offsetX:A,offsetY:b,dontFlip:y})}convertToViewportPoint(f,o){return et.Util.applyTransform([f,o],this.transform)}convertToViewportRectangle(f){const o=et.Util.applyTransform([f[0],f[1]],this.transform),A=et.Util.applyTransform([f[2],f[3]],this.transform);return[o[0],o[1],A[0],A[1]]}convertToPdfPoint(f,o){return et.Util.applyInverseTransform([f,o],this.transform)}}class K extends et.BaseException{constructor(f,o=0){super(f,"RenderingCancelledException"),this.extraDelay=o}}function W(c){const f=c.length;let o=0;for(;o<f&&c[o].trim()==="";)o++;return c.substring(o,o+5).toLowerCase()==="data:"}function nt(c){return typeof c=="string"&&/\.pdf$/i.test(c)}function vt(c,f=!1){return f||([c]=c.split(/[#?]/,1)),c.substring(c.lastIndexOf("/")+1)}function at(c,f="document.pdf"){if(typeof c!="string")return f;if(W(c))return(0,et.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),f;const o=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,A=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,b=o.exec(c);let y=A.exec(b[1])||A.exec(b[2])||A.exec(b[3]);if(y&&(y=y[0],y.includes("%")))try{y=A.exec(decodeURIComponent(y))[0]}catch{}return y||f}class z{constructor(){me(this,"started",Object.create(null));me(this,"times",[])}time(f){f in this.started&&(0,et.warn)(`Timer is already running for ${f}`),this.started[f]=Date.now()}timeEnd(f){f in this.started||(0,et.warn)(`Timer has not been started for ${f}`),this.times.push({name:f,start:this.started[f],end:Date.now()}),delete this.started[f]}toString(){const f=[];let o=0;for(const{name:A}of this.times)o=Math.max(A.length,o);for(const{name:A,start:b,end:y}of this.times)f.push(`${A.padEnd(o)} ${y-b}ms
`);return f.join("")}}function $(c,f){try{const{protocol:o}=f?new URL(c,f):new URL(c);return o==="http:"||o==="https:"}catch{return!1}}function V(c){c.preventDefault()}let O;class st{static toDateObject(f){if(!f||typeof f!="string")return null;O||(O=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const o=O.exec(f);if(!o)return null;const A=parseInt(o[1],10);let b=parseInt(o[2],10);b=b>=1&&b<=12?b-1:0;let y=parseInt(o[3],10);y=y>=1&&y<=31?y:1;let u=parseInt(o[4],10);u=u>=0&&u<=23?u:0;let a=parseInt(o[5],10);a=a>=0&&a<=59?a:0;let h=parseInt(o[6],10);h=h>=0&&h<=59?h:0;const i=o[7]||"Z";let r=parseInt(o[8],10);r=r>=0&&r<=23?r:0;let g=parseInt(o[9],10)||0;return g=g>=0&&g<=59?g:0,i==="-"?(u+=r,a+=g):i==="+"&&(u-=r,a-=g),new Date(Date.UTC(A,b,y,u,a,h))}}function ot(c,{scale:f=1,rotation:o=0}){const{width:A,height:b}=c.attributes.style,y=[0,0,parseInt(A),parseInt(b)];return new R({viewBox:y,scale:f,rotation:o})}function yt(c){if(c.startsWith("#")){const f=parseInt(c.slice(1),16);return[(f&16711680)>>16,(f&65280)>>8,f&255]}return c.startsWith("rgb(")?c.slice(4,-1).split(",").map(f=>parseInt(f)):c.startsWith("rgba(")?c.slice(5,-1).split(",").map(f=>parseInt(f)).slice(0,3):((0,et.warn)(`Not a valid color format: "${c}"`),[0,0,0])}function It(c){const f=document.createElement("span");f.style.visibility="hidden",document.body.append(f);for(const o of c.keys()){f.style.color=o;const A=window.getComputedStyle(f).color;c.set(o,yt(A))}f.remove()}function Et(c){const{a:f,b:o,c:A,d:b,e:y,f:u}=c.getTransform();return[f,o,A,b,y,u]}function Ot(c){const{a:f,b:o,c:A,d:b,e:y,f:u}=c.getTransform().invertSelf();return[f,o,A,b,y,u]}function Mt(c,f,o=!1,A=!0){if(f instanceof R){const{pageWidth:b,pageHeight:y}=f.rawDims,{style:u}=c,a=et.FeatureTest.isCSSRoundSupported,h=`var(--scale-factor) * ${b}px`,i=`var(--scale-factor) * ${y}px`,r=a?`round(${h}, 1px)`:`calc(${h})`,g=a?`round(${i}, 1px)`:`calc(${i})`;!o||f.rotation%180===0?(u.width=r,u.height=g):(u.width=g,u.height=r)}A&&c.setAttribute("data-main-rotation",f.rotation)}},47:(Lt,_t,lt)=>{var Y,gt,X,B,D,yn,q,wn,K,br;lt.d(_t,{DrawLayer:()=>I});var d=lt(419),et=lt(292);const nt=class nt{constructor({pageIndex:at}){l(this,q);l(this,K);l(this,Y,null);l(this,gt,0);l(this,X,new Map);l(this,B,new Map);this.pageIndex=at}setParent(at){if(!t(this,Y)){C(this,Y,at);return}if(t(this,Y)!==at){if(t(this,X).size>0)for(const z of t(this,X).values())z.remove(),at.append(z);C(this,Y,at)}}static get _svgFactory(){return(0,et.shadow)(this,"_svgFactory",new d.DOMSVGFactory)}highlight(at,z,$,V=!1){const O=us(this,gt)._++,st=S(this,q,wn).call(this,at.box);st.classList.add("highlight"),at.free&&st.classList.add("free");const ot=nt._svgFactory.createElement("defs");st.append(ot);const yt=nt._svgFactory.createElement("path");ot.append(yt);const It=`path_p${this.pageIndex}_${O}`;yt.setAttribute("id",It),yt.setAttribute("d",at.toSVGPath()),V&&t(this,B).set(O,yt);const Et=S(this,K,br).call(this,ot,It),Ot=nt._svgFactory.createElement("use");return st.append(Ot),st.setAttribute("fill",z),st.setAttribute("fill-opacity",$),Ot.setAttribute("href",`#${It}`),t(this,X).set(O,st),{id:O,clipPathId:`url(#${Et})`}}highlightOutline(at){const z=us(this,gt)._++,$=S(this,q,wn).call(this,at.box);$.classList.add("highlightOutline");const V=nt._svgFactory.createElement("defs");$.append(V);const O=nt._svgFactory.createElement("path");V.append(O);const st=`path_p${this.pageIndex}_${z}`;O.setAttribute("id",st),O.setAttribute("d",at.toSVGPath()),O.setAttribute("vector-effect","non-scaling-stroke");let ot;if(at.free){$.classList.add("free");const Et=nt._svgFactory.createElement("mask");V.append(Et),ot=`mask_p${this.pageIndex}_${z}`,Et.setAttribute("id",ot),Et.setAttribute("maskUnits","objectBoundingBox");const Ot=nt._svgFactory.createElement("rect");Et.append(Ot),Ot.setAttribute("width","1"),Ot.setAttribute("height","1"),Ot.setAttribute("fill","white");const Mt=nt._svgFactory.createElement("use");Et.append(Mt),Mt.setAttribute("href",`#${st}`),Mt.setAttribute("stroke","none"),Mt.setAttribute("fill","black"),Mt.setAttribute("fill-rule","nonzero"),Mt.classList.add("mask")}const yt=nt._svgFactory.createElement("use");$.append(yt),yt.setAttribute("href",`#${st}`),ot&&yt.setAttribute("mask",`url(#${ot})`);const It=yt.cloneNode();return $.append(It),yt.classList.add("mainOutline"),It.classList.add("secondaryOutline"),t(this,X).set(z,$),z}finalizeLine(at,z){const $=t(this,B).get(at);t(this,B).delete(at),this.updateBox(at,z.box),$.setAttribute("d",z.toSVGPath())}updateLine(at,z){t(this,X).get(at).firstChild.firstChild.setAttribute("d",z.toSVGPath())}removeFreeHighlight(at){this.remove(at),t(this,B).delete(at)}updatePath(at,z){t(this,B).get(at).setAttribute("d",z.toSVGPath())}updateBox(at,z){var $;S($=nt,D,yn).call($,t(this,X).get(at),z)}show(at,z){t(this,X).get(at).classList.toggle("hidden",!z)}rotate(at,z){t(this,X).get(at).setAttribute("data-main-rotation",z)}changeColor(at,z){t(this,X).get(at).setAttribute("fill",z)}changeOpacity(at,z){t(this,X).get(at).setAttribute("fill-opacity",z)}addClass(at,z){t(this,X).get(at).classList.add(z)}removeClass(at,z){t(this,X).get(at).classList.remove(z)}remove(at){t(this,Y)!==null&&(t(this,X).get(at).remove(),t(this,X).delete(at))}destroy(){C(this,Y,null);for(const at of t(this,X).values())at.remove();t(this,X).clear()}};Y=new WeakMap,gt=new WeakMap,X=new WeakMap,B=new WeakMap,D=new WeakSet,yn=function(at,{x:z=0,y:$=0,width:V=1,height:O=1}={}){const{style:st}=at;st.top=`${100*$}%`,st.left=`${100*z}%`,st.width=`${100*V}%`,st.height=`${100*O}%`},q=new WeakSet,wn=function(at){var $;const z=nt._svgFactory.create(1,1,!0);return t(this,Y).append(z),z.setAttribute("aria-hidden",!0),S($=nt,D,yn).call($,z,at),z},K=new WeakSet,br=function(at,z){const $=nt._svgFactory.createElement("clipPath");at.append($);const V=`clip_${z}`;$.setAttribute("id",V),$.setAttribute("clipPathUnits","objectBoundingBox");const O=nt._svgFactory.createElement("use");return $.append(O),O.setAttribute("href",`#${z}`),O.classList.add("clip"),V},l(nt,D);let I=nt},731:(Lt,_t,lt)=>{var nt,vt,at,z,$,V,O,st,ot,yt,It,vr,Ot,Ar,Bt,yr,Jt,Vi,Tt,$i,Ut,Gi,ne,wr,Ce,xn,ve,xr,oe,Me,re,Se,se,J,s,n,c,f,o,A,b,y,u,a,h,i,r,g,_n,v,En,U,_r,G,Er,_,Sr,w,Sn,L,pi,Z,Ks,mt,Tr,$t,qi,Zt,gi,fe,Cr,pe,Mr,ie,Lr,x,Pr,dt,At,bt,zt,Nt,Pt,Kt,Dt,wt,kt,Yt,ce,he,_e,Te,Je,Rr,je,Ir,Ve,kr,ut,Fr,Ft,Tn,Qt,Dr,ye,Cn,He,Or,qe,Nr,_s,Hr,Ei,Ur,Si,zr,os,Rs,Ys,Mn,ks,Wi,Fs,ji,gs,Xs,Js,Ln,Ds,Ki,Ti,Br,Qs,Pn,Ci,Vr,Mi,$r,Zs,Rn,Os,Xi,Es,fi,$e,Ge,fs,hs,ms,Ns,is,Ss,ns,ts,ti,Ts,mi,Cs,bi,Hs,Yi,ei,In,Li,Gr,Pi,qr,si,kn,Us,Ji,Ri,Wr,Ms,zs,rs,Ls,ls,cs,ds,Qe,bs,Bs,Vs,Xe,de,vs,Ii,jr,ni,Fn,ri,Dn,ai,On,$s,Qi;lt.d(_t,{AnnotationEditorLayer:()=>W});var d=lt(292),et=lt(310),I=lt(830),Y=lt(976);const gt=/\r\n?|\n/g,Wt=class Wt extends et.AnnotationEditor{constructor(e){super({...e,name:"freeTextEditor"});l(this,It);l(this,Ot);l(this,Bt);l(this,Jt);l(this,Ut);l(this,ne);l(this,ve);l(this,nt,this.editorDivBlur.bind(this));l(this,vt,this.editorDivFocus.bind(this));l(this,at,this.editorDivInput.bind(this));l(this,z,this.editorDivKeydown.bind(this));l(this,$,this.editorDivPaste.bind(this));l(this,V,void 0);l(this,O,"");l(this,st,`${this.id}-editor`);l(this,ot,void 0);l(this,yt,null);C(this,V,e.color||Wt._defaultColor||et.AnnotationEditor._defaultLineColor),C(this,ot,e.fontSize||Wt._defaultFontSize)}static get _keyboardManager(){const e=Wt.prototype,T=ft=>ft.isEmpty(),tt=I.AnnotationEditorUIManager.TRANSLATE_SMALL,rt=I.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,d.shadow)(this,"_keyboardManager",new I.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-tt,0],checker:T}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-rt,0],checker:T}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[tt,0],checker:T}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[rt,0],checker:T}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-tt],checker:T}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-rt],checker:T}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,tt],checker:T}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,rt],checker:T}]]))}static initialize(e,T){et.AnnotationEditor.initialize(e,T,{strings:["pdfjs-free-text-default-content"]});const tt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(tt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,T){switch(e){case d.AnnotationEditorParamsType.FREETEXT_SIZE:Wt._defaultFontSize=T;break;case d.AnnotationEditorParamsType.FREETEXT_COLOR:Wt._defaultColor=T;break}}updateParams(e,T){switch(e){case d.AnnotationEditorParamsType.FREETEXT_SIZE:S(this,It,vr).call(this,T);break;case d.AnnotationEditorParamsType.FREETEXT_COLOR:S(this,Ot,Ar).call(this,T);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.FREETEXT_SIZE,Wt._defaultFontSize],[d.AnnotationEditorParamsType.FREETEXT_COLOR,Wt._defaultColor||et.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,ot)],[d.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,V)]]}_translateEmpty(e,T){this._uiManager.translateSelectedEditors(e,T,!0)}getInitialTranslation(){const e=this.parentScale;return[-Wt._internalPadding*e,-(Wt._internalPadding+t(this,ot))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(d.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,z)),this.editorDiv.addEventListener("focus",t(this,vt)),this.editorDiv.addEventListener("blur",t(this,nt)),this.editorDiv.addEventListener("input",t(this,at)),this.editorDiv.addEventListener("paste",t(this,$)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,st)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,z)),this.editorDiv.removeEventListener("focus",t(this,vt)),this.editorDiv.removeEventListener("blur",t(this,nt)),this.editorDiv.removeEventListener("input",t(this,at)),this.editorDiv.removeEventListener("paste",t(this,$)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=t(this,O),T=C(this,O,S(this,Bt,yr).call(this).trimEnd());if(e===T)return;const tt=rt=>{if(C(this,O,rt),!rt){this.remove();return}S(this,Ut,Gi).call(this),this._uiManager.rebuild(this),S(this,Jt,Vi).call(this)};this.addCommands({cmd:()=>{tt(T)},undo:()=>{tt(e)},mustExec:!1}),S(this,Jt,Vi).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Wt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,T;this.width&&(e=this.x,T=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,st)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),et.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(rt=>{var ft;return(ft=this.editorDiv)==null?void 0:ft.setAttribute("default-content",rt)}),this.editorDiv.contentEditable=!0;const{style:tt}=this.editorDiv;if(tt.fontSize=`calc(${t(this,ot)}px * var(--scale-factor))`,tt.color=t(this,V),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,I.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[rt,ft]=this.parentDimensions;if(this.annotationElementId){const{position:Ct}=t(this,yt);let[Ht,xt]=this.getInitialTranslation();[Ht,xt]=this.pageTranslationToScreen(Ht,xt);const[qt,Gt]=this.pageDimensions,[we,xe]=this.pageTranslation;let Ee,Le;switch(this.rotation){case 0:Ee=e+(Ct[0]-we)/qt,Le=T+this.height-(Ct[1]-xe)/Gt;break;case 90:Ee=e+(Ct[0]-we)/qt,Le=T-(Ct[1]-xe)/Gt,[Ht,xt]=[xt,-Ht];break;case 180:Ee=e-this.width+(Ct[0]-we)/qt,Le=T-(Ct[1]-xe)/Gt,[Ht,xt]=[-Ht,-xt];break;case 270:Ee=e+(Ct[0]-we-this.height*Gt)/qt,Le=T+(Ct[1]-xe-this.width*qt)/Gt,[Ht,xt]=[-xt,Ht];break}this.setAt(Ee*rt,Le*ft,Ht,xt)}else this.setAt(e*rt,T*ft,this.width*rt,this.height*ft);S(this,Ut,Gi).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var Ee,Le,Be;const T=e.clipboardData||window.clipboardData,{types:tt}=T;if(tt.length===1&&tt[0]==="text/plain")return;e.preventDefault();const rt=S(Ee=Wt,Ce,xn).call(Ee,T.getData("text")||"").replaceAll(gt,`
`);if(!rt)return;const ft=window.getSelection();if(!ft.rangeCount)return;this.editorDiv.normalize(),ft.deleteFromDocument();const Ct=ft.getRangeAt(0);if(!rt.includes(`
`)){Ct.insertNode(document.createTextNode(rt)),this.editorDiv.normalize(),ft.collapseToStart();return}const{startContainer:Ht,startOffset:xt}=Ct,qt=[],Gt=[];if(Ht.nodeType===Node.TEXT_NODE){const De=Ht.parentElement;if(Gt.push(Ht.nodeValue.slice(xt).replaceAll(gt,"")),De!==this.editorDiv){let ze=qt;for(const Ue of this.editorDiv.childNodes){if(Ue===De){ze=Gt;continue}ze.push(S(Le=Wt,Tt,$i).call(Le,Ue))}}qt.push(Ht.nodeValue.slice(0,xt).replaceAll(gt,""))}else if(Ht===this.editorDiv){let De=qt,ze=0;for(const Ue of this.editorDiv.childNodes)ze++===xt&&(De=Gt),De.push(S(Be=Wt,Tt,$i).call(Be,Ue))}C(this,O,`${qt.join(`
`)}${rt}${Gt.join(`
`)}`),S(this,Ut,Gi).call(this);const we=new Range;let xe=qt.reduce((De,ze)=>De+ze.length,0);for(const{firstChild:De}of this.editorDiv.childNodes)if(De.nodeType===Node.TEXT_NODE){const ze=De.nodeValue.length;if(xe<=ze){we.setStart(De,xe),we.setEnd(De,xe);break}xe-=ze}ft.removeAllRanges(),ft.addRange(we)}get contentDiv(){return this.editorDiv}static deserialize(e,T,tt){var Ct;let rt=null;if(e instanceof Y.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Ht,fontColor:xt},rect:qt,rotation:Gt,id:we},textContent:xe,textPosition:Ee,parent:{page:{pageNumber:Le}}}=e;if(!xe||xe.length===0)return null;rt=e={annotationType:d.AnnotationEditorType.FREETEXT,color:Array.from(xt),fontSize:Ht,value:xe.join(`
`),position:Ee,pageIndex:Le-1,rect:qt,rotation:Gt,id:we,deleted:!1}}const ft=super.deserialize(e,T,tt);return C(ft,ot,e.fontSize),C(ft,V,d.Util.makeHexColor(...e.color)),C(ft,O,S(Ct=Wt,Ce,xn).call(Ct,e.value)),ft.annotationElementId=e.id||null,C(ft,yt,rt),ft}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const T=Wt._internalPadding*this.parentScale,tt=this.getRect(T,T),rt=et.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,V)),ft={annotationType:d.AnnotationEditorType.FREETEXT,color:rt,fontSize:t(this,ot),value:S(this,ne,wr).call(this),pageIndex:this.pageIndex,rect:tt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?ft:this.annotationElementId&&!S(this,ve,xr).call(this,ft)?null:(ft.id=this.annotationElementId,ft)}};nt=new WeakMap,vt=new WeakMap,at=new WeakMap,z=new WeakMap,$=new WeakMap,V=new WeakMap,O=new WeakMap,st=new WeakMap,ot=new WeakMap,yt=new WeakMap,It=new WeakSet,vr=function(e){const T=rt=>{this.editorDiv.style.fontSize=`calc(${rt}px * var(--scale-factor))`,this.translate(0,-(rt-t(this,ot))*this.parentScale),C(this,ot,rt),S(this,Jt,Vi).call(this)},tt=t(this,ot);this.addCommands({cmd:T.bind(this,e),undo:T.bind(this,tt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ot=new WeakSet,Ar=function(e){const T=rt=>{C(this,V,this.editorDiv.style.color=rt)},tt=t(this,V);this.addCommands({cmd:T.bind(this,e),undo:T.bind(this,tt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Bt=new WeakSet,yr=function(){var T;const e=[];this.editorDiv.normalize();for(const tt of this.editorDiv.childNodes)e.push(S(T=Wt,Tt,$i).call(T,tt));return e.join(`
`)},Jt=new WeakSet,Vi=function(){const[e,T]=this.parentDimensions;let tt;if(this.isAttachedToDOM)tt=this.div.getBoundingClientRect();else{const{currentLayer:rt,div:ft}=this,Ct=ft.style.display;ft.style.display="hidden",rt.div.append(this.div),tt=ft.getBoundingClientRect(),ft.remove(),ft.style.display=Ct}this.rotation%180===this.parentRotation%180?(this.width=tt.width/e,this.height=tt.height/T):(this.width=tt.height/e,this.height=tt.width/T),this.fixAndSetPosition()},Tt=new WeakSet,$i=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(gt,"")},Ut=new WeakSet,Gi=function(){if(this.editorDiv.replaceChildren(),!!t(this,O))for(const e of t(this,O).split(`
`)){const T=document.createElement("div");T.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(T)}},ne=new WeakSet,wr=function(){return t(this,O).replaceAll("\xA0"," ")},Ce=new WeakSet,xn=function(e){return e.replaceAll(" ","\xA0")},ve=new WeakSet,xr=function(e){const{value:T,fontSize:tt,color:rt,pageIndex:ft}=t(this,yt);return this._hasBeenMoved||e.value!==T||e.fontSize!==tt||e.color.some((Ct,Ht)=>Ct!==rt[Ht])||e.pageIndex!==ft},l(Wt,Tt),l(Wt,Ce),me(Wt,"_freeTextDefaultContent",""),me(Wt,"_internalPadding",0),me(Wt,"_defaultColor",null),me(Wt,"_defaultFontSize",10),me(Wt,"_type","freetext"),me(Wt,"_editorType",d.AnnotationEditorType.FREETEXT);let X=Wt;var B=lt(61),D=lt(259),Q=lt(419);const it=class it extends et.AnnotationEditor{constructor(e){super({...e,name:"highlightEditor"});l(this,g);l(this,v);l(this,U);l(this,G);l(this,_);l(this,w);l(this,L);l(this,mt);l(this,$t);l(this,Zt);l(this,fe);l(this,pe);l(this,oe,null);l(this,Me,0);l(this,re,void 0);l(this,Se,null);l(this,se,null);l(this,J,null);l(this,s,null);l(this,n,0);l(this,c,null);l(this,f,null);l(this,o,null);l(this,A,!1);l(this,b,S(this,mt,Tr).bind(this));l(this,y,null);l(this,u,void 0);l(this,a,null);l(this,h,"");l(this,i,void 0);l(this,r,"");this.color=e.color||it._defaultColor,C(this,i,e.thickness||it._defaultThickness),C(this,u,e.opacity||it._defaultOpacity),C(this,re,e.boxes||null),C(this,r,e.methodOfCreation||""),C(this,h,e.text||""),this._isDraggable=!1,e.highlightId>-1?(C(this,A,!0),S(this,v,En).call(this,e),S(this,L,pi).call(this)):(C(this,oe,e.anchorNode),C(this,Me,e.anchorOffset),C(this,s,e.focusNode),C(this,n,e.focusOffset),S(this,g,_n).call(this),S(this,L,pi).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=it.prototype;return(0,d.shadow)(this,"_keyboardManager",new I.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,A)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,i),methodOfCreation:t(this,r)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,T){var tt;et.AnnotationEditor.initialize(e,T),it._defaultColor||(it._defaultColor=((tt=T.highlightColors)==null?void 0:tt.values().next().value)||"#fff066")}static updateDefaultParams(e,T){switch(e){case d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:it._defaultColor=T;break;case d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:it._defaultThickness=T;break}}translateInPage(e,T){}get toolbarPosition(){return t(this,y)}updateParams(e,T){switch(e){case d.AnnotationEditorParamsType.HIGHLIGHT_COLOR:S(this,U,_r).call(this,T);break;case d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:S(this,G,Er).call(this,T);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,it._defaultColor],[d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,it._defaultThickness]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||it._defaultColor],[d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,i)||it._defaultThickness],[d.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,A)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(C(this,se,new D.ColorPicker({editor:this})),e.addColorPicker(t(this,se))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(S(this,Zt,gi).call(this))}getBaseTranslation(){return[0,0]}getRect(e,T){return super.getRect(e,T,S(this,Zt,gi).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){S(this,w,Sn).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,L,pi).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var tt;let T=!1;this.parent&&!e?S(this,w,Sn).call(this):e&&(S(this,L,pi).call(this,e),T=!this.parent&&((tt=this.div)==null?void 0:tt.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),T&&this.select()}rotate(e){var rt,ft,Ct;const{drawLayer:T}=this.parent;let tt;t(this,A)?(e=(e-this.rotation+360)%360,tt=S(rt=it,Z,Ks).call(rt,t(this,f).box,e)):tt=S(ft=it,Z,Ks).call(ft,this,e),T.rotate(t(this,o),e),T.rotate(t(this,a),e),T.updateBox(t(this,o),tt),T.updateBox(t(this,a),S(Ct=it,Z,Ks).call(Ct,t(this,J).box,e))}render(){if(this.div)return this.div;const e=super.render();t(this,h)&&(e.setAttribute("aria-label",t(this,h)),e.setAttribute("role","mark")),t(this,A)?e.classList.add("free"):this.div.addEventListener("keydown",t(this,b));const T=C(this,c,document.createElement("div"));e.append(T),T.setAttribute("aria-hidden","true"),T.className="internal",T.style.clipPath=t(this,Se);const[tt,rt]=this.parentDimensions;return this.setDims(this.width*tt,this.height*rt),(0,I.bindEvents)(this,t(this,c),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(t(this,a),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,a),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:S(this,$t,qi).call(this,!0);break;case 1:case 3:S(this,$t,qi).call(this,!1);break}}select(){var e,T;super.select(),t(this,a)&&((e=this.parent)==null||e.drawLayer.removeClass(t(this,a),"hovered"),(T=this.parent)==null||T.drawLayer.addClass(t(this,a),"selected"))}unselect(){var e;super.unselect(),t(this,a)&&((e=this.parent)==null||e.drawLayer.removeClass(t(this,a),"selected"),t(this,A)||S(this,$t,qi).call(this,!1))}get _mustFixPosition(){return!t(this,A)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(t(this,o),e),this.parent.drawLayer.show(t(this,a),e))}static startHighlighting(e,T,{target:tt,x:rt,y:ft}){const{x:Ct,y:Ht,width:xt,height:qt}=tt.getBoundingClientRect(),Gt=Le=>{S(this,ie,Lr).call(this,e,Le)},we={capture:!0,passive:!1},xe=Le=>{Le.preventDefault(),Le.stopPropagation()},Ee=Le=>{tt.removeEventListener("pointermove",Gt),window.removeEventListener("blur",Ee),window.removeEventListener("pointerup",Ee),window.removeEventListener("pointerdown",xe,we),window.removeEventListener("contextmenu",Q.noContextMenu),S(this,x,Pr).call(this,e,Le)};window.addEventListener("blur",Ee),window.addEventListener("pointerup",Ee),window.addEventListener("pointerdown",xe,we),window.addEventListener("contextmenu",Q.noContextMenu),tt.addEventListener("pointermove",Gt),this._freeHighlight=new B.FreeOutliner({x:rt,y:ft},[Ct,Ht,xt,qt],e.scale,this._defaultThickness/2,T,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(e,T,tt){var Le;const rt=super.deserialize(e,T,tt),{rect:[ft,Ct,Ht,xt],color:qt,quadPoints:Gt}=e;rt.color=d.Util.makeHexColor(...qt),C(rt,u,e.opacity);const[we,xe]=rt.pageDimensions;rt.width=(Ht-ft)/we,rt.height=(xt-Ct)/xe;const Ee=C(rt,re,[]);for(let Be=0;Be<Gt.length;Be+=8)Ee.push({x:(Gt[4]-Ht)/we,y:(xt-(1-Gt[Be+5]))/xe,width:(Gt[Be+2]-Gt[Be])/we,height:(Gt[Be+5]-Gt[Be+1])/xe});return S(Le=rt,g,_n).call(Le),rt}serialize(e=!1){if(this.isEmpty()||e)return null;const T=this.getRect(0,0),tt=et.AnnotationEditor._colorManager.convert(this.color);return{annotationType:d.AnnotationEditorType.HIGHLIGHT,color:tt,opacity:t(this,u),thickness:t(this,i),quadPoints:S(this,fe,Cr).call(this),outlines:S(this,pe,Mr).call(this,T),pageIndex:this.pageIndex,rect:T,rotation:S(this,Zt,gi).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};oe=new WeakMap,Me=new WeakMap,re=new WeakMap,Se=new WeakMap,se=new WeakMap,J=new WeakMap,s=new WeakMap,n=new WeakMap,c=new WeakMap,f=new WeakMap,o=new WeakMap,A=new WeakMap,b=new WeakMap,y=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,i=new WeakMap,r=new WeakMap,g=new WeakSet,_n=function(){const e=new B.Outliner(t(this,re),.001);C(this,f,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,f).box;const T=new B.Outliner(t(this,re),.0025,.001,this._uiManager.direction==="ltr");C(this,J,T.getOutlines());const{lastPoint:tt}=t(this,J).box;C(this,y,[(tt[0]-this.x)/this.width,(tt[1]-this.y)/this.height])},v=new WeakSet,En=function({highlightOutlines:e,highlightId:T,clipPathId:tt}){var Gt,we;if(C(this,f,e),C(this,J,e.getNewOutline(t(this,i)/2+1.5,.0025)),T>=0)C(this,o,T),C(this,Se,tt),this.parent.drawLayer.finalizeLine(T,e),C(this,a,this.parent.drawLayer.highlightOutline(t(this,J)));else if(this.parent){const xe=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,o),e),this.parent.drawLayer.updateBox(t(this,o),S(Gt=it,Z,Ks).call(Gt,t(this,f).box,(xe-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,a),t(this,J)),this.parent.drawLayer.updateBox(t(this,a),S(we=it,Z,Ks).call(we,t(this,J).box,xe))}const{x:ft,y:Ct,width:Ht,height:xt}=e.box;switch(this.rotation){case 0:this.x=ft,this.y=Ct,this.width=Ht,this.height=xt;break;case 90:{const[xe,Ee]=this.parentDimensions;this.x=Ct,this.y=1-ft,this.width=Ht*Ee/xe,this.height=xt*xe/Ee;break}case 180:this.x=1-ft,this.y=1-Ct,this.width=Ht,this.height=xt;break;case 270:{const[xe,Ee]=this.parentDimensions;this.x=1-Ct,this.y=ft,this.width=Ht*Ee/xe,this.height=xt*xe/Ee;break}}const{lastPoint:qt}=t(this,J).box;C(this,y,[(qt[0]-ft)/Ht,(qt[1]-Ct)/xt])},U=new WeakSet,_r=function(e){const T=rt=>{var ft,Ct;this.color=rt,(ft=this.parent)==null||ft.drawLayer.changeColor(t(this,o),rt),(Ct=t(this,se))==null||Ct.updateColor(rt)},tt=this.color;this.addCommands({cmd:T.bind(this,e),undo:T.bind(this,tt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},G=new WeakSet,Er=function(e){const T=t(this,i),tt=rt=>{C(this,i,rt),S(this,_,Sr).call(this,rt)};this.addCommands({cmd:tt.bind(this,e),undo:tt.bind(this,T),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},_=new WeakSet,Sr=function(e){if(!t(this,A))return;S(this,v,En).call(this,{highlightOutlines:t(this,f).getNewOutline(e/2)}),this.fixAndSetPosition();const[T,tt]=this.parentDimensions;this.setDims(this.width*T,this.height*tt)},w=new WeakSet,Sn=function(){t(this,o)===null||!this.parent||(this.parent.drawLayer.remove(t(this,o)),C(this,o,null),this.parent.drawLayer.remove(t(this,a)),C(this,a,null))},L=new WeakSet,pi=function(e=this.parent){t(this,o)===null&&({id:us(this,o)._,clipPathId:us(this,Se)._}=e.drawLayer.highlight(t(this,f),this.color,t(this,u)),C(this,a,e.drawLayer.highlightOutline(t(this,J))),t(this,c)&&(t(this,c).style.clipPath=t(this,Se)))},Z=new WeakSet,Ks=function({x:e,y:T,width:tt,height:rt},ft){switch(ft){case 90:return{x:1-T-rt,y:e,width:rt,height:tt};case 180:return{x:1-e-tt,y:1-T-rt,width:tt,height:rt};case 270:return{x:T,y:1-e-tt,width:rt,height:tt}}return{x:e,y:T,width:tt,height:rt}},mt=new WeakSet,Tr=function(e){it._keyboardManager.exec(this,e)},$t=new WeakSet,qi=function(e){if(!t(this,oe))return;const T=window.getSelection();e?T.setPosition(t(this,oe),t(this,Me)):T.setPosition(t(this,s),t(this,n))},Zt=new WeakSet,gi=function(){return t(this,A)?this.rotation:0},fe=new WeakSet,Cr=function(){if(t(this,A))return null;const[e,T]=this.pageDimensions,tt=t(this,re),rt=new Array(tt.length*8);let ft=0;for(const{x:Ct,y:Ht,width:xt,height:qt}of tt){const Gt=Ct*e,we=(1-Ht-qt)*T;rt[ft]=rt[ft+4]=Gt,rt[ft+1]=rt[ft+3]=we,rt[ft+2]=rt[ft+6]=Gt+xt*e,rt[ft+5]=rt[ft+7]=we+qt*T,ft+=8}return rt},pe=new WeakSet,Mr=function(e){return t(this,f).serialize(e,S(this,Zt,gi).call(this))},ie=new WeakSet,Lr=function(e,T){this._freeHighlight.add(T)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},x=new WeakSet,Pr=function(e,T){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(T,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},l(it,Z),l(it,ie),l(it,x),me(it,"_defaultColor",null),me(it,"_defaultOpacity",1),me(it,"_defaultThickness",12),me(it,"_l10nPromise"),me(it,"_type","highlight"),me(it,"_editorType",d.AnnotationEditorType.HIGHLIGHT),me(it,"_freeHighlightId",-1),me(it,"_freeHighlight",null),me(it,"_freeHighlightClipId","");let q=it;const Oe=class Oe extends et.AnnotationEditor{constructor(e){super({...e,name:"inkEditor"});l(this,Je);l(this,je);l(this,Ve);l(this,ut);l(this,Ft);l(this,Qt);l(this,ye);l(this,He);l(this,qe);l(this,_s);l(this,Ei);l(this,Si);l(this,os);l(this,Ys);l(this,ks);l(this,Fs);l(this,gs);l(this,Js);l(this,Ds);l(this,Mi);l(this,Zs);l(this,Os);l(this,Es);l(this,dt,0);l(this,At,0);l(this,bt,this.canvasPointermove.bind(this));l(this,zt,this.canvasPointerleave.bind(this));l(this,Nt,this.canvasPointerup.bind(this));l(this,Pt,this.canvasPointerdown.bind(this));l(this,Kt,null);l(this,Dt,new Path2D);l(this,wt,!1);l(this,kt,!1);l(this,Yt,!1);l(this,ce,null);l(this,he,0);l(this,_e,0);l(this,Te,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,T){et.AnnotationEditor.initialize(e,T)}static updateDefaultParams(e,T){switch(e){case d.AnnotationEditorParamsType.INK_THICKNESS:Oe._defaultThickness=T;break;case d.AnnotationEditorParamsType.INK_COLOR:Oe._defaultColor=T;break;case d.AnnotationEditorParamsType.INK_OPACITY:Oe._defaultOpacity=T/100;break}}updateParams(e,T){switch(e){case d.AnnotationEditorParamsType.INK_THICKNESS:S(this,Je,Rr).call(this,T);break;case d.AnnotationEditorParamsType.INK_COLOR:S(this,je,Ir).call(this,T);break;case d.AnnotationEditorParamsType.INK_OPACITY:S(this,Ve,kr).call(this,T);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.INK_THICKNESS,Oe._defaultThickness],[d.AnnotationEditorParamsType.INK_COLOR,Oe._defaultColor||et.AnnotationEditor._defaultLineColor],[d.AnnotationEditorParamsType.INK_OPACITY,Math.round(Oe._defaultOpacity*100)]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Oe._defaultThickness],[d.AnnotationEditorParamsType.INK_COLOR,this.color||Oe._defaultColor||et.AnnotationEditor._defaultLineColor],[d.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Oe._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(S(this,ks,Wi).call(this),S(this,Fs,ji).call(this)),this.isAttachedToDOM||(this.parent.add(this),S(this,gs,Xs).call(this)),S(this,Es,fi).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,Kt)&&(clearTimeout(t(this,Kt)),C(this,Kt,null)),t(this,ce).disconnect(),C(this,ce,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,T]=this.parentDimensions,tt=this.width*e,rt=this.height*T;this.setDimensions(tt,rt)}enableEditMode(){t(this,wt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,Pt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,Pt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,wt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),C(this,wt,!0),this.div.classList.add("disabled"),S(this,Es,fi).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||t(this,wt)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),S(this,Qt,Dr).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),S(this,ye,Cn).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),S(this,Ys,Mn).call(this,e)}canvasPointerleave(e){S(this,Ys,Mn).call(this,e)}get isResizable(){return!this.isEmpty()&&t(this,wt)}render(){if(this.div)return this.div;let e,T;this.width&&(e=this.x,T=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[tt,rt,ft,Ct]=S(this,ut,Fr).call(this);if(this.setAt(tt,rt,0,0),this.setDims(ft,Ct),S(this,ks,Wi).call(this),this.width){const[Ht,xt]=this.parentDimensions;this.setAspectRatio(this.width*Ht,this.height*xt),this.setAt(e*Ht,T*xt,this.width*Ht,this.height*xt),C(this,Yt,!0),S(this,gs,Xs).call(this),this.setDims(this.width*Ht,this.height*xt),S(this,os,Rs).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return S(this,Fs,ji).call(this),this.div}setDimensions(e,T){const tt=Math.round(e),rt=Math.round(T);if(t(this,he)===tt&&t(this,_e)===rt)return;C(this,he,tt),C(this,_e,rt),this.canvas.style.visibility="hidden";const[ft,Ct]=this.parentDimensions;this.width=e/ft,this.height=T/Ct,this.fixAndSetPosition(),t(this,wt)&&S(this,Js,Ln).call(this,e,T),S(this,gs,Xs).call(this),S(this,os,Rs).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,T,tt){var Be,De,ze;if(e instanceof Y.InkAnnotationElement)return null;const rt=super.deserialize(e,T,tt);rt.thickness=e.thickness,rt.color=d.Util.makeHexColor(...e.color),rt.opacity=e.opacity;const[ft,Ct]=rt.pageDimensions,Ht=rt.width*ft,xt=rt.height*Ct,qt=rt.parentScale,Gt=e.thickness/2;C(rt,wt,!0),C(rt,he,Math.round(Ht)),C(rt,_e,Math.round(xt));const{paths:we,rect:xe,rotation:Ee}=e;for(let{bezier:Ue}of we){Ue=S(Be=Oe,Ci,Vr).call(Be,Ue,xe,Ee);const as=[];rt.paths.push(as);let oi=qt*(Ue[0]-Gt),hi=qt*(Ue[1]-Gt);for(let ss=2,ln=Ue.length;ss<ln;ss+=6){const cn=qt*(Ue[ss]-Gt),Fi=qt*(Ue[ss+1]-Gt),Di=qt*(Ue[ss+2]-Gt),Oi=qt*(Ue[ss+3]-Gt),li=qt*(Ue[ss+4]-Gt),dr=qt*(Ue[ss+5]-Gt);as.push([[oi,hi],[cn,Fi],[Di,Oi],[li,dr]]),oi=li,hi=dr}const ki=S(this,Ti,Br).call(this,as);rt.bezierPath2D.push(ki)}const Le=S(De=rt,Zs,Rn).call(De);return C(rt,At,Math.max(et.AnnotationEditor.MIN_SIZE,Le[2]-Le[0])),C(rt,dt,Math.max(et.AnnotationEditor.MIN_SIZE,Le[3]-Le[1])),S(ze=rt,Js,Ln).call(ze,Ht,xt),rt}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),T=et.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:d.AnnotationEditorType.INK,color:T,thickness:this.thickness,opacity:this.opacity,paths:S(this,Mi,$r).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};dt=new WeakMap,At=new WeakMap,bt=new WeakMap,zt=new WeakMap,Nt=new WeakMap,Pt=new WeakMap,Kt=new WeakMap,Dt=new WeakMap,wt=new WeakMap,kt=new WeakMap,Yt=new WeakMap,ce=new WeakMap,he=new WeakMap,_e=new WeakMap,Te=new WeakMap,Je=new WeakSet,Rr=function(e){const T=rt=>{this.thickness=rt,S(this,Es,fi).call(this)},tt=this.thickness;this.addCommands({cmd:T.bind(this,e),undo:T.bind(this,tt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},je=new WeakSet,Ir=function(e){const T=rt=>{this.color=rt,S(this,os,Rs).call(this)},tt=this.color;this.addCommands({cmd:T.bind(this,e),undo:T.bind(this,tt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ve=new WeakSet,kr=function(e){const T=rt=>{this.opacity=rt,S(this,os,Rs).call(this)};e/=100;const tt=this.opacity;this.addCommands({cmd:T.bind(this,e),undo:T.bind(this,tt),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ut=new WeakSet,Fr=function(){const{parentRotation:e,parentDimensions:[T,tt]}=this;switch(e){case 90:return[0,tt,tt,T];case 180:return[T,tt,T,tt];case 270:return[T,0,tt,T];default:return[0,0,T,tt]}},Ft=new WeakSet,Tn=function(){const{ctx:e,color:T,opacity:tt,thickness:rt,parentScale:ft,scaleFactor:Ct}=this;e.lineWidth=rt*ft/Ct,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${T}${(0,I.opacityToHex)(tt)}`},Qt=new WeakSet,Dr=function(e,T){this.canvas.addEventListener("contextmenu",Q.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,zt)),this.canvas.addEventListener("pointermove",t(this,bt)),this.canvas.addEventListener("pointerup",t(this,Nt)),this.canvas.removeEventListener("pointerdown",t(this,Pt)),this.isEditing=!0,t(this,Yt)||(C(this,Yt,!0),S(this,gs,Xs).call(this),this.thickness||(this.thickness=Oe._defaultThickness),this.color||(this.color=Oe._defaultColor||et.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Oe._defaultOpacity)),this.currentPath.push([e,T]),C(this,kt,!1),S(this,Ft,Tn).call(this),C(this,Te,()=>{S(this,_s,Hr).call(this),t(this,Te)&&window.requestAnimationFrame(t(this,Te))}),window.requestAnimationFrame(t(this,Te))},ye=new WeakSet,Cn=function(e,T){const[tt,rt]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===tt&&T===rt)return;const ft=this.currentPath;let Ct=t(this,Dt);if(ft.push([e,T]),C(this,kt,!0),ft.length<=2){Ct.moveTo(...ft[0]),Ct.lineTo(e,T);return}ft.length===3&&(C(this,Dt,Ct=new Path2D),Ct.moveTo(...ft[0])),S(this,Ei,Ur).call(this,Ct,...ft.at(-3),...ft.at(-2),e,T)},He=new WeakSet,Or=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);t(this,Dt).lineTo(...e)},qe=new WeakSet,Nr=function(e,T){C(this,Te,null),e=Math.min(Math.max(e,0),this.canvas.width),T=Math.min(Math.max(T,0),this.canvas.height),S(this,ye,Cn).call(this,e,T),S(this,He,Or).call(this);let tt;if(this.currentPath.length!==1)tt=S(this,Si,zr).call(this);else{const xt=[e,T];tt=[[xt,xt.slice(),xt.slice(),xt]]}const rt=t(this,Dt),ft=this.currentPath;this.currentPath=[],C(this,Dt,new Path2D);const Ct=()=>{this.allRawPaths.push(ft),this.paths.push(tt),this.bezierPath2D.push(rt),this._uiManager.rebuild(this)},Ht=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(S(this,ks,Wi).call(this),S(this,Fs,ji).call(this)),S(this,Es,fi).call(this))};this.addCommands({cmd:Ct,undo:Ht,mustExec:!0})},_s=new WeakSet,Hr=function(){if(!t(this,kt))return;C(this,kt,!1);const e=Math.ceil(this.thickness*this.parentScale),T=this.currentPath.slice(-3),tt=T.map(Ct=>Ct[0]),rt=T.map(Ct=>Ct[1]);Math.min(...tt)-e,Math.max(...tt)+e,Math.min(...rt)-e,Math.max(...rt)+e;const{ctx:ft}=this;ft.save(),ft.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ct of this.bezierPath2D)ft.stroke(Ct);ft.stroke(t(this,Dt)),ft.restore()},Ei=new WeakSet,Ur=function(e,T,tt,rt,ft,Ct,Ht){const xt=(T+rt)/2,qt=(tt+ft)/2,Gt=(rt+Ct)/2,we=(ft+Ht)/2;e.bezierCurveTo(xt+2*(rt-xt)/3,qt+2*(ft-qt)/3,Gt+2*(rt-Gt)/3,we+2*(ft-we)/3,Gt,we)},Si=new WeakSet,zr=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const T=[];let tt,[rt,ft]=e[0];for(tt=1;tt<e.length-2;tt++){const[xe,Ee]=e[tt],[Le,Be]=e[tt+1],De=(xe+Le)/2,ze=(Ee+Be)/2,Ue=[rt+2*(xe-rt)/3,ft+2*(Ee-ft)/3],as=[De+2*(xe-De)/3,ze+2*(Ee-ze)/3];T.push([[rt,ft],Ue,as,[De,ze]]),[rt,ft]=[De,ze]}const[Ct,Ht]=e[tt],[xt,qt]=e[tt+1],Gt=[rt+2*(Ct-rt)/3,ft+2*(Ht-ft)/3],we=[xt+2*(Ct-xt)/3,qt+2*(Ht-qt)/3];return T.push([[rt,ft],Gt,we,[xt,qt]]),T},os=new WeakSet,Rs=function(){if(this.isEmpty()){S(this,Ds,Ki).call(this);return}S(this,Ft,Tn).call(this);const{canvas:e,ctx:T}=this;T.setTransform(1,0,0,1,0,0),T.clearRect(0,0,e.width,e.height),S(this,Ds,Ki).call(this);for(const tt of this.bezierPath2D)T.stroke(tt)},Ys=new WeakSet,Mn=function(e){this.canvas.removeEventListener("pointerleave",t(this,zt)),this.canvas.removeEventListener("pointermove",t(this,bt)),this.canvas.removeEventListener("pointerup",t(this,Nt)),this.canvas.addEventListener("pointerdown",t(this,Pt)),t(this,Kt)&&clearTimeout(t(this,Kt)),C(this,Kt,setTimeout(()=>{C(this,Kt,null),this.canvas.removeEventListener("contextmenu",Q.noContextMenu)},10)),S(this,qe,Nr).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ks=new WeakSet,Wi=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Fs=new WeakSet,ji=function(){C(this,ce,new ResizeObserver(e=>{const T=e[0].contentRect;T.width&&T.height&&this.setDimensions(T.width,T.height)})),t(this,ce).observe(this.div)},gs=new WeakSet,Xs=function(){if(!t(this,Yt))return;const[e,T]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*T),S(this,Ds,Ki).call(this)},Js=new WeakSet,Ln=function(e,T){const tt=S(this,Os,Xi).call(this),rt=(e-tt)/t(this,At),ft=(T-tt)/t(this,dt);this.scaleFactor=Math.min(rt,ft)},Ds=new WeakSet,Ki=function(){const e=S(this,Os,Xi).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},Ti=new WeakSet,Br=function(e){const T=new Path2D;for(let tt=0,rt=e.length;tt<rt;tt++){const[ft,Ct,Ht,xt]=e[tt];tt===0&&T.moveTo(...ft),T.bezierCurveTo(Ct[0],Ct[1],Ht[0],Ht[1],xt[0],xt[1])}return T},Qs=new WeakSet,Pn=function(e,T,tt){const[rt,ft,Ct,Ht]=T;switch(tt){case 0:for(let xt=0,qt=e.length;xt<qt;xt+=2)e[xt]+=rt,e[xt+1]=Ht-e[xt+1];break;case 90:for(let xt=0,qt=e.length;xt<qt;xt+=2){const Gt=e[xt];e[xt]=e[xt+1]+rt,e[xt+1]=Gt+ft}break;case 180:for(let xt=0,qt=e.length;xt<qt;xt+=2)e[xt]=Ct-e[xt],e[xt+1]+=ft;break;case 270:for(let xt=0,qt=e.length;xt<qt;xt+=2){const Gt=e[xt];e[xt]=Ct-e[xt+1],e[xt+1]=Ht-Gt}break;default:throw new Error("Invalid rotation")}return e},Ci=new WeakSet,Vr=function(e,T,tt){const[rt,ft,Ct,Ht]=T;switch(tt){case 0:for(let xt=0,qt=e.length;xt<qt;xt+=2)e[xt]-=rt,e[xt+1]=Ht-e[xt+1];break;case 90:for(let xt=0,qt=e.length;xt<qt;xt+=2){const Gt=e[xt];e[xt]=e[xt+1]-ft,e[xt+1]=Gt-rt}break;case 180:for(let xt=0,qt=e.length;xt<qt;xt+=2)e[xt]=Ct-e[xt],e[xt+1]-=ft;break;case 270:for(let xt=0,qt=e.length;xt<qt;xt+=2){const Gt=e[xt];e[xt]=Ht-e[xt+1],e[xt+1]=Ct-Gt}break;default:throw new Error("Invalid rotation")}return e},Mi=new WeakSet,$r=function(e,T,tt,rt){var qt,Gt;const ft=[],Ct=this.thickness/2,Ht=e*T+Ct,xt=e*tt+Ct;for(const we of this.paths){const xe=[],Ee=[];for(let Le=0,Be=we.length;Le<Be;Le++){const[De,ze,Ue,as]=we[Le];if(De[0]===as[0]&&De[1]===as[1]&&Be===1){const Oi=e*De[0]+Ht,li=e*De[1]+xt;xe.push(Oi,li),Ee.push(Oi,li);break}const oi=e*De[0]+Ht,hi=e*De[1]+xt,ki=e*ze[0]+Ht,ss=e*ze[1]+xt,ln=e*Ue[0]+Ht,cn=e*Ue[1]+xt,Fi=e*as[0]+Ht,Di=e*as[1]+xt;Le===0&&(xe.push(oi,hi),Ee.push(oi,hi)),xe.push(ki,ss,ln,cn,Fi,Di),Ee.push(ki,ss),Le===Be-1&&Ee.push(Fi,Di)}ft.push({bezier:S(qt=Oe,Qs,Pn).call(qt,xe,rt,this.rotation),points:S(Gt=Oe,Qs,Pn).call(Gt,Ee,rt,this.rotation)})}return ft},Zs=new WeakSet,Rn=function(){let e=1/0,T=-1/0,tt=1/0,rt=-1/0;for(const ft of this.paths)for(const[Ct,Ht,xt,qt]of ft){const Gt=d.Util.bezierBoundingBox(...Ct,...Ht,...xt,...qt);e=Math.min(e,Gt[0]),tt=Math.min(tt,Gt[1]),T=Math.max(T,Gt[2]),rt=Math.max(rt,Gt[3])}return[e,tt,T,rt]},Os=new WeakSet,Xi=function(){return t(this,wt)?Math.ceil(this.thickness*this.parentScale):0},Es=new WeakSet,fi=function(e=!1){if(this.isEmpty())return;if(!t(this,wt)){S(this,os,Rs).call(this);return}const T=S(this,Zs,Rn).call(this),tt=S(this,Os,Xi).call(this);C(this,At,Math.max(et.AnnotationEditor.MIN_SIZE,T[2]-T[0])),C(this,dt,Math.max(et.AnnotationEditor.MIN_SIZE,T[3]-T[1]));const rt=Math.ceil(tt+t(this,At)*this.scaleFactor),ft=Math.ceil(tt+t(this,dt)*this.scaleFactor),[Ct,Ht]=this.parentDimensions;this.width=rt/Ct,this.height=ft/Ht,this.setAspectRatio(rt,ft);const xt=this.translationX,qt=this.translationY;this.translationX=-T[0],this.translationY=-T[1],S(this,gs,Xs).call(this),S(this,os,Rs).call(this),C(this,he,rt),C(this,_e,ft),this.setDims(rt,ft);const Gt=e?tt/this.scaleFactor/2:0;this.translate(xt-this.translationX-Gt,qt-this.translationY-Gt)},l(Oe,Ti),l(Oe,Qs),l(Oe,Ci),me(Oe,"_defaultColor",null),me(Oe,"_defaultOpacity",1),me(Oe,"_defaultThickness",1),me(Oe,"_type","ink"),me(Oe,"_editorType",d.AnnotationEditorType.INK);let R=Oe;const ii=class ii extends et.AnnotationEditor{constructor(e){super({...e,name:"stampEditor"});l(this,Ts);l(this,Cs);l(this,Hs);l(this,ei);l(this,Li);l(this,Pi);l(this,si);l(this,Us);l(this,Ri);l(this,$e,null);l(this,Ge,null);l(this,fs,null);l(this,hs,null);l(this,ms,null);l(this,Ns,"");l(this,is,null);l(this,Ss,null);l(this,ns,null);l(this,ts,!1);l(this,ti,!1);C(this,hs,e.bitmapUrl),C(this,ms,e.bitmapFile)}static initialize(e,T){et.AnnotationEditor.initialize(e,T)}static get supportedTypes(){const e=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,d.shadow)(this,"supportedTypes",e.map(T=>`image/${T}`))}static get supportedTypesStr(){return(0,d.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,T){T.pasteEditor(d.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}remove(){var e,T;t(this,Ge)&&(C(this,$e,null),this._uiManager.imageManager.deleteId(t(this,Ge)),(e=t(this,is))==null||e.remove(),C(this,is,null),(T=t(this,Ss))==null||T.disconnect(),C(this,Ss,null),t(this,ns)&&(clearTimeout(t(this,ns)),C(this,ns,null))),super.remove()}rebuild(){if(!this.parent){t(this,Ge)&&S(this,Hs,Yi).call(this);return}super.rebuild(),this.div!==null&&(t(this,Ge)&&t(this,is)===null&&S(this,Hs,Yi).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,fs)||t(this,$e)||t(this,hs)||t(this,ms)||t(this,Ge))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,T;if(this.width&&(e=this.x,T=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,$e)?S(this,ei,In).call(this):S(this,Hs,Yi).call(this),this.width){const[tt,rt]=this.parentDimensions;this.setAt(e*tt,T*rt,this.width*tt,this.height*rt)}return this.div}getImageForAltText(){return t(this,is)}static deserialize(e,T,tt){if(e instanceof Y.StampAnnotationElement)return null;const rt=super.deserialize(e,T,tt),{rect:ft,bitmapUrl:Ct,bitmapId:Ht,isSvg:xt,accessibilityData:qt}=e;Ht&&tt.imageManager.isValidId(Ht)?C(rt,Ge,Ht):C(rt,hs,Ct),C(rt,ts,xt);const[Gt,we]=rt.pageDimensions;return rt.width=(ft[2]-ft[0])/Gt,rt.height=(ft[3]-ft[1])/we,qt&&(rt.altTextData=qt),rt}serialize(e=!1,T=null){if(this.isEmpty())return null;const tt={annotationType:d.AnnotationEditorType.STAMP,bitmapId:t(this,Ge),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,ts),structTreeParentId:this._structTreeParentId};if(e)return tt.bitmapUrl=S(this,Us,Ji).call(this,!0),tt.accessibilityData=this.altTextData,tt;const{decorative:rt,altText:ft}=this.altTextData;if(!rt&&ft&&(tt.accessibilityData={type:"Figure",alt:ft}),T===null)return tt;T.stamps||(T.stamps=new Map);const Ct=t(this,ts)?(tt.rect[2]-tt.rect[0])*(tt.rect[3]-tt.rect[1]):null;if(!T.stamps.has(t(this,Ge)))T.stamps.set(t(this,Ge),{area:Ct,serialized:tt}),tt.bitmap=S(this,Us,Ji).call(this,!1);else if(t(this,ts)){const Ht=T.stamps.get(t(this,Ge));Ct>Ht.area&&(Ht.area=Ct,Ht.serialized.bitmap.close(),Ht.serialized.bitmap=S(this,Us,Ji).call(this,!1))}return tt}};$e=new WeakMap,Ge=new WeakMap,fs=new WeakMap,hs=new WeakMap,ms=new WeakMap,Ns=new WeakMap,is=new WeakMap,Ss=new WeakMap,ns=new WeakMap,ts=new WeakMap,ti=new WeakMap,Ts=new WeakSet,mi=function(e,T=!1){if(!e){this.remove();return}C(this,$e,e.bitmap),T||(C(this,Ge,e.id),C(this,ts,e.isSvg)),e.file&&C(this,Ns,e.file.name),S(this,ei,In).call(this)},Cs=new WeakSet,bi=function(){C(this,fs,null),this._uiManager.enableWaiting(!1),t(this,is)&&this.div.focus()},Hs=new WeakSet,Yi=function(){if(t(this,Ge)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Ge)).then(T=>S(this,Ts,mi).call(this,T,!0)).finally(()=>S(this,Cs,bi).call(this));return}if(t(this,hs)){const T=t(this,hs);C(this,hs,null),this._uiManager.enableWaiting(!0),C(this,fs,this._uiManager.imageManager.getFromUrl(T).then(tt=>S(this,Ts,mi).call(this,tt)).finally(()=>S(this,Cs,bi).call(this)));return}if(t(this,ms)){const T=t(this,ms);C(this,ms,null),this._uiManager.enableWaiting(!0),C(this,fs,this._uiManager.imageManager.getFromFile(T).then(tt=>S(this,Ts,mi).call(this,tt)).finally(()=>S(this,Cs,bi).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=ii.supportedTypesStr,C(this,fs,new Promise(T=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const tt=await this._uiManager.imageManager.getFromFile(e.files[0]);S(this,Ts,mi).call(this,tt)}T()}),e.addEventListener("cancel",()=>{this.remove(),T()})}).finally(()=>S(this,Cs,bi).call(this))),e.click()},ei=new WeakSet,In=function(){const{div:e}=this;let{width:T,height:tt}=t(this,$e);const[rt,ft]=this.pageDimensions,Ct=.75;if(this.width)T=this.width*rt,tt=this.height*ft;else if(T>Ct*rt||tt>Ct*ft){const Gt=Math.min(Ct*rt/T,Ct*ft/tt);T*=Gt,tt*=Gt}const[Ht,xt]=this.parentDimensions;this.setDims(T*Ht/rt,tt*xt/ft),this._uiManager.enableWaiting(!1);const qt=C(this,is,document.createElement("canvas"));e.append(qt),e.hidden=!1,S(this,si,kn).call(this,T,tt),S(this,Ri,Wr).call(this),t(this,ti)||(this.parent.addUndoableEditor(this),C(this,ti,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,Ns)&&qt.setAttribute("aria-label",t(this,Ns))},Li=new WeakSet,Gr=function(e,T){var Ct;const[tt,rt]=this.parentDimensions;this.width=e/tt,this.height=T/rt,this.setDims(e,T),(Ct=this._initialOptions)!=null&&Ct.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,ns)!==null&&clearTimeout(t(this,ns)),C(this,ns,setTimeout(()=>{C(this,ns,null),S(this,si,kn).call(this,e,T)},200))},Pi=new WeakSet,qr=function(e,T){const{width:tt,height:rt}=t(this,$e);let ft=tt,Ct=rt,Ht=t(this,$e);for(;ft>2*e||Ct>2*T;){const xt=ft,qt=Ct;ft>2*e&&(ft=ft>=16384?Math.floor(ft/2)-1:Math.ceil(ft/2)),Ct>2*T&&(Ct=Ct>=16384?Math.floor(Ct/2)-1:Math.ceil(Ct/2));const Gt=new OffscreenCanvas(ft,Ct);Gt.getContext("2d").drawImage(Ht,0,0,xt,qt,0,0,ft,Ct),Ht=Gt.transferToImageBitmap()}return Ht},si=new WeakSet,kn=function(e,T){e=Math.ceil(e),T=Math.ceil(T);const tt=t(this,is);if(!tt||tt.width===e&&tt.height===T)return;tt.width=e,tt.height=T;const rt=t(this,ts)?t(this,$e):S(this,Pi,qr).call(this,e,T);if(this._uiManager.hasMLManager&&!this.hasAltText()){const Ct=new OffscreenCanvas(e,T);Ct.getContext("2d").drawImage(rt,0,0,rt.width,rt.height,0,0,e,T),Ct.convertToBlob().then(Ht=>{const xt=new FileReader;xt.onload=()=>{const qt=xt.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:qt}}).then(Gt=>{const we=(Gt==null?void 0:Gt.output)||"";this.parent&&we&&!this.hasAltText()&&(this.altTextData={altText:we,decorative:!1})})},xt.readAsDataURL(Ht)})}const ft=tt.getContext("2d");ft.filter=this._uiManager.hcmFilter,ft.drawImage(rt,0,0,rt.width,rt.height,0,0,e,T)},Us=new WeakSet,Ji=function(e){if(e){if(t(this,ts)){const tt=this._uiManager.imageManager.getSvgUrl(t(this,Ge));if(tt)return tt}const T=document.createElement("canvas");return{width:T.width,height:T.height}=t(this,$e),T.getContext("2d").drawImage(t(this,$e),0,0),T.toDataURL()}if(t(this,ts)){const[T,tt]=this.pageDimensions,rt=Math.round(this.width*T*Q.PixelsPerInch.PDF_TO_CSS_UNITS),ft=Math.round(this.height*tt*Q.PixelsPerInch.PDF_TO_CSS_UNITS),Ct=new OffscreenCanvas(rt,ft);return Ct.getContext("2d").drawImage(t(this,$e),0,0,t(this,$e).width,t(this,$e).height,0,0,rt,ft),Ct.transferToImageBitmap()}return structuredClone(t(this,$e))},Ri=new WeakSet,Wr=function(){C(this,Ss,new ResizeObserver(e=>{const T=e[0].contentRect;T.width&&T.height&&S(this,Li,Gr).call(this,T.width,T.height)})),t(this,Ss).observe(this.div)},me(ii,"_type","stamp"),me(ii,"_editorType",d.AnnotationEditorType.STAMP);let K=ii;const es=class es{constructor({uiManager:pt,pageIndex:e,div:T,accessibilityManager:tt,annotationLayer:rt,drawLayer:ft,textLayer:Ct,viewport:Ht,l10n:xt}){l(this,Ii);l(this,ni);l(this,ri);l(this,ai);l(this,$s);l(this,Ms,void 0);l(this,zs,!1);l(this,rs,null);l(this,Ls,null);l(this,ls,null);l(this,cs,null);l(this,ds,null);l(this,Qe,new Map);l(this,bs,!1);l(this,Bs,!1);l(this,Vs,!1);l(this,Xe,null);l(this,de,void 0);const qt=[...t(es,vs).values()];if(!es._initialized){es._initialized=!0;for(const Gt of qt)Gt.initialize(xt,pt)}pt.registerEditorTypes(qt),C(this,de,pt),this.pageIndex=e,this.div=T,C(this,Ms,tt),C(this,rs,rt),this.viewport=Ht,C(this,Xe,Ct),this.drawLayer=ft,t(this,de).addLayer(this)}get isEmpty(){return t(this,Qe).size===0}get isInvisible(){return this.isEmpty&&t(this,de).getMode()===d.AnnotationEditorType.NONE}updateToolbar(pt){t(this,de).updateToolbar(pt)}updateMode(pt=t(this,de).getMode()){switch(S(this,$s,Qi).call(this),pt){case d.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case d.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case d.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const T of t(es,vs).values())e.toggle(`${T._type}Editing`,pt===T._editorType);this.div.hidden=!1}hasTextLayer(pt){var e;return pt===((e=t(this,Xe))==null?void 0:e.div)}addInkEditorIfNeeded(pt){if(t(this,de).getMode()===d.AnnotationEditorType.INK){if(!pt){for(const e of t(this,Qe).values())if(e.isEmpty()){e.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(pt){t(this,de).setEditingState(pt)}addCommands(pt){t(this,de).addCommands(pt)}togglePointerEvents(pt=!1){this.div.classList.toggle("disabled",!pt)}toggleAnnotationLayerPointerEvents(pt=!1){var e;(e=t(this,rs))==null||e.div.classList.toggle("disabled",!pt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const pt=new Set;for(const T of t(this,Qe).values())T.enableEditing(),T.annotationElementId&&pt.add(T.annotationElementId);if(!t(this,rs))return;const e=t(this,rs).getEditableAnnotations();for(const T of e){if(T.hide(),t(this,de).isDeletedAnnotationElement(T.data.id)||pt.has(T.data.id))continue;const tt=this.deserialize(T);tt&&(this.addOrRebuild(tt),tt.enableEditing())}}disable(){var T;C(this,Vs,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const pt=new Set;for(const tt of t(this,Qe).values()){if(tt.disableEditing(),!tt.annotationElementId||tt.serialize()!==null){pt.add(tt.annotationElementId);continue}(T=this.getEditableAnnotation(tt.annotationElementId))==null||T.show(),tt.remove()}if(t(this,rs)){const tt=t(this,rs).getEditableAnnotations();for(const rt of tt){const{id:ft}=rt.data;pt.has(ft)||t(this,de).isDeletedAnnotationElement(ft)||rt.show()}}S(this,$s,Qi).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const tt of t(es,vs).values())e.remove(`${tt._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),C(this,Vs,!1)}getEditableAnnotation(pt){var e;return((e=t(this,rs))==null?void 0:e.getEditableAnnotation(pt))||null}setActiveEditor(pt){t(this,de).getActive()!==pt&&t(this,de).setActiveEditor(pt)}enableTextSelection(){var pt;this.div.tabIndex=-1,(pt=t(this,Xe))!=null&&pt.div&&!t(this,cs)&&(C(this,cs,S(this,Ii,jr).bind(this)),t(this,Xe).div.addEventListener("pointerdown",t(this,cs)),t(this,Xe).div.classList.add("highlighting"))}disableTextSelection(){var pt;this.div.tabIndex=0,(pt=t(this,Xe))!=null&&pt.div&&t(this,cs)&&(t(this,Xe).div.removeEventListener("pointerdown",t(this,cs)),C(this,cs,null),t(this,Xe).div.classList.remove("highlighting"))}enableClick(){t(this,ls)||(C(this,ls,this.pointerdown.bind(this)),C(this,Ls,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,ls)),this.div.addEventListener("pointerup",t(this,Ls)))}disableClick(){t(this,ls)&&(this.div.removeEventListener("pointerdown",t(this,ls)),this.div.removeEventListener("pointerup",t(this,Ls)),C(this,ls,null),C(this,Ls,null))}attach(pt){t(this,Qe).set(pt.id,pt);const{annotationElementId:e}=pt;e&&t(this,de).isDeletedAnnotationElement(e)&&t(this,de).removeDeletedAnnotationElement(pt)}detach(pt){var e;t(this,Qe).delete(pt.id),(e=t(this,Ms))==null||e.removePointerInTextLayer(pt.contentDiv),!t(this,Vs)&&pt.annotationElementId&&t(this,de).addDeletedAnnotationElement(pt)}remove(pt){this.detach(pt),t(this,de).removeEditor(pt),pt.div.remove(),pt.isAttachedToDOM=!1,t(this,Bs)||this.addInkEditorIfNeeded(!1)}changeParent(pt){var e;pt.parent!==this&&(pt.annotationElementId&&(t(this,de).addDeletedAnnotationElement(pt.annotationElementId),et.AnnotationEditor.deleteAnnotationElement(pt),pt.annotationElementId=null),this.attach(pt),(e=pt.parent)==null||e.detach(pt),pt.setParent(this),pt.div&&pt.isAttachedToDOM&&(pt.div.remove(),this.div.append(pt.div)))}add(pt){if(!(pt.parent===this&&pt.isAttachedToDOM)){if(this.changeParent(pt),t(this,de).addEditor(pt),this.attach(pt),!pt.isAttachedToDOM){const e=pt.render();this.div.append(e),pt.isAttachedToDOM=!0}pt.fixAndSetPosition(),pt.onceAdded(),t(this,de).addToAnnotationStorage(pt),pt._reportTelemetry(pt.telemetryInitialData)}}moveEditorInDOM(pt){var T;if(!pt.isAttachedToDOM)return;const{activeElement:e}=document;pt.div.contains(e)&&!t(this,ds)&&(pt._focusEventsAllowed=!1,C(this,ds,setTimeout(()=>{C(this,ds,null),pt.div.contains(document.activeElement)?pt._focusEventsAllowed=!0:(pt.div.addEventListener("focusin",()=>{pt._focusEventsAllowed=!0},{once:!0}),e.focus())},0))),pt._structTreeParentId=(T=t(this,Ms))==null?void 0:T.moveElementInDOM(this.div,pt.div,pt.contentDiv,!0)}addOrRebuild(pt){pt.needsToBeRebuilt()?(pt.parent||(pt.parent=this),pt.rebuild(),pt.show()):this.add(pt)}addUndoableEditor(pt){const e=()=>pt._uiManager.rebuild(pt),T=()=>{pt.remove()};this.addCommands({cmd:e,undo:T,mustExec:!1})}getNextId(){return t(this,de).getId()}canCreateNewEmptyEditor(){var pt;return(pt=t(this,ni,Fn))==null?void 0:pt.canCreateNewEmptyEditor()}pasteEditor(pt,e){t(this,de).updateToolbar(pt),t(this,de).updateMode(pt);const{offsetX:T,offsetY:tt}=S(this,ai,On).call(this),rt=this.getNextId(),ft=S(this,ri,Dn).call(this,{parent:this,id:rt,x:T,y:tt,uiManager:t(this,de),isCentered:!0,...e});ft&&this.add(ft)}deserialize(pt){var e;return((e=t(es,vs).get(pt.annotationType??pt.annotationEditorType))==null?void 0:e.deserialize(pt,this,t(this,de)))||null}createAndAddNewEditor(pt,e,T={}){const tt=this.getNextId(),rt=S(this,ri,Dn).call(this,{parent:this,id:tt,x:pt.offsetX,y:pt.offsetY,uiManager:t(this,de),isCentered:e,...T});return rt&&this.add(rt),rt}addNewEditor(){this.createAndAddNewEditor(S(this,ai,On).call(this),!0)}setSelected(pt){t(this,de).setSelected(pt)}toggleSelected(pt){t(this,de).toggleSelected(pt)}isSelected(pt){return t(this,de).isSelected(pt)}unselect(pt){t(this,de).unselect(pt)}pointerup(pt){const{isMac:e}=d.FeatureTest.platform;if(!(pt.button!==0||pt.ctrlKey&&e)&&pt.target===this.div&&t(this,bs)){if(C(this,bs,!1),!t(this,zs)){C(this,zs,!0);return}if(t(this,de).getMode()===d.AnnotationEditorType.STAMP){t(this,de).unselectAll();return}this.createAndAddNewEditor(pt,!1)}}pointerdown(pt){if(t(this,de).getMode()===d.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,bs)){C(this,bs,!1);return}const{isMac:e}=d.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&e||pt.target!==this.div)return;C(this,bs,!0);const T=t(this,de).getActive();C(this,zs,!T||T.isEmpty())}findNewParent(pt,e,T){const tt=t(this,de).findParent(e,T);return tt===null||tt===this?!1:(tt.changeParent(pt),!0)}destroy(){var pt,e;((pt=t(this,de).getActive())==null?void 0:pt.parent)===this&&(t(this,de).commitOrRemove(),t(this,de).setActiveEditor(null)),t(this,ds)&&(clearTimeout(t(this,ds)),C(this,ds,null));for(const T of t(this,Qe).values())(e=t(this,Ms))==null||e.removePointerInTextLayer(T.contentDiv),T.setParent(null),T.isAttachedToDOM=!1,T.div.remove();this.div=null,t(this,Qe).clear(),t(this,de).removeLayer(this)}render({viewport:pt}){this.viewport=pt,(0,Q.setLayerDimensions)(this.div,pt);for(const e of t(this,de).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:pt}){t(this,de).commitOrRemove(),S(this,$s,Qi).call(this);const e=this.viewport.rotation,T=pt.rotation;if(this.viewport=pt,(0,Q.setLayerDimensions)(this.div,{rotation:T}),e!==T)for(const tt of t(this,Qe).values())tt.rotate(T);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:pt,pageHeight:e}=this.viewport.rawDims;return[pt,e]}get scale(){return t(this,de).viewParameters.realScale}};Ms=new WeakMap,zs=new WeakMap,rs=new WeakMap,Ls=new WeakMap,ls=new WeakMap,cs=new WeakMap,ds=new WeakMap,Qe=new WeakMap,bs=new WeakMap,Bs=new WeakMap,Vs=new WeakMap,Xe=new WeakMap,de=new WeakMap,vs=new WeakMap,Ii=new WeakSet,jr=function(pt){if(t(this,de).unselectAll(),pt.target===t(this,Xe).div){const{isMac:e}=d.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&e)return;t(this,de).showAllEditors("highlight",!0,!0),t(this,Xe).div.classList.add("free"),q.startHighlighting(this,t(this,de).direction==="ltr",pt),t(this,Xe).div.addEventListener("pointerup",()=>{t(this,Xe).div.classList.remove("free")},{once:!0}),pt.preventDefault()}},ni=new WeakSet,Fn=function(){return t(es,vs).get(t(this,de).getMode())},ri=new WeakSet,Dn=function(pt){const e=t(this,ni,Fn);return e?new e.prototype.constructor(pt):null},ai=new WeakSet,On=function(){const{x:pt,y:e,width:T,height:tt}=this.div.getBoundingClientRect(),rt=Math.max(0,pt),ft=Math.max(0,e),Ct=Math.min(window.innerWidth,pt+T),Ht=Math.min(window.innerHeight,e+tt),xt=(rt+Ct)/2-pt,qt=(ft+Ht)/2-e,[Gt,we]=this.viewport.rotation%180===0?[xt,qt]:[qt,xt];return{offsetX:Gt,offsetY:we}},$s=new WeakSet,Qi=function(){C(this,Bs,!0);for(const pt of t(this,Qe).values())pt.isEmpty()&&pt.remove();C(this,Bs,!1)},me(es,"_initialized",!1),l(es,vs,new Map([X,R,K,q].map(pt=>[pt._editorType,pt])));let W=es},259:(Lt,_t,lt)=>{var gt,X,B,D,Q,q,R,K,W,nt,vt,at,z,Nn,V,Hn,st,Kr,yt,Is,Et,Xr,Mt,As;lt.d(_t,{ColorPicker:()=>Y});var d=lt(292),et=lt(830),I=lt(419);const jt=class jt{constructor({editor:ht=null,uiManager:Tt=null}){l(this,z);l(this,V);l(this,st);l(this,yt);l(this,Et);l(this,Mt);l(this,gt,S(this,st,Kr).bind(this));l(this,X,S(this,Et,Xr).bind(this));l(this,B,null);l(this,D,null);l(this,Q,void 0);l(this,q,null);l(this,R,!1);l(this,K,!1);l(this,W,null);l(this,nt,void 0);l(this,vt,null);l(this,at,void 0);var Vt;ht?(C(this,K,!1),C(this,at,d.AnnotationEditorParamsType.HIGHLIGHT_COLOR),C(this,W,ht)):(C(this,K,!0),C(this,at,d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),C(this,vt,(ht==null?void 0:ht._uiManager)||Tt),C(this,nt,t(this,vt)._eventBus),C(this,Q,(ht==null?void 0:ht.color)||((Vt=t(this,vt))==null?void 0:Vt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,d.shadow)(this,"_keyboardManager",new et.KeyboardManager([[["Escape","mac+Escape"],jt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],jt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],jt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],jt.prototype._moveToPrevious],[["Home","mac+Home"],jt.prototype._moveToBeginning],[["End","mac+End"],jt.prototype._moveToEnd]]))}renderButton(){const ht=C(this,B,document.createElement("button"));ht.className="colorPicker",ht.tabIndex="0",ht.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),ht.setAttribute("aria-haspopup",!0),ht.addEventListener("click",S(this,yt,Is).bind(this)),ht.addEventListener("keydown",t(this,gt));const Tt=C(this,D,document.createElement("span"));return Tt.className="swatch",Tt.setAttribute("aria-hidden",!0),Tt.style.backgroundColor=t(this,Q),ht.append(Tt),ht}renderMainDropdown(){const ht=C(this,q,S(this,z,Nn).call(this));return ht.setAttribute("aria-orientation","horizontal"),ht.setAttribute("aria-labelledby","highlightColorPickerLabel"),ht}_colorSelectFromKeyboard(ht){if(ht.target===t(this,B)){S(this,yt,Is).call(this,ht);return}const Tt=ht.target.getAttribute("data-color");Tt&&S(this,V,Hn).call(this,Tt,ht)}_moveToNext(ht){var Tt,Vt;if(!t(this,Mt,As)){S(this,yt,Is).call(this,ht);return}if(ht.target===t(this,B)){(Tt=t(this,q).firstChild)==null||Tt.focus();return}(Vt=ht.target.nextSibling)==null||Vt.focus()}_moveToPrevious(ht){var Tt,Vt;if(ht.target===((Tt=t(this,q))==null?void 0:Tt.firstChild)||ht.target===t(this,B)){t(this,Mt,As)&&this._hideDropdownFromKeyboard();return}t(this,Mt,As)||S(this,yt,Is).call(this,ht),(Vt=ht.target.previousSibling)==null||Vt.focus()}_moveToBeginning(ht){var Tt;if(!t(this,Mt,As)){S(this,yt,Is).call(this,ht);return}(Tt=t(this,q).firstChild)==null||Tt.focus()}_moveToEnd(ht){var Tt;if(!t(this,Mt,As)){S(this,yt,Is).call(this,ht);return}(Tt=t(this,q).lastChild)==null||Tt.focus()}hideDropdown(){var ht;(ht=t(this,q))==null||ht.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,X))}_hideDropdownFromKeyboard(){var ht;if(!t(this,K)){if(!t(this,Mt,As)){(ht=t(this,W))==null||ht.unselect();return}this.hideDropdown(),t(this,B).focus({preventScroll:!0,focusVisible:t(this,R)})}}updateColor(ht){if(t(this,D)&&(t(this,D).style.backgroundColor=ht),!t(this,q))return;const Tt=t(this,vt).highlightColors.values();for(const Vt of t(this,q).children)Vt.setAttribute("aria-selected",Tt.next().value===ht)}destroy(){var ht,Tt;(ht=t(this,B))==null||ht.remove(),C(this,B,null),C(this,D,null),(Tt=t(this,q))==null||Tt.remove(),C(this,q,null)}};gt=new WeakMap,X=new WeakMap,B=new WeakMap,D=new WeakMap,Q=new WeakMap,q=new WeakMap,R=new WeakMap,K=new WeakMap,W=new WeakMap,nt=new WeakMap,vt=new WeakMap,at=new WeakMap,z=new WeakSet,Nn=function(){const ht=document.createElement("div");ht.addEventListener("contextmenu",I.noContextMenu),ht.className="dropdown",ht.role="listbox",ht.setAttribute("aria-multiselectable",!1),ht.setAttribute("aria-orientation","vertical"),ht.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[Tt,Vt]of t(this,vt).highlightColors){const Ut=document.createElement("button");Ut.tabIndex="0",Ut.role="option",Ut.setAttribute("data-color",Vt),Ut.title=Tt,Ut.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${Tt}`);const ee=document.createElement("span");Ut.append(ee),ee.className="swatch",ee.style.backgroundColor=Vt,Ut.setAttribute("aria-selected",Vt===t(this,Q)),Ut.addEventListener("click",S(this,V,Hn).bind(this,Vt)),ht.append(Ut)}return ht.addEventListener("keydown",t(this,gt)),ht},V=new WeakSet,Hn=function(ht,Tt){Tt.stopPropagation(),t(this,nt).dispatch("switchannotationeditorparams",{source:this,type:t(this,at),value:ht})},st=new WeakSet,Kr=function(ht){jt._keyboardManager.exec(this,ht)},yt=new WeakSet,Is=function(ht){if(t(this,Mt,As)){this.hideDropdown();return}if(C(this,R,ht.detail===0),window.addEventListener("pointerdown",t(this,X)),t(this,q)){t(this,q).classList.remove("hidden");return}const Tt=C(this,q,S(this,z,Nn).call(this));t(this,B).append(Tt)},Et=new WeakSet,Xr=function(ht){var Tt;(Tt=t(this,q))!=null&&Tt.contains(ht.target)||this.hideDropdown()},Mt=new WeakSet,As=function(){return t(this,q)&&!t(this,q).classList.contains("hidden")};let Y=jt},310:(Lt,_t,lt)=>{var D,Q,q,R,K,W,nt,vt,Un,$,V,O,st,ot,yt,It,Et,Ot,Mt,Bt,jt,Jt,ht,Tt,Vt,Ut,ee,ne,le,Ce,ge,zn,be,Bn,oe,Vn,re,Yr,se,Jr,s,$n,c,Gn,o,qn,b,Qr,u,Zr,h,ta,r,ea,E,Wn,k,vi;lt.d(_t,{AnnotationEditor:()=>X});var d=lt(830),et=lt(292),I=lt(419);const z=class z{constructor(p){l(this,vt);l(this,D,"");l(this,Q,!1);l(this,q,null);l(this,R,null);l(this,K,null);l(this,W,!1);l(this,nt,null);C(this,nt,p)}static initialize(p){z._l10nPromise||(z._l10nPromise=p)}async render(){const p=C(this,q,document.createElement("button"));p.className="altText";const _=await z._l10nPromise.get("pdfjs-editor-alt-text-button-label");p.textContent=_,p.setAttribute("aria-label",_),p.tabIndex="0",p.addEventListener("contextmenu",I.noContextMenu),p.addEventListener("pointerdown",w=>w.stopPropagation());const H=w=>{w.preventDefault(),t(this,nt)._uiManager.editAltText(t(this,nt))};return p.addEventListener("click",H,{capture:!0}),p.addEventListener("keydown",w=>{w.target===p&&w.key==="Enter"&&(C(this,W,!0),H(w))}),await S(this,vt,Un).call(this),p}finish(){t(this,q)&&(t(this,q).focus({focusVisible:t(this,W)}),C(this,W,!1))}isEmpty(){return!t(this,D)&&!t(this,Q)}get data(){return{altText:t(this,D),decorative:t(this,Q)}}set data({altText:p,decorative:_}){t(this,D)===p&&t(this,Q)===_||(C(this,D,p),C(this,Q,_),S(this,vt,Un).call(this))}toggle(p=!1){t(this,q)&&(!p&&t(this,K)&&(clearTimeout(t(this,K)),C(this,K,null)),t(this,q).disabled=!p)}destroy(){var p;(p=t(this,q))==null||p.remove(),C(this,q,null),C(this,R,null)}};D=new WeakMap,Q=new WeakMap,q=new WeakMap,R=new WeakMap,K=new WeakMap,W=new WeakMap,nt=new WeakMap,vt=new WeakSet,Un=async function(){var H,w;const p=t(this,q);if(!p)return;if(!t(this,D)&&!t(this,Q)){p.classList.remove("done"),(H=t(this,R))==null||H.remove();return}p.classList.add("done"),z._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(m=>{p.setAttribute("aria-label",m)});let _=t(this,R);if(!_){C(this,R,_=document.createElement("span")),_.className="tooltip",_.setAttribute("role","tooltip");const m=_.id=`alt-text-tooltip-${t(this,nt).id}`;p.setAttribute("aria-describedby",m);const L=100;p.addEventListener("mouseenter",()=>{C(this,K,setTimeout(()=>{C(this,K,null),t(this,R).classList.add("show"),t(this,nt)._reportTelemetry({action:"alt_text_tooltip"})},L))}),p.addEventListener("mouseleave",()=>{var N;t(this,K)&&(clearTimeout(t(this,K)),C(this,K,null)),(N=t(this,R))==null||N.classList.remove("show")})}_.innerText=t(this,Q)?await z._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,D),_.parentNode||p.append(_),(w=t(this,nt).getImageForAltText())==null||w.setAttribute("aria-describedby",_.id)},me(z,"_l10nPromise",null);let Y=z;var gt=lt(362);const F=class F{constructor(p){l(this,ge);l(this,oe);l(this,re);l(this,se);l(this,s);l(this,c);l(this,o);l(this,b);l(this,u);l(this,h);l(this,r);l(this,E);l(this,k);l(this,$,null);l(this,V,null);l(this,O,!1);l(this,st,!1);l(this,ot,null);l(this,yt,null);l(this,It,this.focusin.bind(this));l(this,Et,this.focusout.bind(this));l(this,Ot,null);l(this,Mt,"");l(this,Bt,!1);l(this,jt,null);l(this,Jt,!1);l(this,ht,!1);l(this,Tt,!1);l(this,Vt,null);l(this,Ut,0);l(this,ee,0);l(this,ne,null);me(this,"_initialOptions",Object.create(null));me(this,"_isVisible",!0);me(this,"_uiManager",null);me(this,"_focusEventsAllowed",!0);me(this,"_l10nPromise",null);l(this,le,!1);l(this,Ce,F._zIndex++);this.constructor===F&&(0,et.unreachable)("Cannot initialize AnnotationEditor."),this.parent=p.parent,this.id=p.id,this.width=this.height=null,this.pageIndex=p.parent.pageIndex,this.name=p.name,this.div=null,this._uiManager=p.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=p.isCentered,this._structTreeParentId=null;const{rotation:_,rawDims:{pageWidth:H,pageHeight:w,pageX:m,pageY:L}}=this.parent.viewport;this.rotation=_,this.pageRotation=(360+_-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[H,w],this.pageTranslation=[m,L];const[N,Z]=this.parentDimensions;this.x=p.x/N,this.y=p.y/Z,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const p=F.prototype._resizeWithKeyboard,_=d.AnnotationEditorUIManager.TRANSLATE_SMALL,H=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,et.shadow)(this,"_resizerKeyboardManager",new d.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],p,{args:[-_,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],p,{args:[-H,0]}],[["ArrowRight","mac+ArrowRight"],p,{args:[_,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],p,{args:[H,0]}],[["ArrowUp","mac+ArrowUp"],p,{args:[0,-_]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],p,{args:[0,-H]}],[["ArrowDown","mac+ArrowDown"],p,{args:[0,_]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],p,{args:[0,H]}],[["Escape","mac+Escape"],F.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,et.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(p){const _=new B({id:p.parent.getNextId(),parent:p.parent,uiManager:p._uiManager});_.annotationElementId=p.annotationElementId,_.deleted=!0,_._uiManager.addToAnnotationStorage(_)}static initialize(p,_,H){if(F._l10nPromise||(F._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(m=>[m,p.get(m.replaceAll(/([A-Z])/g,L=>`-${L.toLowerCase()}`))]))),H==null?void 0:H.strings)for(const m of H.strings)F._l10nPromise.set(m,p.get(m));if(F._borderLineWidth!==-1)return;const w=getComputedStyle(document.documentElement);F._borderLineWidth=parseFloat(w.getPropertyValue("--outline-width"))||0}static updateDefaultParams(p,_){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(p){return!1}static paste(p,_){(0,et.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,le)}set _isDraggable(p){var _;C(this,le,p),(_=this.div)==null||_.classList.toggle("draggable",p)}get isEnterHandled(){return!0}center(){const[p,_]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*_/(p*2),this.y+=this.width*p/(_*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*_/(p*2),this.y-=this.width*p/(_*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(p){this._uiManager.addCommands(p)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,Ce)}setParent(p){p!==null?(this.pageIndex=p.pageIndex,this.pageDimensions=p.pageDimensions):S(this,k,vi).call(this),this.parent=p}focusin(p){this._focusEventsAllowed&&(t(this,Bt)?C(this,Bt,!1):this.parent.setSelected(this))}focusout(p){var _,H;!this._focusEventsAllowed||!this.isAttachedToDOM||(_=p.relatedTarget)!=null&&_.closest(`#${this.id}`)||(p.preventDefault(),(H=this.parent)!=null&&H.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(p,_,H,w){const[m,L]=this.parentDimensions;[H,w]=this.screenToPageTranslation(H,w),this.x=(p+H)/m,this.y=(_+w)/L,this.fixAndSetPosition()}translate(p,_){S(this,ge,zn).call(this,this.parentDimensions,p,_)}translateInPage(p,_){t(this,jt)||C(this,jt,[this.x,this.y]),S(this,ge,zn).call(this,this.pageDimensions,p,_),this.div.scrollIntoView({block:"nearest"})}drag(p,_){t(this,jt)||C(this,jt,[this.x,this.y]);const[H,w]=this.parentDimensions;if(this.x+=p/H,this.y+=_/w,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ct,y:mt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ct,mt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:m,y:L}=this;const[N,Z]=this.getBaseTranslation();m+=N,L+=Z,this.div.style.left=`${(100*m).toFixed(2)}%`,this.div.style.top=`${(100*L).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,jt)&&(t(this,jt)[0]!==this.x||t(this,jt)[1]!==this.y)}getBaseTranslation(){const[p,_]=this.parentDimensions,{_borderLineWidth:H}=F,w=H/p,m=H/_;switch(this.rotation){case 90:return[-w,m];case 180:return[w,m];case 270:return[w,-m];default:return[-w,-m]}}get _mustFixPosition(){return!0}fixAndSetPosition(p=this.rotation){const[_,H]=this.pageDimensions;let{x:w,y:m,width:L,height:N}=this;if(L*=_,N*=H,w*=_,m*=H,this._mustFixPosition)switch(p){case 0:w=Math.max(0,Math.min(_-L,w)),m=Math.max(0,Math.min(H-N,m));break;case 90:w=Math.max(0,Math.min(_-N,w)),m=Math.min(H,Math.max(L,m));break;case 180:w=Math.min(_,Math.max(L,w)),m=Math.min(H,Math.max(N,m));break;case 270:w=Math.min(_,Math.max(N,w)),m=Math.max(0,Math.min(H-L,m));break}this.x=w/=_,this.y=m/=H;const[Z,ct]=this.getBaseTranslation();w+=Z,m+=ct;const{style:mt}=this.div;mt.left=`${(100*w).toFixed(2)}%`,mt.top=`${(100*m).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(p,_){var H;return S(H=F,be,Bn).call(H,p,_,this.parentRotation)}pageTranslationToScreen(p,_){var H;return S(H=F,be,Bn).call(H,p,_,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:p,pageDimensions:[_,H]}=this,w=_*p,m=H*p;return et.FeatureTest.isCSSRoundSupported?[Math.round(w),Math.round(m)]:[w,m]}setDims(p,_){const[H,w]=this.parentDimensions;this.div.style.width=`${(100*p/H).toFixed(2)}%`,t(this,st)||(this.div.style.height=`${(100*_/w).toFixed(2)}%`)}fixDims(){const{style:p}=this.div,{height:_,width:H}=p,w=H.endsWith("%"),m=!t(this,st)&&_.endsWith("%");if(w&&m)return;const[L,N]=this.parentDimensions;w||(p.width=`${(100*parseFloat(H)/L).toFixed(2)}%`),!t(this,st)&&!m&&(p.height=`${(100*parseFloat(_)/N).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var p;(p=t(this,V))==null||p.finish()}async addEditToolbar(){return t(this,Ot)||t(this,ht)?t(this,Ot):(C(this,Ot,new gt.EditorToolbar(this)),this.div.append(t(this,Ot).render()),t(this,V)&&t(this,Ot).addAltTextButton(await t(this,V).render()),t(this,Ot))}removeEditToolbar(){var p;t(this,Ot)&&(t(this,Ot).remove(),C(this,Ot,null),(p=t(this,V))==null||p.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,V)||(Y.initialize(F._l10nPromise),C(this,V,new Y(this)),await this.addEditToolbar())}get altTextData(){var p;return(p=t(this,V))==null?void 0:p.data}set altTextData(p){t(this,V)&&(t(this,V).data=p)}hasAltText(){var p;return!((p=t(this,V))!=null&&p.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,O)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,It)),this.div.addEventListener("focusout",t(this,Et));const[p,_]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*_/p).toFixed(2)}%`,this.div.style.maxHeight=`${(100*p/_).toFixed(2)}%`);const[H,w]=this.getInitialTranslation();return this.translate(H,w),(0,d.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(p){const{isMac:_}=et.FeatureTest.platform;if(p.button!==0||p.ctrlKey&&_){p.preventDefault();return}if(C(this,Bt,!0),this._isDraggable){S(this,b,Qr).call(this,p);return}S(this,o,qn).call(this,p)}moveInDOM(){t(this,Vt)&&clearTimeout(t(this,Vt)),C(this,Vt,setTimeout(()=>{var p;C(this,Vt,null),(p=this.parent)==null||p.moveEditorInDOM(this)},0))}_setParentAndPosition(p,_,H){p.changeParent(this),this.x=_,this.y=H,this.fixAndSetPosition()}getRect(p,_,H=this.rotation){const w=this.parentScale,[m,L]=this.pageDimensions,[N,Z]=this.pageTranslation,ct=p/w,mt=_/w,St=this.x*m,$t=this.y*L,te=this.width*m,Zt=this.height*L;switch(H){case 0:return[St+ct+N,L-$t-mt-Zt+Z,St+ct+te+N,L-$t-mt+Z];case 90:return[St+mt+N,L-$t+ct+Z,St+mt+Zt+N,L-$t+ct+te+Z];case 180:return[St-ct-te+N,L-$t+mt+Z,St-ct+N,L-$t+mt+Zt+Z];case 270:return[St-mt-Zt+N,L-$t-ct-te+Z,St-mt+N,L-$t-ct+Z];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(p,_){const[H,w,m,L]=p,N=m-H,Z=L-w;switch(this.rotation){case 0:return[H,_-L,N,Z];case 90:return[H,_-w,Z,N];case 180:return[m,_-w,N,Z];case 270:return[m,_-L,Z,N];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){C(this,ht,!0)}disableEditMode(){C(this,ht,!1)}isInEditMode(){return t(this,ht)}shouldGetKeyboardEvents(){return t(this,Tt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var p,_;(p=this.div)==null||p.addEventListener("focusin",t(this,It)),(_=this.div)==null||_.addEventListener("focusout",t(this,Et))}rotate(p){}serialize(p=!1,_=null){(0,et.unreachable)("An editor must be serializable")}static deserialize(p,_,H){const w=new this.prototype.constructor({parent:_,id:_.getNextId(),uiManager:H});w.rotation=p.rotation;const[m,L]=w.pageDimensions,[N,Z,ct,mt]=w.getRectInCurrentCoords(p.rect,L);return w.x=N/m,w.y=Z/L,w.width=ct/m,w.height=mt/L,w}remove(){if(this.div.removeEventListener("focusin",t(this,It)),this.div.removeEventListener("focusout",t(this,Et)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,Vt)&&(clearTimeout(t(this,Vt)),C(this,Vt,null)),S(this,k,vi).call(this),this.removeEditToolbar(),t(this,ne)){for(const p of t(this,ne).values())clearTimeout(p);C(this,ne,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(S(this,re,Yr).call(this),t(this,ot).classList.remove("hidden"),(0,d.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(p){if(!this.isResizable||p.target!==this.div||p.key!=="Enter")return;this._uiManager.setSelected(this),C(this,yt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const _=t(this,ot).children;if(!t(this,$)){C(this,$,Array.from(_));const L=S(this,u,Zr).bind(this),N=S(this,h,ta).bind(this);for(const Z of t(this,$)){const ct=Z.getAttribute("data-resizer-name");Z.setAttribute("role","spinbutton"),Z.addEventListener("keydown",L),Z.addEventListener("blur",N),Z.addEventListener("focus",S(this,r,ea).bind(this,ct)),F._l10nPromise.get(`pdfjs-editor-resizer-label-${ct}`).then(mt=>Z.setAttribute("aria-label",mt))}}const H=t(this,$)[0];let w=0;for(const L of _){if(L===H)break;w++}const m=(360-this.rotation+this.parentRotation)%360/90*(t(this,$).length/4);if(m!==w){if(m<w)for(let N=0;N<w-m;N++)t(this,ot).append(t(this,ot).firstChild);else if(m>w)for(let N=0;N<m-w;N++)t(this,ot).firstChild.before(t(this,ot).lastChild);let L=0;for(const N of _){const Z=t(this,$)[L++].getAttribute("data-resizer-name");F._l10nPromise.get(`pdfjs-editor-resizer-label-${Z}`).then(ct=>N.setAttribute("aria-label",ct))}}S(this,E,Wn).call(this,0),C(this,Tt,!0),t(this,ot).firstChild.focus({focusVisible:!0}),p.preventDefault(),p.stopImmediatePropagation()}_resizeWithKeyboard(p,_){t(this,Tt)&&S(this,c,Gn).call(this,t(this,Mt),{movementX:p,movementY:_})}_stopResizingWithKeyboard(){S(this,k,vi).call(this),this.div.focus()}select(){var p,_;if(this.makeResizable(),(p=this.div)==null||p.classList.add("selectedEditor"),!t(this,Ot)){this.addEditToolbar().then(()=>{var H,w;(H=this.div)!=null&&H.classList.contains("selectedEditor")&&((w=t(this,Ot))==null||w.show())});return}(_=t(this,Ot))==null||_.show()}unselect(){var p,_,H,w;(p=t(this,ot))==null||p.classList.add("hidden"),(_=this.div)==null||_.classList.remove("selectedEditor"),(H=this.div)!=null&&H.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(w=t(this,Ot))==null||w.hide()}updateParams(p,_){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Jt)}set isEditing(p){C(this,Jt,p),this.parent&&(p?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(p,_){C(this,st,!0);const H=p/_,{style:w}=this.div;w.aspectRatio=H,w.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(p,_=!1){if(_){t(this,ne)||C(this,ne,new Map);const{action:H}=p;let w=t(this,ne).get(H);w&&clearTimeout(w),w=setTimeout(()=>{this._reportTelemetry(p),t(this,ne).delete(H),t(this,ne).size===0&&C(this,ne,null)},F._telemetryTimeout),t(this,ne).set(H,w);return}p.type||(p.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:p}})}show(p=this._isVisible){this.div.classList.toggle("hidden",!p),this._isVisible=p}enable(){this.div&&(this.div.tabIndex=0),C(this,O,!1)}disable(){this.div&&(this.div.tabIndex=-1),C(this,O,!0)}};$=new WeakMap,V=new WeakMap,O=new WeakMap,st=new WeakMap,ot=new WeakMap,yt=new WeakMap,It=new WeakMap,Et=new WeakMap,Ot=new WeakMap,Mt=new WeakMap,Bt=new WeakMap,jt=new WeakMap,Jt=new WeakMap,ht=new WeakMap,Tt=new WeakMap,Vt=new WeakMap,Ut=new WeakMap,ee=new WeakMap,ne=new WeakMap,le=new WeakMap,Ce=new WeakMap,ge=new WeakSet,zn=function([p,_],H,w){[H,w]=this.screenToPageTranslation(H,w),this.x+=H/p,this.y+=w/_,this.fixAndSetPosition()},be=new WeakSet,Bn=function(p,_,H){switch(H){case 90:return[_,-p];case 180:return[-p,-_];case 270:return[-_,p];default:return[p,_]}},oe=new WeakSet,Vn=function(p){switch(p){case 90:{const[_,H]=this.pageDimensions;return[0,-_/H,H/_,0]}case 180:return[-1,0,0,-1];case 270:{const[_,H]=this.pageDimensions;return[0,_/H,-H/_,0]}default:return[1,0,0,1]}},re=new WeakSet,Yr=function(){if(t(this,ot))return;C(this,ot,document.createElement("div")),t(this,ot).classList.add("resizers");const p=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const _ of p){const H=document.createElement("div");t(this,ot).append(H),H.classList.add("resizer",_),H.setAttribute("data-resizer-name",_),H.addEventListener("pointerdown",S(this,se,Jr).bind(this,_)),H.addEventListener("contextmenu",I.noContextMenu),H.tabIndex=-1}this.div.prepend(t(this,ot))},se=new WeakSet,Jr=function(p,_){var Zt;_.preventDefault();const{isMac:H}=et.FeatureTest.platform;if(_.button!==0||_.ctrlKey&&H)return;(Zt=t(this,V))==null||Zt.toggle(!1);const w=S(this,c,Gn).bind(this,p),m=this._isDraggable;this._isDraggable=!1;const L={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",w,L);const N=this.x,Z=this.y,ct=this.width,mt=this.height,St=this.parent.div.style.cursor,$t=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(_.target).cursor;const te=()=>{var Ae;this.parent.togglePointerEvents(!0),(Ae=t(this,V))==null||Ae.toggle(!0),this._isDraggable=m,window.removeEventListener("pointerup",te),window.removeEventListener("blur",te),window.removeEventListener("pointermove",w,L),this.parent.div.style.cursor=St,this.div.style.cursor=$t,S(this,s,$n).call(this,N,Z,ct,mt)};window.addEventListener("pointerup",te),window.addEventListener("blur",te)},s=new WeakSet,$n=function(p,_,H,w){const m=this.x,L=this.y,N=this.width,Z=this.height;m===p&&L===_&&N===H&&Z===w||this.addCommands({cmd:()=>{this.width=N,this.height=Z,this.x=m,this.y=L;const[ct,mt]=this.parentDimensions;this.setDims(ct*N,mt*Z),this.fixAndSetPosition()},undo:()=>{this.width=H,this.height=w,this.x=p,this.y=_;const[ct,mt]=this.parentDimensions;this.setDims(ct*H,mt*w),this.fixAndSetPosition()},mustExec:!0})},c=new WeakSet,Gn=function(p,_){const[H,w]=this.parentDimensions,m=this.x,L=this.y,N=this.width,Z=this.height,ct=F.MIN_SIZE/H,mt=F.MIN_SIZE/w,St=wt=>Math.round(wt*1e4)/1e4,$t=S(this,oe,Vn).call(this,this.rotation),te=(wt,kt)=>[$t[0]*wt+$t[2]*kt,$t[1]*wt+$t[3]*kt],Zt=S(this,oe,Vn).call(this,360-this.rotation),Ae=(wt,kt)=>[Zt[0]*wt+Zt[2]*kt,Zt[1]*wt+Zt[3]*kt];let fe,Re,pe=!1,Pe=!1;switch(p){case"topLeft":pe=!0,fe=(wt,kt)=>[0,0],Re=(wt,kt)=>[wt,kt];break;case"topMiddle":fe=(wt,kt)=>[wt/2,0],Re=(wt,kt)=>[wt/2,kt];break;case"topRight":pe=!0,fe=(wt,kt)=>[wt,0],Re=(wt,kt)=>[0,kt];break;case"middleRight":Pe=!0,fe=(wt,kt)=>[wt,kt/2],Re=(wt,kt)=>[0,kt/2];break;case"bottomRight":pe=!0,fe=(wt,kt)=>[wt,kt],Re=(wt,kt)=>[0,0];break;case"bottomMiddle":fe=(wt,kt)=>[wt/2,kt],Re=(wt,kt)=>[wt/2,0];break;case"bottomLeft":pe=!0,fe=(wt,kt)=>[0,kt],Re=(wt,kt)=>[wt,0];break;case"middleLeft":Pe=!0,fe=(wt,kt)=>[0,kt/2],Re=(wt,kt)=>[wt,kt/2];break}const ie=fe(N,Z),M=Re(N,Z);let x=te(...M);const j=St(m+x[0]),it=St(L+x[1]);let dt=1,At=1,[bt,zt]=this.screenToPageTranslation(_.movementX,_.movementY);if([bt,zt]=Ae(bt/H,zt/w),pe){const wt=Math.hypot(N,Z);dt=At=Math.max(Math.min(Math.hypot(M[0]-ie[0]-bt,M[1]-ie[1]-zt)/wt,1/N,1/Z),ct/N,mt/Z)}else Pe?dt=Math.max(ct,Math.min(1,Math.abs(M[0]-ie[0]-bt)))/N:At=Math.max(mt,Math.min(1,Math.abs(M[1]-ie[1]-zt)))/Z;const Nt=St(N*dt),Pt=St(Z*At);x=te(...Re(Nt,Pt));const Kt=j-x[0],Dt=it-x[1];this.width=Nt,this.height=Pt,this.x=Kt,this.y=Dt,this.setDims(H*Nt,w*Pt),this.fixAndSetPosition()},o=new WeakSet,qn=function(p){const{isMac:_}=et.FeatureTest.platform;p.ctrlKey&&!_||p.shiftKey||p.metaKey&&_?this.parent.toggleSelected(this):this.parent.setSelected(this)},b=new WeakSet,Qr=function(p){const _=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let H,w;_&&(this.div.classList.add("moving"),H={passive:!0,capture:!0},C(this,Ut,p.clientX),C(this,ee,p.clientY),w=L=>{const{clientX:N,clientY:Z}=L,[ct,mt]=this.screenToPageTranslation(N-t(this,Ut),Z-t(this,ee));C(this,Ut,N),C(this,ee,Z),this._uiManager.dragSelectedEditors(ct,mt)},window.addEventListener("pointermove",w,H));const m=()=>{window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),_&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",w,H)),C(this,Bt,!1),this._uiManager.endDragSession()||S(this,o,qn).call(this,p)};window.addEventListener("pointerup",m),window.addEventListener("blur",m)},u=new WeakSet,Zr=function(p){F._resizerKeyboardManager.exec(this,p)},h=new WeakSet,ta=function(p){var _;t(this,Tt)&&((_=p.relatedTarget)==null?void 0:_.parentNode)!==t(this,ot)&&S(this,k,vi).call(this)},r=new WeakSet,ea=function(p){C(this,Mt,t(this,Tt)?p:"")},E=new WeakSet,Wn=function(p){if(t(this,$))for(const _ of t(this,$))_.tabIndex=p},k=new WeakSet,vi=function(){if(C(this,Tt,!1),S(this,E,Wn).call(this,-1),t(this,yt)){const{savedX:p,savedY:_,savedWidth:H,savedHeight:w}=t(this,yt);S(this,s,$n).call(this,p,_,H,w),C(this,yt,null)}},l(F,be),me(F,"_borderLineWidth",-1),me(F,"_colorManager",new d.ColorManager),me(F,"_zIndex",1),me(F,"_telemetryTimeout",1e3);let X=F;class B extends X{constructor(p){super(p),this.annotationElementId=p.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(Lt,_t,lt)=>{var B,D,Q,q,sa,K,Zi,nt,ia,at,na,$,jn,O,st,ot,yt,It,Et,Ot,Mt,Bt,jt,Jt,ht,Tt,Vt,Ut,ee,ne,le,Ce,Kn,be,Wt,oe,Me,re,Se,se,J,Ai,n,yi,f,ra;lt.d(_t,{FreeOutliner:()=>gt,Outliner:()=>et});var d=lt(292);class et{constructor(b,y=0,u=0,a=!0){l(this,q);l(this,K);l(this,nt);l(this,at);l(this,$);l(this,B,void 0);l(this,D,[]);l(this,Q,[]);let h=1/0,i=-1/0,r=1/0,g=-1/0;const E=10**-4;for(const{x:_,y:H,width:w,height:m}of b){const L=Math.floor((_-y)/E)*E,N=Math.ceil((_+w+y)/E)*E,Z=Math.floor((H-y)/E)*E,ct=Math.ceil((H+m+y)/E)*E,mt=[L,Z,ct,!0],St=[N,Z,ct,!1];t(this,D).push(mt,St),h=Math.min(h,L),i=Math.max(i,N),r=Math.min(r,Z),g=Math.max(g,ct)}const v=i-h+2*u,k=g-r+2*u,U=h-u,F=r-u,G=t(this,D).at(a?-1:-2),p=[G[0],G[2]];for(const _ of t(this,D)){const[H,w,m]=_;_[0]=(H-U)/v,_[1]=(w-F)/k,_[2]=(m-F)/k}C(this,B,{x:U,y:F,width:v,height:k,lastPoint:p})}getOutlines(){t(this,D).sort((y,u)=>y[0]-u[0]||y[1]-u[1]||y[2]-u[2]);const b=[];for(const y of t(this,D))y[3]?(b.push(...S(this,$,jn).call(this,y)),S(this,nt,ia).call(this,y)):(S(this,at,na).call(this,y),b.push(...S(this,$,jn).call(this,y)));return S(this,q,sa).call(this,b)}}B=new WeakMap,D=new WeakMap,Q=new WeakMap,q=new WeakSet,sa=function(b){const y=[],u=new Set;for(const i of b){const[r,g,E]=i;y.push([r,g,i],[r,E,i])}y.sort((i,r)=>i[1]-r[1]||i[0]-r[0]);for(let i=0,r=y.length;i<r;i+=2){const g=y[i][2],E=y[i+1][2];g.push(E),E.push(g),u.add(g),u.add(E)}const a=[];let h;for(;u.size>0;){const i=u.values().next().value;let[r,g,E,v,k]=i;u.delete(i);let U=r,F=g;for(h=[r,E],a.push(h);;){let G;if(u.has(v))G=v;else if(u.has(k))G=k;else break;u.delete(G),[r,g,E,v,k]=G,U!==r&&(h.push(U,F,r,F===g?g:E),U=r),F=F===g?E:g}h.push(U,F)}return new Y(a,t(this,B))},K=new WeakSet,Zi=function(b){const y=t(this,Q);let u=0,a=y.length-1;for(;u<=a;){const h=u+a>>1,i=y[h][0];if(i===b)return h;i<b?u=h+1:a=h-1}return a+1},nt=new WeakSet,ia=function([,b,y]){const u=S(this,K,Zi).call(this,b);t(this,Q).splice(u,0,[b,y])},at=new WeakSet,na=function([,b,y]){const u=S(this,K,Zi).call(this,b);for(let a=u;a<t(this,Q).length;a++){const[h,i]=t(this,Q)[a];if(h!==b)break;if(h===b&&i===y){t(this,Q).splice(a,1);return}}for(let a=u-1;a>=0;a--){const[h,i]=t(this,Q)[a];if(h!==b)break;if(h===b&&i===y){t(this,Q).splice(a,1);return}}},$=new WeakSet,jn=function(b){const[y,u,a]=b,h=[[y,u,a]],i=S(this,K,Zi).call(this,a);for(let r=0;r<i;r++){const[g,E]=t(this,Q)[r];for(let v=0,k=h.length;v<k;v++){const[,U,F]=h[v];if(!(E<=U||F<=g)){if(U>=g){if(F>E)h[v][1]=E;else{if(k===1)return[];h.splice(v,1),v--,k--}continue}h[v][2]=g,F>E&&h.push([y,E,F])}}}return h};class I{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(b,y){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof X}}class Y extends I{constructor(y,u){super();l(this,O,void 0);l(this,st,void 0);C(this,st,y),C(this,O,u)}toSVGPath(){const y=[];for(const u of t(this,st)){let[a,h]=u;y.push(`M${a} ${h}`);for(let i=2;i<u.length;i+=2){const r=u[i],g=u[i+1];r===a?(y.push(`V${g}`),h=g):g===h&&(y.push(`H${r}`),a=r)}y.push("Z")}return y.join(" ")}serialize([y,u,a,h],i){const r=[],g=a-y,E=h-u;for(const v of t(this,st)){const k=new Array(v.length);for(let U=0;U<v.length;U+=2)k[U]=y+v[U]*g,k[U+1]=h-v[U+1]*E;r.push(k)}return r}get box(){return t(this,O)}}O=new WeakMap,st=new WeakMap;const ve=class ve{constructor({x:b,y},u,a,h,i,r=0){l(this,Ce);l(this,ot,void 0);l(this,yt,[]);l(this,It,void 0);l(this,Et,void 0);l(this,Ot,[]);l(this,Mt,new Float64Array(18));l(this,Bt,void 0);l(this,jt,void 0);l(this,Jt,void 0);l(this,ht,void 0);l(this,Tt,void 0);l(this,Vt,void 0);l(this,Ut,[]);C(this,ot,u),C(this,Vt,h*a),C(this,Et,i),t(this,Mt).set([NaN,NaN,NaN,NaN,b,y],6),C(this,It,r),C(this,ht,t(ve,ee)*a),C(this,Jt,t(ve,le)*a),C(this,Tt,a),t(this,Ut).push(b,y)}get free(){return!0}isEmpty(){return isNaN(t(this,Mt)[8])}add({x:b,y}){var mt;C(this,Bt,b),C(this,jt,y);const[u,a,h,i]=t(this,ot);let[r,g,E,v]=t(this,Mt).subarray(8,12);const k=b-E,U=y-v,F=Math.hypot(k,U);if(F<t(this,Jt))return!1;const G=F-t(this,ht),p=G/F,_=p*k,H=p*U;let w=r,m=g;r=E,g=v,E+=_,v+=H,(mt=t(this,Ut))==null||mt.push(b,y);const L=-H/G,N=_/G,Z=L*t(this,Vt),ct=N*t(this,Vt);return t(this,Mt).set(t(this,Mt).subarray(2,8),0),t(this,Mt).set([E+Z,v+ct],4),t(this,Mt).set(t(this,Mt).subarray(14,18),12),t(this,Mt).set([E-Z,v-ct],16),isNaN(t(this,Mt)[6])?(t(this,Ot).length===0&&(t(this,Mt).set([r+Z,g+ct],2),t(this,Ot).push(NaN,NaN,NaN,NaN,(r+Z-u)/h,(g+ct-a)/i),t(this,Mt).set([r-Z,g-ct],14),t(this,yt).push(NaN,NaN,NaN,NaN,(r-Z-u)/h,(g-ct-a)/i)),t(this,Mt).set([w,m,r,g,E,v],6),!this.isEmpty()):(t(this,Mt).set([w,m,r,g,E,v],6),Math.abs(Math.atan2(m-g,w-r)-Math.atan2(H,_))<Math.PI/2?([r,g,E,v]=t(this,Mt).subarray(2,6),t(this,Ot).push(NaN,NaN,NaN,NaN,((r+E)/2-u)/h,((g+v)/2-a)/i),[r,g,w,m]=t(this,Mt).subarray(14,18),t(this,yt).push(NaN,NaN,NaN,NaN,((w+r)/2-u)/h,((m+g)/2-a)/i),!0):([w,m,r,g,E,v]=t(this,Mt).subarray(0,6),t(this,Ot).push(((w+5*r)/6-u)/h,((m+5*g)/6-a)/i,((5*r+E)/6-u)/h,((5*g+v)/6-a)/i,((r+E)/2-u)/h,((g+v)/2-a)/i),[E,v,r,g,w,m]=t(this,Mt).subarray(12,18),t(this,yt).push(((w+5*r)/6-u)/h,((m+5*g)/6-a)/i,((5*r+E)/6-u)/h,((5*g+v)/6-a)/i,((r+E)/2-u)/h,((g+v)/2-a)/i),!0))}toSVGPath(){if(this.isEmpty())return"";const b=t(this,Ot),y=t(this,yt),u=t(this,Mt).subarray(4,6),a=t(this,Mt).subarray(16,18),[h,i,r,g]=t(this,ot),[E,v,k,U]=S(this,Ce,Kn).call(this);if(isNaN(t(this,Mt)[6])&&!this.isEmpty())return`M${(t(this,Mt)[2]-h)/r} ${(t(this,Mt)[3]-i)/g} L${(t(this,Mt)[4]-h)/r} ${(t(this,Mt)[5]-i)/g} L${E} ${v} L${k} ${U} L${(t(this,Mt)[16]-h)/r} ${(t(this,Mt)[17]-i)/g} L${(t(this,Mt)[14]-h)/r} ${(t(this,Mt)[15]-i)/g} Z`;const F=[];F.push(`M${b[4]} ${b[5]}`);for(let G=6;G<b.length;G+=6)isNaN(b[G])?F.push(`L${b[G+4]} ${b[G+5]}`):F.push(`C${b[G]} ${b[G+1]} ${b[G+2]} ${b[G+3]} ${b[G+4]} ${b[G+5]}`);F.push(`L${(u[0]-h)/r} ${(u[1]-i)/g} L${E} ${v} L${k} ${U} L${(a[0]-h)/r} ${(a[1]-i)/g}`);for(let G=y.length-6;G>=6;G-=6)isNaN(y[G])?F.push(`L${y[G+4]} ${y[G+5]}`):F.push(`C${y[G]} ${y[G+1]} ${y[G+2]} ${y[G+3]} ${y[G+4]} ${y[G+5]}`);return F.push(`L${y[4]} ${y[5]} Z`),F.join(" ")}getOutlines(){var H;const b=t(this,Ot),y=t(this,yt),u=t(this,Mt),a=u.subarray(4,6),h=u.subarray(16,18),[i,r,g,E]=t(this,ot),v=new Float64Array((((H=t(this,Ut))==null?void 0:H.length)??0)+2);for(let w=0,m=v.length-2;w<m;w+=2)v[w]=(t(this,Ut)[w]-i)/g,v[w+1]=(t(this,Ut)[w+1]-r)/E;v[v.length-2]=(t(this,Bt)-i)/g,v[v.length-1]=(t(this,jt)-r)/E;const[k,U,F,G]=S(this,Ce,Kn).call(this);if(isNaN(u[6])&&!this.isEmpty()){const w=new Float64Array(36);return w.set([NaN,NaN,NaN,NaN,(u[2]-i)/g,(u[3]-r)/E,NaN,NaN,NaN,NaN,(u[4]-i)/g,(u[5]-r)/E,NaN,NaN,NaN,NaN,k,U,NaN,NaN,NaN,NaN,F,G,NaN,NaN,NaN,NaN,(u[16]-i)/g,(u[17]-r)/E,NaN,NaN,NaN,NaN,(u[14]-i)/g,(u[15]-r)/E],0),new X(w,v,t(this,ot),t(this,Tt),t(this,It),t(this,Et))}const p=new Float64Array(t(this,Ot).length+24+t(this,yt).length);let _=b.length;for(let w=0;w<_;w+=2){if(isNaN(b[w])){p[w]=p[w+1]=NaN;continue}p[w]=b[w],p[w+1]=b[w+1]}p.set([NaN,NaN,NaN,NaN,(a[0]-i)/g,(a[1]-r)/E,NaN,NaN,NaN,NaN,k,U,NaN,NaN,NaN,NaN,F,G,NaN,NaN,NaN,NaN,(h[0]-i)/g,(h[1]-r)/E],_),_+=24;for(let w=y.length-6;w>=6;w-=6)for(let m=0;m<6;m+=2){if(isNaN(y[w+m])){p[_]=p[_+1]=NaN,_+=2;continue}p[_]=y[w+m],p[_+1]=y[w+m+1],_+=2}return p.set([NaN,NaN,NaN,NaN,y[4],y[5]],_),new X(p,v,t(this,ot),t(this,Tt),t(this,It),t(this,Et))}};ot=new WeakMap,yt=new WeakMap,It=new WeakMap,Et=new WeakMap,Ot=new WeakMap,Mt=new WeakMap,Bt=new WeakMap,jt=new WeakMap,Jt=new WeakMap,ht=new WeakMap,Tt=new WeakMap,Vt=new WeakMap,Ut=new WeakMap,ee=new WeakMap,ne=new WeakMap,le=new WeakMap,Ce=new WeakSet,Kn=function(){const b=t(this,Mt).subarray(4,6),y=t(this,Mt).subarray(16,18),[u,a,h,i]=t(this,ot);return[(t(this,Bt)+(b[0]-y[0])/2-u)/h,(t(this,jt)+(b[1]-y[1])/2-a)/i,(t(this,Bt)+(y[0]-b[0])/2-u)/h,(t(this,jt)+(y[1]-b[1])/2-a)/i]},l(ve,ee,8),l(ve,ne,2),l(ve,le,t(ve,ee)+t(ve,ne));let gt=ve;class X extends I{constructor(y,u,a,h,i,r){super();l(this,J);l(this,n);l(this,f);l(this,be,void 0);l(this,Wt,null);l(this,oe,void 0);l(this,Me,void 0);l(this,re,void 0);l(this,Se,void 0);l(this,se,void 0);C(this,se,y),C(this,re,u),C(this,be,a),C(this,Se,h),C(this,oe,i),C(this,Me,r),S(this,f,ra).call(this,r);const{x:g,y:E,width:v,height:k}=t(this,Wt);for(let U=0,F=y.length;U<F;U+=2)y[U]=(y[U]-g)/v,y[U+1]=(y[U+1]-E)/k;for(let U=0,F=u.length;U<F;U+=2)u[U]=(u[U]-g)/v,u[U+1]=(u[U+1]-E)/k}toSVGPath(){const y=[`M${t(this,se)[4]} ${t(this,se)[5]}`];for(let u=6,a=t(this,se).length;u<a;u+=6){if(isNaN(t(this,se)[u])){y.push(`L${t(this,se)[u+4]} ${t(this,se)[u+5]}`);continue}y.push(`C${t(this,se)[u]} ${t(this,se)[u+1]} ${t(this,se)[u+2]} ${t(this,se)[u+3]} ${t(this,se)[u+4]} ${t(this,se)[u+5]}`)}return y.push("Z"),y.join(" ")}serialize([y,u,a,h],i){const r=a-y,g=h-u;let E,v;switch(i){case 0:E=S(this,J,Ai).call(this,t(this,se),y,h,r,-g),v=S(this,J,Ai).call(this,t(this,re),y,h,r,-g);break;case 90:E=S(this,n,yi).call(this,t(this,se),y,u,r,g),v=S(this,n,yi).call(this,t(this,re),y,u,r,g);break;case 180:E=S(this,J,Ai).call(this,t(this,se),a,u,-r,g),v=S(this,J,Ai).call(this,t(this,re),a,u,-r,g);break;case 270:E=S(this,n,yi).call(this,t(this,se),a,h,-r,-g),v=S(this,n,yi).call(this,t(this,re),a,h,-r,-g);break}return{outline:Array.from(E),points:[Array.from(v)]}}get box(){return t(this,Wt)}getNewOutline(y,u){const{x:a,y:h,width:i,height:r}=t(this,Wt),[g,E,v,k]=t(this,be),U=i*v,F=r*k,G=a*v+g,p=h*k+E,_=new gt({x:t(this,re)[0]*U+G,y:t(this,re)[1]*F+p},t(this,be),t(this,Se),y,t(this,Me),u??t(this,oe));for(let H=2;H<t(this,re).length;H+=2)_.add({x:t(this,re)[H]*U+G,y:t(this,re)[H+1]*F+p});return _.getOutlines()}}be=new WeakMap,Wt=new WeakMap,oe=new WeakMap,Me=new WeakMap,re=new WeakMap,Se=new WeakMap,se=new WeakMap,J=new WeakSet,Ai=function(y,u,a,h,i){const r=new Float64Array(y.length);for(let g=0,E=y.length;g<E;g+=2)r[g]=u+y[g]*h,r[g+1]=a+y[g+1]*i;return r},n=new WeakSet,yi=function(y,u,a,h,i){const r=new Float64Array(y.length);for(let g=0,E=y.length;g<E;g+=2)r[g]=u+y[g+1]*h,r[g+1]=a+y[g]*i;return r},f=new WeakSet,ra=function(y){const u=t(this,se);let a=u[4],h=u[5],i=a,r=h,g=a,E=h,v=a,k=h;const U=y?Math.max:Math.min;for(let H=6,w=u.length;H<w;H+=6){if(isNaN(u[H]))i=Math.min(i,u[H+4]),r=Math.min(r,u[H+5]),g=Math.max(g,u[H+4]),E=Math.max(E,u[H+5]),k<u[H+5]?(v=u[H+4],k=u[H+5]):k===u[H+5]&&(v=U(v,u[H+4]));else{const m=d.Util.bezierBoundingBox(a,h,...u.slice(H,H+6));i=Math.min(i,m[0]),r=Math.min(r,m[1]),g=Math.max(g,m[2]),E=Math.max(E,m[3]),k<m[3]?(v=m[2],k=m[3]):k===m[3]&&(v=U(v,m[2]))}a=u[H+4],h=u[H+5]}const F=i-t(this,oe),G=r-t(this,oe),p=g-i+2*t(this,oe),_=E-r+2*t(this,oe);C(this,Wt,{x:F,y:G,width:p,height:_,lastPoint:[v,k]})}},362:(Lt,_t,lt)=>{var Y,gt,X,B,D,aa,q,oa,K,ha,nt,tn,at,la,$,Xn,st,ot,yt,It,ca,Ot,da,Bt,ua;lt.d(_t,{EditorToolbar:()=>et,HighlightToolbar:()=>I});var d=lt(419);const O=class O{constructor(ht){l(this,q);l(this,K);l(this,nt);l(this,at);l(this,$);l(this,Y,null);l(this,gt,null);l(this,X,void 0);l(this,B,null);C(this,X,ht)}render(){const ht=C(this,Y,document.createElement("div"));ht.className="editToolbar",ht.setAttribute("role","toolbar"),ht.addEventListener("contextmenu",d.noContextMenu),ht.addEventListener("pointerdown",S(O,D,aa));const Tt=C(this,B,document.createElement("div"));Tt.className="buttons",ht.append(Tt);const Vt=t(this,X).toolbarPosition;if(Vt){const{style:Ut}=ht,ee=t(this,X)._uiManager.direction==="ltr"?1-Vt[0]:Vt[0];Ut.insetInlineEnd=`${100*ee}%`,Ut.top=`calc(${100*Vt[1]}% + var(--editor-toolbar-vert-offset))`}return S(this,at,la).call(this),ht}hide(){var ht;t(this,Y).classList.add("hidden"),(ht=t(this,gt))==null||ht.hideDropdown()}show(){t(this,Y).classList.remove("hidden")}addAltTextButton(ht){S(this,nt,tn).call(this,ht),t(this,B).prepend(ht,t(this,$,Xn))}addColorPicker(ht){C(this,gt,ht);const Tt=ht.renderButton();S(this,nt,tn).call(this,Tt),t(this,B).prepend(Tt,t(this,$,Xn))}remove(){var ht;t(this,Y).remove(),(ht=t(this,gt))==null||ht.destroy(),C(this,gt,null)}};Y=new WeakMap,gt=new WeakMap,X=new WeakMap,B=new WeakMap,D=new WeakSet,aa=function(ht){ht.stopPropagation()},q=new WeakSet,oa=function(ht){t(this,X)._focusEventsAllowed=!1,ht.preventDefault(),ht.stopPropagation()},K=new WeakSet,ha=function(ht){t(this,X)._focusEventsAllowed=!0,ht.preventDefault(),ht.stopPropagation()},nt=new WeakSet,tn=function(ht){ht.addEventListener("focusin",S(this,q,oa).bind(this),{capture:!0}),ht.addEventListener("focusout",S(this,K,ha).bind(this),{capture:!0}),ht.addEventListener("contextmenu",d.noContextMenu)},at=new WeakSet,la=function(){const ht=document.createElement("button");ht.className="delete",ht.tabIndex=0,ht.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,X).editorType}-button`),S(this,nt,tn).call(this,ht),ht.addEventListener("click",Tt=>{t(this,X)._uiManager.delete()}),t(this,B).append(ht)},$=new WeakSet,Xn=function(){const ht=document.createElement("div");return ht.className="divider",ht},l(O,D);let et=O;class I{constructor(ht){l(this,It);l(this,Ot);l(this,Bt);l(this,st,null);l(this,ot,null);l(this,yt,void 0);C(this,yt,ht)}show(ht,Tt,Vt){const[Ut,ee]=S(this,Ot,da).call(this,Tt,Vt),{style:ne}=t(this,ot)||C(this,ot,S(this,It,ca).call(this));ht.append(t(this,ot)),ne.insetInlineEnd=`${100*Ut}%`,ne.top=`calc(${100*ee}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,ot).remove()}}st=new WeakMap,ot=new WeakMap,yt=new WeakMap,It=new WeakSet,ca=function(){const ht=C(this,ot,document.createElement("div"));ht.className="editToolbar",ht.setAttribute("role","toolbar"),ht.addEventListener("contextmenu",d.noContextMenu);const Tt=C(this,st,document.createElement("div"));return Tt.className="buttons",ht.append(Tt),S(this,Bt,ua).call(this),ht},Ot=new WeakSet,da=function(ht,Tt){let Vt=0,Ut=0;for(const ee of ht){const ne=ee.y+ee.height;if(ne<Vt)continue;const le=ee.x+(Tt?ee.width:0);if(ne>Vt){Ut=le,Vt=ne;continue}Tt?le>Ut&&(Ut=le):le<Ut&&(Ut=le)}return[Tt?1-Ut:Ut,Vt]},Bt=new WeakSet,ua=function(){const ht=document.createElement("button");ht.className="highlightButton",ht.tabIndex=0,ht.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const Tt=document.createElement("span");ht.append(Tt),Tt.className="visuallyHidden",Tt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),ht.addEventListener("contextmenu",d.noContextMenu),ht.addEventListener("click",()=>{t(this,yt).highlightSelection("floating_button")}),t(this,st).append(ht)}},830:(Lt,_t,lt)=>{var K,W,nt,vt,at,Yn,V,O,st,ot,yt,pa,Ot,Mt,Bt,jt,Jt,ht,Tt,Vt,Ut,ee,ne,le,Ce,ge,ve,be,Wt,oe,Me,re,Se,se,J,s,n,c,f,o,A,b,y,u,a,h,i,r,g,E,v,k,U,F,G,p,_,H,en,m,ga,N,fa,ct,sn,St,ma,te,ba,Ae,va,Re,Jn,Pe,Qn,M,Zn,j,tr,dt,er,bt,Ye,Nt,ys,Kt,Aa,wt,ya,Yt,sr,he,wa,Te,wi,We,ir;lt.d(_t,{AnnotationEditorUIManager:()=>R,ColorManager:()=>q,KeyboardManager:()=>Q,bindEvents:()=>Y,opacityToHex:()=>gt});var d=lt(292),et=lt(419),I=lt(362);function Y(Ve,P,ut){for(const Rt of ut)P.addEventListener(Rt,Ve[Rt].bind(Ve))}function gt(Ve){return Math.round(Math.min(255,Math.max(1,255*Ve))).toString(16).padStart(2,"0")}class X{constructor(){l(this,K,0)}get id(){return`${d.AnnotationEditorPrefix}${us(this,K)._++}`}}K=new WeakMap;const $=class ${constructor(){l(this,at);l(this,W,(0,d.getUuid)());l(this,nt,0);l(this,vt,null)}static get _isSVGFittingCanvas(){const P='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',ut=new OffscreenCanvas(1,3).getContext("2d"),Rt=new Image;Rt.src=P;const Ft=Rt.decode().then(()=>(ut.drawImage(Rt,0,0,1,1,0,0,1,3),new Uint32Array(ut.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,d.shadow)(this,"_isSVGFittingCanvas",Ft)}async getFromFile(P){const{lastModified:ut,name:Rt,size:Ft,type:Xt}=P;return S(this,at,Yn).call(this,`${ut}_${Rt}_${Ft}_${Xt}`,P)}async getFromUrl(P){return S(this,at,Yn).call(this,P,P)}async getFromId(P){t(this,vt)||C(this,vt,new Map);const ut=t(this,vt).get(P);return ut?ut.bitmap?(ut.refCounter+=1,ut):ut.file?this.getFromFile(ut.file):this.getFromUrl(ut.url):null}getSvgUrl(P){const ut=t(this,vt).get(P);return ut!=null&&ut.isSvg?ut.svgUrl:null}deleteId(P){t(this,vt)||C(this,vt,new Map);const ut=t(this,vt).get(P);ut&&(ut.refCounter-=1,ut.refCounter===0&&(ut.bitmap=null))}isValidId(P){return P.startsWith(`image_${t(this,W)}_`)}};W=new WeakMap,nt=new WeakMap,vt=new WeakMap,at=new WeakSet,Yn=async function(P,ut){t(this,vt)||C(this,vt,new Map);let Rt=t(this,vt).get(P);if(Rt===null)return null;if(Rt!=null&&Rt.bitmap)return Rt.refCounter+=1,Rt;try{Rt||(Rt={bitmap:null,id:`image_${t(this,W)}_${us(this,nt)._++}`,refCounter:0,isSvg:!1});let Ft;if(typeof ut=="string"?(Rt.url=ut,Ft=await(0,et.fetchData)(ut,"blob")):Ft=Rt.file=ut,Ft.type==="image/svg+xml"){const Xt=$._isSVGFittingCanvas,Qt=new FileReader,ae=new Image,ye=new Promise((Ie,He)=>{ae.onload=()=>{Rt.bitmap=ae,Rt.isSvg=!0,Ie()},Qt.onload=async()=>{const Ke=Rt.svgUrl=Qt.result;ae.src=await Xt?`${Ke}#svgView(preserveAspectRatio(none))`:Ke},ae.onerror=Qt.onerror=He});Qt.readAsDataURL(Ft),await ye}else Rt.bitmap=await createImageBitmap(Ft);Rt.refCounter=1}catch(Ft){console.error(Ft),Rt=null}return t(this,vt).set(P,Rt),Rt&&t(this,vt).set(Rt.id,Rt),Rt};let B=$;class D{constructor(P=128){l(this,V,[]);l(this,O,!1);l(this,st,void 0);l(this,ot,-1);C(this,st,P)}add({cmd:P,undo:ut,post:Rt,mustExec:Ft,type:Xt=NaN,overwriteIfSameType:Qt=!1,keepUndo:ae=!1}){if(Ft&&P(),t(this,O))return;const ye={cmd:P,undo:ut,post:Rt,type:Xt};if(t(this,ot)===-1){t(this,V).length>0&&(t(this,V).length=0),C(this,ot,0),t(this,V).push(ye);return}if(Qt&&t(this,V)[t(this,ot)].type===Xt){ae&&(ye.undo=t(this,V)[t(this,ot)].undo),t(this,V)[t(this,ot)]=ye;return}const Ie=t(this,ot)+1;Ie===t(this,st)?t(this,V).splice(0,1):(C(this,ot,Ie),Ie<t(this,V).length&&t(this,V).splice(Ie)),t(this,V).push(ye)}undo(){if(t(this,ot)===-1)return;C(this,O,!0);const{undo:P,post:ut}=t(this,V)[t(this,ot)];P(),ut==null||ut(),C(this,O,!1),C(this,ot,t(this,ot)-1)}redo(){if(t(this,ot)<t(this,V).length-1){C(this,ot,t(this,ot)+1),C(this,O,!0);const{cmd:P,post:ut}=t(this,V)[t(this,ot)];P(),ut==null||ut(),C(this,O,!1)}}hasSomethingToUndo(){return t(this,ot)!==-1}hasSomethingToRedo(){return t(this,ot)<t(this,V).length-1}destroy(){C(this,V,null)}}V=new WeakMap,O=new WeakMap,st=new WeakMap,ot=new WeakMap;class Q{constructor(P){l(this,yt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ut}=d.FeatureTest.platform;for(const[Rt,Ft,Xt={}]of P)for(const Qt of Rt){const ae=Qt.startsWith("mac+");ut&&ae?(this.callbacks.set(Qt.slice(4),{callback:Ft,options:Xt}),this.allKeys.add(Qt.split("+").at(-1))):!ut&&!ae&&(this.callbacks.set(Qt,{callback:Ft,options:Xt}),this.allKeys.add(Qt.split("+").at(-1)))}}exec(P,ut){if(!this.allKeys.has(ut.key))return;const Rt=this.callbacks.get(S(this,yt,pa).call(this,ut));if(!Rt)return;const{callback:Ft,options:{bubbles:Xt=!1,args:Qt=[],checker:ae=null}}=Rt;ae&&!ae(P,ut)||(Ft.bind(P,...Qt,ut)(),Xt||(ut.stopPropagation(),ut.preventDefault()))}}yt=new WeakSet,pa=function(P){P.altKey&&this.buffer.push("alt"),P.ctrlKey&&this.buffer.push("ctrl"),P.metaKey&&this.buffer.push("meta"),P.shiftKey&&this.buffer.push("shift"),this.buffer.push(P.key);const ut=this.buffer.join("+");return this.buffer.length=0,ut};const Et=class Et{get _colors(){const P=new Map([["CanvasText",null],["Canvas",null]]);return(0,et.getColorValues)(P),(0,d.shadow)(this,"_colors",P)}convert(P){const ut=(0,et.getRGB)(P);if(!window.matchMedia("(forced-colors: active)").matches)return ut;for(const[Rt,Ft]of this._colors)if(Ft.every((Xt,Qt)=>Xt===ut[Qt]))return Et._colorsMapping.get(Rt);return ut}getHexCode(P){const ut=this._colors.get(P);return ut?d.Util.makeHexColor(...ut):P}};me(Et,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let q=Et;const Ze=class Ze{constructor(P,ut,Rt,Ft,Xt,Qt,ae,ye,Ie){l(this,H);l(this,m);l(this,N);l(this,ct);l(this,St);l(this,te);l(this,Ae);l(this,Re);l(this,Pe);l(this,M);l(this,j);l(this,dt);l(this,bt);l(this,Nt);l(this,Kt);l(this,wt);l(this,Yt);l(this,he);l(this,Te);l(this,We);l(this,Ot,null);l(this,Mt,new Map);l(this,Bt,new Map);l(this,jt,null);l(this,Jt,null);l(this,ht,new D);l(this,Tt,0);l(this,Vt,new Set);l(this,Ut,null);l(this,ee,null);l(this,ne,new Set);l(this,le,!1);l(this,Ce,null);l(this,ge,null);l(this,ve,null);l(this,be,!1);l(this,Wt,null);l(this,oe,new X);l(this,Me,!1);l(this,re,!1);l(this,Se,null);l(this,se,null);l(this,J,null);l(this,s,d.AnnotationEditorType.NONE);l(this,n,new Set);l(this,c,null);l(this,f,null);l(this,o,null);l(this,A,this.blur.bind(this));l(this,b,this.focus.bind(this));l(this,y,this.copy.bind(this));l(this,u,this.cut.bind(this));l(this,a,this.paste.bind(this));l(this,h,this.keydown.bind(this));l(this,i,this.keyup.bind(this));l(this,r,this.onEditingAction.bind(this));l(this,g,this.onPageChanging.bind(this));l(this,E,this.onScaleChanging.bind(this));l(this,v,S(this,N,fa).bind(this));l(this,k,this.onRotationChanging.bind(this));l(this,U,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});l(this,F,[0,0]);l(this,G,null);l(this,p,null);l(this,_,null);C(this,p,P),C(this,_,ut),C(this,jt,Rt),this._eventBus=Ft,this._eventBus._on("editingaction",t(this,r)),this._eventBus._on("pagechanging",t(this,g)),this._eventBus._on("scalechanging",t(this,E)),this._eventBus._on("rotationchanging",t(this,k)),S(this,St,ma).call(this),S(this,Pe,Qn).call(this),C(this,Jt,Xt.annotationStorage),C(this,Ce,Xt.filterFactory),C(this,f,Qt),C(this,ve,ae||null),C(this,le,ye),C(this,J,Ie||null),this.viewParameters={realScale:et.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const P=Ze.prototype,ut=Qt=>t(Qt,p).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Qt.hasSomethingToControl(),Rt=(Qt,{target:ae})=>{if(ae instanceof HTMLInputElement){const{type:ye}=ae;return ye!=="text"&&ye!=="number"}return!0},Ft=this.TRANSLATE_SMALL,Xt=this.TRANSLATE_BIG;return(0,d.shadow)(this,"_keyboardManager",new Q([[["ctrl+a","mac+meta+a"],P.selectAll,{checker:Rt}],[["ctrl+z","mac+meta+z"],P.undo,{checker:Rt}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],P.redo,{checker:Rt}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],P.delete,{checker:Rt}],[["Enter","mac+Enter"],P.addNewEditorFromKeyboard,{checker:(Qt,{target:ae})=>!(ae instanceof HTMLButtonElement)&&t(Qt,p).contains(ae)&&!Qt.isEnterHandled}],[[" ","mac+ "],P.addNewEditorFromKeyboard,{checker:(Qt,{target:ae})=>!(ae instanceof HTMLButtonElement)&&t(Qt,p).contains(document.activeElement)}],[["Escape","mac+Escape"],P.unselectAll],[["ArrowLeft","mac+ArrowLeft"],P.translateSelectedEditors,{args:[-Ft,0],checker:ut}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],P.translateSelectedEditors,{args:[-Xt,0],checker:ut}],[["ArrowRight","mac+ArrowRight"],P.translateSelectedEditors,{args:[Ft,0],checker:ut}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],P.translateSelectedEditors,{args:[Xt,0],checker:ut}],[["ArrowUp","mac+ArrowUp"],P.translateSelectedEditors,{args:[0,-Ft],checker:ut}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],P.translateSelectedEditors,{args:[0,-Xt],checker:ut}],[["ArrowDown","mac+ArrowDown"],P.translateSelectedEditors,{args:[0,Ft],checker:ut}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],P.translateSelectedEditors,{args:[0,Xt],checker:ut}]]))}destroy(){var P,ut;S(this,M,Zn).call(this),S(this,Re,Jn).call(this),this._eventBus._off("editingaction",t(this,r)),this._eventBus._off("pagechanging",t(this,g)),this._eventBus._off("scalechanging",t(this,E)),this._eventBus._off("rotationchanging",t(this,k));for(const Rt of t(this,Bt).values())Rt.destroy();t(this,Bt).clear(),t(this,Mt).clear(),t(this,ne).clear(),C(this,Ot,null),t(this,n).clear(),t(this,ht).destroy(),(P=t(this,jt))==null||P.destroy(),(ut=t(this,Wt))==null||ut.hide(),C(this,Wt,null),t(this,ge)&&(clearTimeout(t(this,ge)),C(this,ge,null)),t(this,G)&&(clearTimeout(t(this,G)),C(this,G,null)),S(this,te,ba).call(this)}async mlGuess(P){var ut;return((ut=t(this,J))==null?void 0:ut.guess(P))||null}get hasMLManager(){return!!t(this,J)}get hcmFilter(){return(0,d.shadow)(this,"hcmFilter",t(this,f)?t(this,Ce).addHCMFilter(t(this,f).foreground,t(this,f).background):"none")}get direction(){return(0,d.shadow)(this,"direction",getComputedStyle(t(this,p)).direction)}get highlightColors(){return(0,d.shadow)(this,"highlightColors",t(this,ve)?new Map(t(this,ve).split(",").map(P=>P.split("=").map(ut=>ut.trim()))):null)}get highlightColorNames(){return(0,d.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,P=>P.reverse())):null)}setMainHighlightColorPicker(P){C(this,se,P)}editAltText(P){var ut;(ut=t(this,jt))==null||ut.editAltText(this,P)}onPageChanging({pageNumber:P}){C(this,Tt,P-1)}focusMainContainer(){t(this,p).focus()}findParent(P,ut){for(const Rt of t(this,Bt).values()){const{x:Ft,y:Xt,width:Qt,height:ae}=Rt.div.getBoundingClientRect();if(P>=Ft&&P<=Ft+Qt&&ut>=Xt&&ut<=Xt+ae)return Rt}return null}disableUserSelect(P=!1){t(this,_).classList.toggle("noUserSelect",P)}addShouldRescale(P){t(this,ne).add(P)}removeShouldRescale(P){t(this,ne).delete(P)}onScaleChanging({scale:P}){this.commitOrRemove(),this.viewParameters.realScale=P*et.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ut of t(this,ne))ut.onScaleChanging()}onRotationChanging({pagesRotation:P}){this.commitOrRemove(),this.viewParameters.rotation=P}highlightSelection(P=""){const ut=document.getSelection();if(!ut||ut.isCollapsed)return;const{anchorNode:Rt,anchorOffset:Ft,focusNode:Xt,focusOffset:Qt}=ut,ae=ut.toString(),ye=S(this,H,en).call(this,ut).closest(".textLayer"),Ie=this.getSelectionBoxes(ye);if(Ie){ut.empty(),t(this,s)===d.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:d.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const He of t(this,Bt).values())if(He.hasTextLayer(ye)){He.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:P,boxes:Ie,anchorNode:Rt,anchorOffset:Ft,focusNode:Xt,focusOffset:Qt,text:ae});break}}}addToAnnotationStorage(P){!P.isEmpty()&&t(this,Jt)&&!t(this,Jt).has(P.id)&&t(this,Jt).setValue(P.id,P)}blur(){if(this.isShiftKeyDown=!1,t(this,be)&&(C(this,be,!1),S(this,ct,sn).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:P}=document;for(const ut of t(this,n))if(ut.div.contains(P)){C(this,Se,[ut,P]),ut._focusEventsAllowed=!1;break}}focus(){if(!t(this,Se))return;const[P,ut]=t(this,Se);C(this,Se,null),ut.addEventListener("focusin",()=>{P._focusEventsAllowed=!0},{once:!0}),ut.focus()}addEditListeners(){S(this,Pe,Qn).call(this),S(this,j,tr).call(this)}removeEditListeners(){S(this,M,Zn).call(this),S(this,dt,er).call(this)}copy(P){var Rt;if(P.preventDefault(),(Rt=t(this,Ot))==null||Rt.commitOrRemove(),!this.hasSelection)return;const ut=[];for(const Ft of t(this,n)){const Xt=Ft.serialize(!0);Xt&&ut.push(Xt)}ut.length!==0&&P.clipboardData.setData("application/pdfjs",JSON.stringify(ut))}cut(P){this.copy(P),this.delete()}paste(P){P.preventDefault();const{clipboardData:ut}=P;for(const Xt of ut.items)for(const Qt of t(this,ee))if(Qt.isHandlingMimeForPasting(Xt.type)){Qt.paste(Xt,this.currentLayer);return}let Rt=ut.getData("application/pdfjs");if(!Rt)return;try{Rt=JSON.parse(Rt)}catch(Xt){(0,d.warn)(`paste: "${Xt.message}".`);return}if(!Array.isArray(Rt))return;this.unselectAll();const Ft=this.currentLayer;try{const Xt=[];for(const ye of Rt){const Ie=Ft.deserialize(ye);if(!Ie)return;Xt.push(Ie)}const Qt=()=>{for(const ye of Xt)S(this,Yt,sr).call(this,ye);S(this,We,ir).call(this,Xt)},ae=()=>{for(const ye of Xt)ye.remove()};this.addCommands({cmd:Qt,undo:ae,mustExec:!0})}catch(Xt){(0,d.warn)(`paste: "${Xt.message}".`)}}keydown(P){!this.isShiftKeyDown&&P.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,s)!==d.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&Ze._keyboardManager.exec(this,P)}keyup(P){this.isShiftKeyDown&&P.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,be)&&(C(this,be,!1),S(this,ct,sn).call(this,"main_toolbar")))}onEditingAction({name:P}){switch(P){case"undo":case"redo":case"delete":case"selectAll":this[P]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(P){P?(S(this,Ae,va).call(this),S(this,j,tr).call(this),S(this,bt,Ye).call(this,{isEditing:t(this,s)!==d.AnnotationEditorType.NONE,isEmpty:S(this,Te,wi).call(this),hasSomethingToUndo:t(this,ht).hasSomethingToUndo(),hasSomethingToRedo:t(this,ht).hasSomethingToRedo(),hasSelectedEditor:!1})):(S(this,Re,Jn).call(this),S(this,dt,er).call(this),S(this,bt,Ye).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(P){if(!t(this,ee)){C(this,ee,P);for(const ut of t(this,ee))S(this,Nt,ys).call(this,ut.defaultPropertiesToUpdate)}}getId(){return t(this,oe).id}get currentLayer(){return t(this,Bt).get(t(this,Tt))}getLayer(P){return t(this,Bt).get(P)}get currentPageIndex(){return t(this,Tt)}addLayer(P){t(this,Bt).set(P.pageIndex,P),t(this,Me)?P.enable():P.disable()}removeLayer(P){t(this,Bt).delete(P.pageIndex)}updateMode(P,ut=null,Rt=!1){if(t(this,s)!==P){if(C(this,s,P),P===d.AnnotationEditorType.NONE){this.setEditingState(!1),S(this,wt,ya).call(this);return}this.setEditingState(!0),S(this,Kt,Aa).call(this),this.unselectAll();for(const Ft of t(this,Bt).values())Ft.updateMode(P);if(!ut&&Rt){this.addNewEditorFromKeyboard();return}if(ut){for(const Ft of t(this,Mt).values())if(Ft.annotationElementId===ut){this.setSelected(Ft),Ft.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(P){P!==t(this,s)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:P})}updateParams(P,ut){var Rt;if(t(this,ee)){switch(P){case d.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Rt=t(this,se))==null||Rt.updateColor(ut);break;case d.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,o)||C(this,o,new Map)).set(P,ut),this.showAllEditors("highlight",ut);break}for(const Ft of t(this,n))Ft.updateParams(P,ut);for(const Ft of t(this,ee))Ft.updateDefaultParams(P,ut)}}showAllEditors(P,ut,Rt=!1){var Ft;for(const Xt of t(this,Mt).values())Xt.editorType===P&&Xt.show(ut);(((Ft=t(this,o))==null?void 0:Ft.get(d.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==ut&&S(this,Nt,ys).call(this,[[d.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,ut]])}enableWaiting(P=!1){if(t(this,re)!==P){C(this,re,P);for(const ut of t(this,Bt).values())P?ut.disableClick():ut.enableClick(),ut.div.classList.toggle("waiting",P)}}getEditors(P){const ut=[];for(const Rt of t(this,Mt).values())Rt.pageIndex===P&&ut.push(Rt);return ut}getEditor(P){return t(this,Mt).get(P)}addEditor(P){t(this,Mt).set(P.id,P)}removeEditor(P){var ut;P.div.contains(document.activeElement)&&(t(this,ge)&&clearTimeout(t(this,ge)),C(this,ge,setTimeout(()=>{this.focusMainContainer(),C(this,ge,null)},0))),t(this,Mt).delete(P.id),this.unselect(P),(!P.annotationElementId||!t(this,Vt).has(P.annotationElementId))&&((ut=t(this,Jt))==null||ut.remove(P.id))}addDeletedAnnotationElement(P){t(this,Vt).add(P.annotationElementId),P.deleted=!0}isDeletedAnnotationElement(P){return t(this,Vt).has(P)}removeDeletedAnnotationElement(P){t(this,Vt).delete(P.annotationElementId),P.deleted=!1}setActiveEditor(P){t(this,Ot)!==P&&(C(this,Ot,P),P&&S(this,Nt,ys).call(this,P.propertiesToUpdate))}updateUI(P){t(this,he,wa)===P&&S(this,Nt,ys).call(this,P.propertiesToUpdate)}toggleSelected(P){if(t(this,n).has(P)){t(this,n).delete(P),P.unselect(),S(this,bt,Ye).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,n).add(P),P.select(),S(this,Nt,ys).call(this,P.propertiesToUpdate),S(this,bt,Ye).call(this,{hasSelectedEditor:!0})}setSelected(P){for(const ut of t(this,n))ut!==P&&ut.unselect();t(this,n).clear(),t(this,n).add(P),P.select(),S(this,Nt,ys).call(this,P.propertiesToUpdate),S(this,bt,Ye).call(this,{hasSelectedEditor:!0})}isSelected(P){return t(this,n).has(P)}get firstSelectedEditor(){return t(this,n).values().next().value}unselect(P){P.unselect(),t(this,n).delete(P),S(this,bt,Ye).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,n).size!==0}get isEnterHandled(){return t(this,n).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,ht).undo(),S(this,bt,Ye).call(this,{hasSomethingToUndo:t(this,ht).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:S(this,Te,wi).call(this)})}redo(){t(this,ht).redo(),S(this,bt,Ye).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,ht).hasSomethingToRedo(),isEmpty:S(this,Te,wi).call(this)})}addCommands(P){t(this,ht).add(P),S(this,bt,Ye).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:S(this,Te,wi).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const P=[...t(this,n)],ut=()=>{for(const Ft of P)Ft.remove()},Rt=()=>{for(const Ft of P)S(this,Yt,sr).call(this,Ft)};this.addCommands({cmd:ut,undo:Rt,mustExec:!0})}commitOrRemove(){var P;(P=t(this,Ot))==null||P.commitOrRemove()}hasSomethingToControl(){return t(this,Ot)||this.hasSelection}selectAll(){for(const P of t(this,n))P.commit();S(this,We,ir).call(this,t(this,Mt).values())}unselectAll(){if(!(t(this,Ot)&&(t(this,Ot).commitOrRemove(),t(this,s)!==d.AnnotationEditorType.NONE))&&this.hasSelection){for(const P of t(this,n))P.unselect();t(this,n).clear(),S(this,bt,Ye).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(P,ut,Rt=!1){if(Rt||this.commitOrRemove(),!this.hasSelection)return;t(this,F)[0]+=P,t(this,F)[1]+=ut;const[Ft,Xt]=t(this,F),Qt=[...t(this,n)];t(this,G)&&clearTimeout(t(this,G)),C(this,G,setTimeout(()=>{C(this,G,null),t(this,F)[0]=t(this,F)[1]=0,this.addCommands({cmd:()=>{for(const ye of Qt)t(this,Mt).has(ye.id)&&ye.translateInPage(Ft,Xt)},undo:()=>{for(const ye of Qt)t(this,Mt).has(ye.id)&&ye.translateInPage(-Ft,-Xt)},mustExec:!1})},1e3));for(const ye of Qt)ye.translateInPage(P,ut)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),C(this,Ut,new Map);for(const P of t(this,n))t(this,Ut).set(P,{savedX:P.x,savedY:P.y,savedPageIndex:P.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,Ut))return!1;this.disableUserSelect(!1);const P=t(this,Ut);C(this,Ut,null);let ut=!1;for(const[{x:Ft,y:Xt,pageIndex:Qt},ae]of P)ae.newX=Ft,ae.newY=Xt,ae.newPageIndex=Qt,ut||(ut=Ft!==ae.savedX||Xt!==ae.savedY||Qt!==ae.savedPageIndex);if(!ut)return!1;const Rt=(Ft,Xt,Qt,ae)=>{if(t(this,Mt).has(Ft.id)){const ye=t(this,Bt).get(ae);ye?Ft._setParentAndPosition(ye,Xt,Qt):(Ft.pageIndex=ae,Ft.x=Xt,Ft.y=Qt)}};return this.addCommands({cmd:()=>{for(const[Ft,{newX:Xt,newY:Qt,newPageIndex:ae}]of P)Rt(Ft,Xt,Qt,ae)},undo:()=>{for(const[Ft,{savedX:Xt,savedY:Qt,savedPageIndex:ae}]of P)Rt(Ft,Xt,Qt,ae)},mustExec:!0}),!0}dragSelectedEditors(P,ut){if(t(this,Ut))for(const Rt of t(this,Ut).keys())Rt.drag(P,ut)}rebuild(P){if(P.parent===null){const ut=this.getLayer(P.pageIndex);ut?(ut.changeParent(P),ut.addOrRebuild(P)):(this.addEditor(P),this.addToAnnotationStorage(P),P.rebuild())}else P.parent.addOrRebuild(P)}get isEditorHandlingKeyboard(){var P;return((P=this.getActive())==null?void 0:P.shouldGetKeyboardEvents())||t(this,n).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(P){return t(this,Ot)===P}getActive(){return t(this,Ot)}getMode(){return t(this,s)}get imageManager(){return(0,d.shadow)(this,"imageManager",new B)}getSelectionBoxes(P){if(!P)return null;const ut=document.getSelection();for(let Ie=0,He=ut.rangeCount;Ie<He;Ie++)if(!P.contains(ut.getRangeAt(Ie).commonAncestorContainer))return null;const{x:Rt,y:Ft,width:Xt,height:Qt}=P.getBoundingClientRect();let ae;switch(P.getAttribute("data-main-rotation")){case"90":ae=(Ie,He,Ke,qe)=>({x:(He-Ft)/Qt,y:1-(Ie+Ke-Rt)/Xt,width:qe/Qt,height:Ke/Xt});break;case"180":ae=(Ie,He,Ke,qe)=>({x:1-(Ie+Ke-Rt)/Xt,y:1-(He+qe-Ft)/Qt,width:Ke/Xt,height:qe/Qt});break;case"270":ae=(Ie,He,Ke,qe)=>({x:1-(He+qe-Ft)/Qt,y:(Ie-Rt)/Xt,width:qe/Qt,height:Ke/Xt});break;default:ae=(Ie,He,Ke,qe)=>({x:(Ie-Rt)/Xt,y:(He-Ft)/Qt,width:Ke/Xt,height:qe/Qt});break}const ye=[];for(let Ie=0,He=ut.rangeCount;Ie<He;Ie++){const Ke=ut.getRangeAt(Ie);if(!Ke.collapsed)for(const{x:qe,y:Qa,width:_s,height:cr}of Ke.getClientRects())_s===0||cr===0||ye.push(ae(qe,Qa,_s,cr))}return ye.length===0?null:ye}};Ot=new WeakMap,Mt=new WeakMap,Bt=new WeakMap,jt=new WeakMap,Jt=new WeakMap,ht=new WeakMap,Tt=new WeakMap,Vt=new WeakMap,Ut=new WeakMap,ee=new WeakMap,ne=new WeakMap,le=new WeakMap,Ce=new WeakMap,ge=new WeakMap,ve=new WeakMap,be=new WeakMap,Wt=new WeakMap,oe=new WeakMap,Me=new WeakMap,re=new WeakMap,Se=new WeakMap,se=new WeakMap,J=new WeakMap,s=new WeakMap,n=new WeakMap,c=new WeakMap,f=new WeakMap,o=new WeakMap,A=new WeakMap,b=new WeakMap,y=new WeakMap,u=new WeakMap,a=new WeakMap,h=new WeakMap,i=new WeakMap,r=new WeakMap,g=new WeakMap,E=new WeakMap,v=new WeakMap,k=new WeakMap,U=new WeakMap,F=new WeakMap,G=new WeakMap,p=new WeakMap,_=new WeakMap,H=new WeakSet,en=function({anchorNode:P}){return P.nodeType===Node.TEXT_NODE?P.parentElement:P},m=new WeakSet,ga=function(){const P=document.getSelection();if(!P||P.isCollapsed)return;const ut=S(this,H,en).call(this,P).closest(".textLayer"),Rt=this.getSelectionBoxes(ut);Rt&&(t(this,Wt)||C(this,Wt,new I.HighlightToolbar(this)),t(this,Wt).show(ut,Rt,this.direction==="ltr"))},N=new WeakSet,fa=function(){var Rt,Ft,Xt;const P=document.getSelection();if(!P||P.isCollapsed){t(this,c)&&((Rt=t(this,Wt))==null||Rt.hide(),C(this,c,null),S(this,bt,Ye).call(this,{hasSelectedText:!1}));return}const{anchorNode:ut}=P;if(ut!==t(this,c)){if(!S(this,H,en).call(this,P).closest(".textLayer")){t(this,c)&&((Ft=t(this,Wt))==null||Ft.hide(),C(this,c,null),S(this,bt,Ye).call(this,{hasSelectedText:!1}));return}if((Xt=t(this,Wt))==null||Xt.hide(),C(this,c,ut),S(this,bt,Ye).call(this,{hasSelectedText:!0}),!(t(this,s)!==d.AnnotationEditorType.HIGHLIGHT&&t(this,s)!==d.AnnotationEditorType.NONE)&&(t(this,s)===d.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),C(this,be,this.isShiftKeyDown),!this.isShiftKeyDown)){const Qt=ae=>{ae.type==="pointerup"&&ae.button!==0||(window.removeEventListener("pointerup",Qt),window.removeEventListener("blur",Qt),ae.type==="pointerup"&&S(this,ct,sn).call(this,"main_toolbar"))};window.addEventListener("pointerup",Qt),window.addEventListener("blur",Qt)}}},ct=new WeakSet,sn=function(P=""){t(this,s)===d.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(P):t(this,le)&&S(this,m,ga).call(this)},St=new WeakSet,ma=function(){document.addEventListener("selectionchange",t(this,v))},te=new WeakSet,ba=function(){document.removeEventListener("selectionchange",t(this,v))},Ae=new WeakSet,va=function(){window.addEventListener("focus",t(this,b)),window.addEventListener("blur",t(this,A))},Re=new WeakSet,Jn=function(){window.removeEventListener("focus",t(this,b)),window.removeEventListener("blur",t(this,A))},Pe=new WeakSet,Qn=function(){window.addEventListener("keydown",t(this,h)),window.addEventListener("keyup",t(this,i))},M=new WeakSet,Zn=function(){window.removeEventListener("keydown",t(this,h)),window.removeEventListener("keyup",t(this,i))},j=new WeakSet,tr=function(){document.addEventListener("copy",t(this,y)),document.addEventListener("cut",t(this,u)),document.addEventListener("paste",t(this,a))},dt=new WeakSet,er=function(){document.removeEventListener("copy",t(this,y)),document.removeEventListener("cut",t(this,u)),document.removeEventListener("paste",t(this,a))},bt=new WeakSet,Ye=function(P){Object.entries(P).some(([ut,Rt])=>t(this,U)[ut]!==Rt)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,U),P)}),t(this,s)===d.AnnotationEditorType.HIGHLIGHT&&P.hasSelectedEditor===!1&&S(this,Nt,ys).call(this,[[d.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},Nt=new WeakSet,ys=function(P){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:P})},Kt=new WeakSet,Aa=function(){if(!t(this,Me)){C(this,Me,!0);for(const P of t(this,Bt).values())P.enable();for(const P of t(this,Mt).values())P.enable()}},wt=new WeakSet,ya=function(){if(this.unselectAll(),t(this,Me)){C(this,Me,!1);for(const P of t(this,Bt).values())P.disable();for(const P of t(this,Mt).values())P.disable()}},Yt=new WeakSet,sr=function(P){const ut=t(this,Bt).get(P.pageIndex);ut?ut.addOrRebuild(P):(this.addEditor(P),this.addToAnnotationStorage(P))},he=new WeakSet,wa=function(){let P=null;for(P of t(this,n));return P},Te=new WeakSet,wi=function(){if(t(this,Mt).size===0)return!0;if(t(this,Mt).size===1)for(const P of t(this,Mt).values())return P.isEmpty();return!1},We=new WeakSet,ir=function(P){for(const ut of t(this,n))ut.unselect();t(this,n).clear();for(const ut of P)ut.isEmpty()||(t(this,n).add(ut),ut.select());S(this,bt,Ye).call(this,{hasSelectedEditor:this.hasSelection})},me(Ze,"TRANSLATE_SMALL",1),me(Ze,"TRANSLATE_BIG",10);let R=Ze},94:(Lt,_t,lt)=>{lt.d(_t,{PDFFetchStream:()=>X});var d=lt(292),et=lt(490);function I(Q,q,R){return{method:"GET",headers:Q,signal:R.signal,mode:"cors",credentials:q?"include":"same-origin",redirect:"follow"}}function Y(Q){const q=new Headers;for(const R in Q){const K=Q[R];K!==void 0&&q.append(R,K)}return q}function gt(Q){return Q instanceof Uint8Array?Q.buffer:Q instanceof ArrayBuffer?Q:((0,d.warn)(`getArrayBuffer - unexpected data format: ${Q}`),new Uint8Array(Q).buffer)}class X{constructor(q){this.source=q,this.isHttp=/^https?:/i.test(q.url),this.httpHeaders=this.isHttp&&q.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var q;return((q=this._fullRequestReader)==null?void 0:q._loaded)??0}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new B(this),this._fullRequestReader}getRangeReader(q,R){if(R<=this._progressiveDataLength)return null;const K=new D(this,q,R);return this._rangeRequestReaders.push(K),K}cancelAllRequests(q){var R;(R=this._fullRequestReader)==null||R.cancel(q);for(const K of this._rangeRequestReaders.slice(0))K.cancel(q)}}class B{constructor(q){this._stream=q,this._reader=null,this._loaded=0,this._filename=null;const R=q.source;this._withCredentials=R.withCredentials||!1,this._contentLength=R.length,this._headersCapability=Promise.withResolvers(),this._disableRange=R.disableRange||!1,this._rangeChunkSize=R.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!R.disableStream,this._isRangeSupported=!R.disableRange,this._headers=Y(this._stream.httpHeaders);const K=R.url;fetch(K,I(this._headers,this._withCredentials,this._abortController)).then(W=>{if(!(0,et.validateResponseStatus)(W.status))throw(0,et.createResponseStatusError)(W.status,K);this._reader=W.body.getReader(),this._headersCapability.resolve();const nt=z=>W.headers.get(z),{allowRangeRequests:vt,suggestedLength:at}=(0,et.validateRangeRequestCapabilities)({getResponseHeader:nt,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=vt,this._contentLength=at||this._contentLength,this._filename=(0,et.extractFilenameFromHeader)(nt),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new d.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var K;await this._headersCapability.promise;const{value:q,done:R}=await this._reader.read();return R?{value:q,done:R}:(this._loaded+=q.byteLength,(K=this.onProgress)==null||K.call(this,{loaded:this._loaded,total:this._contentLength}),{value:gt(q),done:!1})}cancel(q){var R;(R=this._reader)==null||R.cancel(q),this._abortController.abort()}}class D{constructor(q,R,K){this._stream=q,this._reader=null,this._loaded=0;const W=q.source;this._withCredentials=W.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!W.disableStream,this._abortController=new AbortController,this._headers=Y(this._stream.httpHeaders),this._headers.append("Range",`bytes=${R}-${K-1}`);const nt=W.url;fetch(nt,I(this._headers,this._withCredentials,this._abortController)).then(vt=>{if(!(0,et.validateResponseStatus)(vt.status))throw(0,et.createResponseStatusError)(vt.status,nt);this._readCapability.resolve(),this._reader=vt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var K;await this._readCapability.promise;const{value:q,done:R}=await this._reader.read();return R?{value:q,done:R}:(this._loaded+=q.byteLength,(K=this.onProgress)==null||K.call(this,{loaded:this._loaded}),{value:gt(q),done:!1})}cancel(q){var R;(R=this._reader)==null||R.cancel(q),this._abortController.abort()}}},10:(Lt,_t,lt)=>{var Y;lt.d(_t,{FontFaceObject:()=>I,FontLoader:()=>et});var d=lt(292);class et{constructor({ownerDocument:X=globalThis.document,styleElement:B=null}){l(this,Y,new Set);this._document=X,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(X){this.nativeFontFaces.add(X),this._document.fonts.add(X)}removeNativeFontFace(X){this.nativeFontFaces.delete(X),this._document.fonts.delete(X)}insertRule(X){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const B=this.styleElement.sheet;B.insertRule(X,B.cssRules.length)}clear(){for(const X of this.nativeFontFaces)this._document.fonts.delete(X);this.nativeFontFaces.clear(),t(this,Y).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:X,_inspectFont:B}){if(!(!X||t(this,Y).has(X.loadedName))){if((0,d.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:D,src:Q,style:q}=X,R=new FontFace(D,Q,q);this.addNativeFontFace(R);try{await R.load(),t(this,Y).add(D),B==null||B(X)}catch{(0,d.warn)(`Cannot load system font: ${X.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(R)}return}(0,d.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(X){if(X.attached||X.missingFile&&!X.systemFontInfo)return;if(X.attached=!0,X.systemFontInfo){await this.loadSystemFont(X);return}if(this.isFontLoadingAPISupported){const D=X.createNativeFontFace();if(D){this.addNativeFontFace(D);try{await D.loaded}catch(Q){throw(0,d.warn)(`Failed to load font '${D.family}': '${Q}'.`),X.disableFontFace=!0,Q}}return}const B=X.createFontFaceRule();if(B){if(this.insertRule(B),this.isSyncFontLoadingSupported)return;await new Promise(D=>{const Q=this._queueLoadingCallback(D);this._prepareFontLoadEvent(X,Q)})}}get isFontLoadingAPISupported(){var B;const X=!!((B=this._document)!=null&&B.fonts);return(0,d.shadow)(this,"isFontLoadingAPISupported",X)}get isSyncFontLoadingSupported(){let X=!1;return(d.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(X=!0),(0,d.shadow)(this,"isSyncFontLoadingSupported",X)}_queueLoadingCallback(X){function B(){for((0,d.assert)(!Q.done,"completeRequest() cannot be called twice."),Q.done=!0;D.length>0&&D[0].done;){const q=D.shift();setTimeout(q.callback,0)}}const{loadingRequests:D}=this,Q={done:!1,complete:B,callback:X};return D.push(Q),Q}get _loadTestFont(){const X=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,d.shadow)(this,"_loadTestFont",X)}_prepareFontLoadEvent(X,B){function D(It,Et){return It.charCodeAt(Et)<<24|It.charCodeAt(Et+1)<<16|It.charCodeAt(Et+2)<<8|It.charCodeAt(Et+3)&255}function Q(It,Et,Ot,Mt){const Bt=It.substring(0,Et),jt=It.substring(Et+Ot);return Bt+Mt+jt}let q,R;const K=this._document.createElement("canvas");K.width=1,K.height=1;const W=K.getContext("2d");let nt=0;function vt(It,Et){if(++nt>30){(0,d.warn)("Load test font never loaded."),Et();return}if(W.font="30px "+It,W.fillText(".",0,20),W.getImageData(0,0,1,1).data[3]>0){Et();return}setTimeout(vt.bind(null,It,Et))}const at=`lt${Date.now()}${this.loadTestFontId++}`;let z=this._loadTestFont;z=Q(z,976,at.length,at);const $=16,V=1482184792;let O=D(z,$);for(q=0,R=at.length-3;q<R;q+=4)O=O-V+D(at,q)|0;q<at.length&&(O=O-V+D(at+"XXX",q)|0),z=Q(z,$,4,(0,d.string32)(O));const st=`url(data:font/opentype;base64,${btoa(z)});`,ot=`@font-face {font-family:"${at}";src:${st}}`;this.insertRule(ot);const yt=this._document.createElement("div");yt.style.visibility="hidden",yt.style.width=yt.style.height="10px",yt.style.position="absolute",yt.style.top=yt.style.left="0px";for(const It of[X.loadedName,at]){const Et=this._document.createElement("span");Et.textContent="Hi",Et.style.fontFamily=It,yt.append(Et)}this._document.body.append(yt),vt(at,()=>{yt.remove(),B.complete()})}}Y=new WeakMap;class I{constructor(X,{isEvalSupported:B=!0,disableFontFace:D=!1,ignoreErrors:Q=!1,inspectFont:q=null}){this.compiledGlyphs=Object.create(null);for(const R in X)this[R]=X[R];this.isEvalSupported=B!==!1,this.disableFontFace=D===!0,this.ignoreErrors=Q===!0,this._inspectFont=q}createNativeFontFace(){var B;if(!this.data||this.disableFontFace)return null;let X;if(!this.cssFontInfo)X=new FontFace(this.loadedName,this.data,{});else{const D={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(D.style=`oblique ${this.cssFontInfo.italicAngle}deg`),X=new FontFace(this.cssFontInfo.fontFamily,this.data,D)}return(B=this._inspectFont)==null||B.call(this,this),X}createFontFaceRule(){var Q;if(!this.data||this.disableFontFace)return null;const X=(0,d.bytesToString)(this.data),B=`url(data:${this.mimetype};base64,${btoa(X)});`;let D;if(!this.cssFontInfo)D=`@font-face {font-family:"${this.loadedName}";src:${B}}`;else{let q=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(q+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),D=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${q}src:${B}}`}return(Q=this._inspectFont)==null||Q.call(this,this,B),D}getPathGenerator(X,B){if(this.compiledGlyphs[B]!==void 0)return this.compiledGlyphs[B];let D;try{D=X.get(this.loadedName+"_path_"+B)}catch(Q){if(!this.ignoreErrors)throw Q;return(0,d.warn)(`getPathGenerator - ignoring character: "${Q}".`),this.compiledGlyphs[B]=function(q,R){}}if(this.isEvalSupported&&d.FeatureTest.isEvalSupported){const Q=[];for(const q of D){const R=q.args!==void 0?q.args.join(","):"";Q.push("c.",q.cmd,"(",R,`);
`)}return this.compiledGlyphs[B]=new Function("c","size",Q.join(""))}return this.compiledGlyphs[B]=function(Q,q){for(const R of D)R.cmd==="scale"&&(R.args=[q,-q]),Q[R.cmd].apply(Q,R.args)}}}},62:(Lt,_t,lt)=>{var I,Y;lt.d(_t,{Metadata:()=>et});var d=lt(292);class et{constructor({parsedData:X,rawData:B}){l(this,I,void 0);l(this,Y,void 0);C(this,I,X),C(this,Y,B)}getRaw(){return t(this,Y)}get(X){return t(this,I).get(X)??null}getAll(){return(0,d.objectFromMap)(t(this,I))}has(X){return t(this,I).has(X)}}I=new WeakMap,Y=new WeakMap},457:(Lt,_t,lt)=>{lt.d(_t,{PDFNetworkStream:()=>B});var d=lt(292),et=lt(490);const I=200,Y=206;function gt(q){const R=q.response;return typeof R!="string"?R:(0,d.stringToBytes)(R).buffer}class X{constructor(R,K={}){this.url=R,this.isHttp=/^https?:/i.test(R),this.httpHeaders=this.isHttp&&K.httpHeaders||Object.create(null),this.withCredentials=K.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(R,K,W){const nt={begin:R,end:K};for(const vt in W)nt[vt]=W[vt];return this.request(nt)}requestFull(R){return this.request(R)}request(R){const K=new XMLHttpRequest,W=this.currXhrId++,nt=this.pendingRequests[W]={xhr:K};K.open("GET",this.url),K.withCredentials=this.withCredentials;for(const vt in this.httpHeaders){const at=this.httpHeaders[vt];at!==void 0&&K.setRequestHeader(vt,at)}return this.isHttp&&"begin"in R&&"end"in R?(K.setRequestHeader("Range",`bytes=${R.begin}-${R.end-1}`),nt.expectedStatus=Y):nt.expectedStatus=I,K.responseType="arraybuffer",R.onError&&(K.onerror=function(vt){R.onError(K.status)}),K.onreadystatechange=this.onStateChange.bind(this,W),K.onprogress=this.onProgress.bind(this,W),nt.onHeadersReceived=R.onHeadersReceived,nt.onDone=R.onDone,nt.onError=R.onError,nt.onProgress=R.onProgress,K.send(null),W}onProgress(R,K){var nt;const W=this.pendingRequests[R];W&&((nt=W.onProgress)==null||nt.call(W,K))}onStateChange(R,K){var z,$,V;const W=this.pendingRequests[R];if(!W)return;const nt=W.xhr;if(nt.readyState>=2&&W.onHeadersReceived&&(W.onHeadersReceived(),delete W.onHeadersReceived),nt.readyState!==4||!(R in this.pendingRequests))return;if(delete this.pendingRequests[R],nt.status===0&&this.isHttp){(z=W.onError)==null||z.call(W,nt.status);return}const vt=nt.status||I;if(!(vt===I&&W.expectedStatus===Y)&&vt!==W.expectedStatus){($=W.onError)==null||$.call(W,nt.status);return}const at=gt(nt);if(vt===Y){const O=nt.getResponseHeader("Content-Range"),st=/bytes (\d+)-(\d+)\/(\d+)/.exec(O);W.onDone({begin:parseInt(st[1],10),chunk:at})}else at?W.onDone({begin:0,chunk:at}):(V=W.onError)==null||V.call(W,nt.status)}getRequestXhr(R){return this.pendingRequests[R].xhr}isPendingRequest(R){return R in this.pendingRequests}abortRequest(R){const K=this.pendingRequests[R].xhr;delete this.pendingRequests[R],K.abort()}}class B{constructor(R){this._source=R,this._manager=new X(R.url,{httpHeaders:R.httpHeaders,withCredentials:R.withCredentials}),this._rangeChunkSize=R.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(R){const K=this._rangeRequestReaders.indexOf(R);K>=0&&this._rangeRequestReaders.splice(K,1)}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new D(this._manager,this._source),this._fullRequestReader}getRangeReader(R,K){const W=new Q(this._manager,R,K);return W.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(W),W}cancelAllRequests(R){var K;(K=this._fullRequestReader)==null||K.cancel(R);for(const W of this._rangeRequestReaders.slice(0))W.cancel(R)}}class D{constructor(R,K){this._manager=R;const W={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=K.url,this._fullRequestId=R.requestFull(W),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=K.disableRange||!1,this._contentLength=K.length,this._rangeChunkSize=K.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const R=this._fullRequestId,K=this._manager.getRequestXhr(R),W=at=>K.getResponseHeader(at),{allowRangeRequests:nt,suggestedLength:vt}=(0,et.validateRangeRequestCapabilities)({getResponseHeader:W,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});nt&&(this._isRangeSupported=!0),this._contentLength=vt||this._contentLength,this._filename=(0,et.extractFilenameFromHeader)(W),this._isRangeSupported&&this._manager.abortRequest(R),this._headersReceivedCapability.resolve()}_onDone(R){if(R&&(this._requests.length>0?this._requests.shift().resolve({value:R.chunk,done:!1}):this._cachedChunks.push(R.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const K of this._requests)K.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(R){this._storedError=(0,et.createResponseStatusError)(R,this._url),this._headersReceivedCapability.reject(this._storedError);for(const K of this._requests)K.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(R){var K;(K=this.onProgress)==null||K.call(this,{loaded:R.loaded,total:R.lengthComputable?R.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const R=Promise.withResolvers();return this._requests.push(R),R.promise}cancel(R){this._done=!0,this._headersReceivedCapability.reject(R);for(const K of this._requests)K.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Q{constructor(R,K,W){this._manager=R;const nt={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=R.url,this._requestId=R.requestRange(K,W,nt),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var R;(R=this.onClosed)==null||R.call(this,this)}_onDone(R){const K=R.chunk;this._requests.length>0?this._requests.shift().resolve({value:K,done:!1}):this._queuedChunk=K,this._done=!0;for(const W of this._requests)W.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(R){this._storedError=(0,et.createResponseStatusError)(R,this._url);for(const K of this._requests)K.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(R){var K;this.isStreamingSupported||((K=this.onProgress)==null||K.call(this,{loaded:R.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const K=this._queuedChunk;return this._queuedChunk=null,{value:K,done:!1}}if(this._done)return{value:void 0,done:!0};const R=Promise.withResolvers();return this._requests.push(R),R.promise}cancel(R){this._done=!0;for(const K of this._requests)K.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(Lt,_t,lt)=>{lt.d(_t,{createResponseStatusError:()=>X,extractFilenameFromHeader:()=>gt,validateRangeRequestCapabilities:()=>Y,validateResponseStatus:()=>B});var d=lt(292);function et(D){let Q=!0,q=R("filename\\*","i").exec(D);if(q){q=q[1];let $=vt(q);return $=unescape($),$=at($),$=z($),W($)}if(q=nt(D),q){const $=z(q);return W($)}if(q=R("filename","i").exec(D),q){q=q[1];let $=vt(q);return $=z($),W($)}function R($,V){return new RegExp("(?:^|;)\\s*"+$+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',V)}function K($,V){if($){if(!/^[\x00-\xFF]+$/.test(V))return V;try{const O=new TextDecoder($,{fatal:!0}),st=(0,d.stringToBytes)(V);V=O.decode(st),Q=!1}catch{}}return V}function W($){return Q&&/[\x80-\xff]/.test($)&&($=K("utf-8",$),Q&&($=K("iso-8859-1",$))),$}function nt($){const V=[];let O;const st=R("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(O=st.exec($))!==null;){let[,yt,It,Et]=O;if(yt=parseInt(yt,10),yt in V){if(yt===0)break;continue}V[yt]=[It,Et]}const ot=[];for(let yt=0;yt<V.length&&yt in V;++yt){let[It,Et]=V[yt];Et=vt(Et),It&&(Et=unescape(Et),yt===0&&(Et=at(Et))),ot.push(Et)}return ot.join("")}function vt($){if($.startsWith('"')){const V=$.slice(1).split('\\"');for(let O=0;O<V.length;++O){const st=V[O].indexOf('"');st!==-1&&(V[O]=V[O].slice(0,st),V.length=O+1),V[O]=V[O].replaceAll(/\\(.)/g,"$1")}$=V.join('"')}return $}function at($){const V=$.indexOf("'");if(V===-1)return $;const O=$.slice(0,V),st=$.slice(V+1).replace(/^[^']*'/,"");return K(O,st)}function z($){return!$.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test($)?$:$.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(V,O,st,ot){if(st==="q"||st==="Q")return ot=ot.replaceAll("_"," "),ot=ot.replaceAll(/=([0-9a-fA-F]{2})/g,function(yt,It){return String.fromCharCode(parseInt(It,16))}),K(O,ot);try{ot=atob(ot)}catch{}return K(O,ot)})}return""}var I=lt(419);function Y({getResponseHeader:D,isHttp:Q,rangeChunkSize:q,disableRange:R}){const K={allowRangeRequests:!1,suggestedLength:void 0},W=parseInt(D("Content-Length"),10);return!Number.isInteger(W)||(K.suggestedLength=W,W<=2*q)||R||!Q||D("Accept-Ranges")!=="bytes"||(D("Content-Encoding")||"identity")!=="identity"||(K.allowRangeRequests=!0),K}function gt(D){const Q=D("Content-Disposition");if(Q){let q=et(Q);if(q.includes("%"))try{q=decodeURIComponent(q)}catch{}if((0,I.isPdfFile)(q))return q}return null}function X(D,Q){return D===404||D===0&&Q.startsWith("file:")?new d.MissingPDFException('Missing PDF "'+Q+'".'):new d.UnexpectedResponseException(`Unexpected server response (${D}) while retrieving PDF "${Q}".`,D)}function B(D){return D===200||D===206}},786:(Lt,_t,lt)=>{lt.a(Lt,async(d,et)=>{try{let gt=function(V){const O=q.parse(V);return O.protocol==="file:"||O.host?O:/^[a-z]:[/\\]/i.test(V)?q.parse(`file:///${V}`):(O.host||(O.protocol="file:"),O)},X=function(V,O){return{protocol:V.protocol,auth:V.auth,host:V.hostname,port:V.port,path:V.path,method:"GET",headers:O}};lt.d(_t,{PDFNodeStream:()=>K});var I=lt(292),Y=lt(490);let B,D,Q,q;I.isNodeJS&&(B=await ps(()=>import("./chunk.js"),[]),D=await ps(()=>import("./chunk.js"),[]),Q=await ps(()=>import("./chunk.js"),[]),q=await ps(()=>import("./chunk.js"),[]));const R=/^file:\/\/\/[a-zA-Z]:\//;class K{constructor(O){this.source=O,this.url=gt(O.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&O.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}getFullReader(){return(0,I.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new z(this):new vt(this),this._fullRequestReader}getRangeReader(O,st){if(st<=this._progressiveDataLength)return null;const ot=this.isFsUrl?new $(this,O,st):new at(this,O,st);return this._rangeRequestReaders.push(ot),ot}cancelAllRequests(O){var st;(st=this._fullRequestReader)==null||st.cancel(O);for(const ot of this._rangeRequestReaders.slice(0))ot.cancel(O)}}class W{constructor(O){this._url=O.url,this._done=!1,this._storedError=null,this.onProgress=null;const st=O.source;this._contentLength=st.length,this._loaded=0,this._filename=null,this._disableRange=st.disableRange||!1,this._rangeChunkSize=st.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!st.disableStream,this._isRangeSupported=!st.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const O=this._readableStream.read();return O===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=O.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(O).buffer,done:!1})}cancel(O){if(!this._readableStream){this._error(O);return}this._readableStream.destroy(O)}_error(O){this._storedError=O,this._readCapability.resolve()}_setReadableStream(O){this._readableStream=O,O.on("readable",()=>{this._readCapability.resolve()}),O.on("end",()=>{O.destroy(),this._done=!0,this._readCapability.resolve()}),O.on("error",st=>{this._error(st)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new I.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class nt{constructor(O){this._url=O.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const st=O.source;this._isStreamingSupported=!st.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const O=this._readableStream.read();return O===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=O.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded}),{value:new Uint8Array(O).buffer,done:!1})}cancel(O){if(!this._readableStream){this._error(O);return}this._readableStream.destroy(O)}_error(O){this._storedError=O,this._readCapability.resolve()}_setReadableStream(O){this._readableStream=O,O.on("readable",()=>{this._readCapability.resolve()}),O.on("end",()=>{O.destroy(),this._done=!0,this._readCapability.resolve()}),O.on("error",st=>{this._error(st)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class vt extends W{constructor(O){super(O);const st=ot=>{if(ot.statusCode===404){const Ot=new I.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ot,this._headersCapability.reject(Ot);return}this._headersCapability.resolve(),this._setReadableStream(ot);const yt=Ot=>this._readableStream.headers[Ot.toLowerCase()],{allowRangeRequests:It,suggestedLength:Et}=(0,Y.validateRangeRequestCapabilities)({getResponseHeader:yt,isHttp:O.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=It,this._contentLength=Et||this._contentLength,this._filename=(0,Y.extractFilenameFromHeader)(yt)};this._request=null,this._url.protocol==="http:"?this._request=D.request(X(this._url,O.httpHeaders),st):this._request=Q.request(X(this._url,O.httpHeaders),st),this._request.on("error",ot=>{this._storedError=ot,this._headersCapability.reject(ot)}),this._request.end()}}class at extends nt{constructor(O,st,ot){super(O),this._httpHeaders={};for(const It in O.httpHeaders){const Et=O.httpHeaders[It];Et!==void 0&&(this._httpHeaders[It]=Et)}this._httpHeaders.Range=`bytes=${st}-${ot-1}`;const yt=It=>{if(It.statusCode===404){const Et=new I.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Et;return}this._setReadableStream(It)};this._request=null,this._url.protocol==="http:"?this._request=D.request(X(this._url,this._httpHeaders),yt):this._request=Q.request(X(this._url,this._httpHeaders),yt),this._request.on("error",It=>{this._storedError=It}),this._request.end()}}class z extends W{constructor(O){super(O);let st=decodeURIComponent(this._url.path);R.test(this._url.href)&&(st=st.replace(/^\//,"")),B.promises.lstat(st).then(ot=>{this._contentLength=ot.size,this._setReadableStream(B.createReadStream(st)),this._headersCapability.resolve()},ot=>{ot.code==="ENOENT"&&(ot=new I.MissingPDFException(`Missing PDF "${st}".`)),this._storedError=ot,this._headersCapability.reject(ot)})}}class $ extends nt{constructor(O,st,ot){super(O);let yt=decodeURIComponent(this._url.path);R.test(this._url.href)&&(yt=yt.replace(/^\//,"")),this._setReadableStream(B.createReadStream(yt,{start:st,end:ot-1}))}}et()}catch(gt){et(gt)}},1)},573:(Lt,_t,lt)=>{lt.a(Lt,async(d,et)=>{try{lt.d(_t,{NodeCMapReaderFactory:()=>R,NodeCanvasFactory:()=>q,NodeFilterFactory:()=>Q,NodeStandardFontDataFactory:()=>K});var I=lt(583),Y=lt(292);let gt,X,B;if(Y.isNodeJS){gt=await ps(()=>import("./chunk.js"),[]);try{X=await ps(()=>import("./chunk.js"),[])}catch{}try{B=await ps(()=>import("./chunk2.js"),[])}catch{}}const D=function(W){return gt.promises.readFile(W).then(nt=>new Uint8Array(nt))};class Q extends I.BaseFilterFactory{}class q extends I.BaseCanvasFactory{_createCanvas(nt,vt){return X.createCanvas(nt,vt)}}class R extends I.BaseCMapReaderFactory{_fetchData(nt,vt){return D(nt).then(at=>({cMapData:at,compressionType:vt}))}}class K extends I.BaseStandardFontDataFactory{_fetchData(nt){return D(nt)}}et()}catch(gt){et(gt)}},1)},626:(Lt,_t,lt)=>{var X,B,D,Q,q,R,K,W,nt,nr;lt.d(_t,{OptionalContentConfig:()=>gt});var d=lt(292),et=lt(651);const I=Symbol("INTERNAL");class Y{constructor(z,{name:$,intent:V,usage:O}){l(this,X,!1);l(this,B,!1);l(this,D,!1);l(this,Q,!0);C(this,X,!!(z&d.RenderingIntentFlag.DISPLAY)),C(this,B,!!(z&d.RenderingIntentFlag.PRINT)),this.name=$,this.intent=V,this.usage=O}get visible(){if(t(this,D))return t(this,Q);if(!t(this,Q))return!1;const{print:z,view:$}=this.usage;return t(this,X)?($==null?void 0:$.viewState)!=="OFF":t(this,B)?(z==null?void 0:z.printState)!=="OFF":!0}_setVisible(z,$,V=!1){z!==I&&(0,d.unreachable)("Internal method `_setVisible` called."),C(this,D,V),C(this,Q,$)}}X=new WeakMap,B=new WeakMap,D=new WeakMap,Q=new WeakMap;class gt{constructor(z,$=d.RenderingIntentFlag.DISPLAY){l(this,nt);l(this,q,null);l(this,R,new Map);l(this,K,null);l(this,W,null);if(this.renderingIntent=$,this.name=null,this.creator=null,z!==null){this.name=z.name,this.creator=z.creator,C(this,W,z.order);for(const V of z.groups)t(this,R).set(V.id,new Y($,V));if(z.baseState==="OFF")for(const V of t(this,R).values())V._setVisible(I,!1);for(const V of z.on)t(this,R).get(V)._setVisible(I,!0);for(const V of z.off)t(this,R).get(V)._setVisible(I,!1);C(this,K,this.getHash())}}isVisible(z){if(t(this,R).size===0)return!0;if(!z)return(0,d.info)("Optional content group not defined."),!0;if(z.type==="OCG")return t(this,R).has(z.id)?t(this,R).get(z.id).visible:((0,d.warn)(`Optional content group not found: ${z.id}`),!0);if(z.type==="OCMD"){if(z.expression)return S(this,nt,nr).call(this,z.expression);if(!z.policy||z.policy==="AnyOn"){for(const $ of z.ids){if(!t(this,R).has($))return(0,d.warn)(`Optional content group not found: ${$}`),!0;if(t(this,R).get($).visible)return!0}return!1}else if(z.policy==="AllOn"){for(const $ of z.ids){if(!t(this,R).has($))return(0,d.warn)(`Optional content group not found: ${$}`),!0;if(!t(this,R).get($).visible)return!1}return!0}else if(z.policy==="AnyOff"){for(const $ of z.ids){if(!t(this,R).has($))return(0,d.warn)(`Optional content group not found: ${$}`),!0;if(!t(this,R).get($).visible)return!0}return!1}else if(z.policy==="AllOff"){for(const $ of z.ids){if(!t(this,R).has($))return(0,d.warn)(`Optional content group not found: ${$}`),!0;if(t(this,R).get($).visible)return!1}return!0}return(0,d.warn)(`Unknown optional content policy ${z.policy}.`),!0}return(0,d.warn)(`Unknown group type ${z.type}.`),!0}setVisibility(z,$=!0){const V=t(this,R).get(z);if(!V){(0,d.warn)(`Optional content group not found: ${z}`);return}V._setVisible(I,!!$,!0),C(this,q,null)}setOCGState({state:z,preserveRB:$}){let V;for(const O of z){switch(O){case"ON":case"OFF":case"Toggle":V=O;continue}const st=t(this,R).get(O);if(st)switch(V){case"ON":st._setVisible(I,!0);break;case"OFF":st._setVisible(I,!1);break;case"Toggle":st._setVisible(I,!st.visible);break}}C(this,q,null)}get hasInitialVisibility(){return t(this,K)===null||this.getHash()===t(this,K)}getOrder(){return t(this,R).size?t(this,W)?t(this,W).slice():[...t(this,R).keys()]:null}getGroups(){return t(this,R).size>0?(0,d.objectFromMap)(t(this,R)):null}getGroup(z){return t(this,R).get(z)||null}getHash(){if(t(this,q)!==null)return t(this,q);const z=new et.MurmurHash3_64;for(const[$,V]of t(this,R))z.update(`${$}:${V.visible}`);return C(this,q,z.hexdigest())}}q=new WeakMap,R=new WeakMap,K=new WeakMap,W=new WeakMap,nt=new WeakSet,nr=function(z){const $=z.length;if($<2)return!0;const V=z[0];for(let O=1;O<$;O++){const st=z[O];let ot;if(Array.isArray(st))ot=S(this,nt,nr).call(this,st);else if(t(this,R).has(st))ot=t(this,R).get(st).visible;else return(0,d.warn)(`Optional content group not found: ${st}`),!0;switch(V){case"And":if(!ot)return!1;break;case"Or":if(ot)return!0;break;case"Not":return!ot;default:return!0}}return V==="And"}},814:(Lt,_t,lt)=>{lt.d(_t,{cleanupTextLayer:()=>Q,renderTextLayer:()=>vt,updateTextLayer:()=>at});var d=lt(292),et=lt(419);const I=1e5,Y=30,gt=.8,X=new Map;let B=null;function D(){if(!B){const z=document.createElement("canvas");z.className="hiddenCanvasElement",document.body.append(z),B=z.getContext("2d",{alpha:!1})}return B}function Q(){B==null||B.canvas.remove(),B=null}function q(z){const $=X.get(z);if($)return $;const V=D(),O=V.font;V.canvas.width=V.canvas.height=Y,V.font=`${Y}px ${z}`;const st=V.measureText("");let ot=st.fontBoundingBoxAscent,yt=Math.abs(st.fontBoundingBoxDescent);if(ot){const Et=ot/(ot+yt);return X.set(z,Et),V.canvas.width=V.canvas.height=0,V.font=O,Et}V.strokeStyle="red",V.clearRect(0,0,Y,Y),V.strokeText("g",0,0);let It=V.getImageData(0,0,Y,Y).data;yt=0;for(let Et=It.length-1-3;Et>=0;Et-=4)if(It[Et]>0){yt=Math.ceil(Et/4/Y);break}V.clearRect(0,0,Y,Y),V.strokeText("A",0,Y),It=V.getImageData(0,0,Y,Y).data,ot=0;for(let Et=0,Ot=It.length;Et<Ot;Et+=4)if(It[Et]>0){ot=Y-Math.floor(Et/4/Y);break}if(V.canvas.width=V.canvas.height=0,V.font=O,ot){const Et=ot/(ot+yt);return X.set(z,Et),Et}return X.set(z,gt),gt}function R(z,$,V){const O=document.createElement("span"),st={angle:0,canvasWidth:0,hasText:$.str!=="",hasEOL:$.hasEOL,fontSize:0};z._textDivs.push(O);const ot=d.Util.transform(z._transform,$.transform);let yt=Math.atan2(ot[1],ot[0]);const It=V[$.fontName];It.vertical&&(yt+=Math.PI/2);const Et=z._fontInspectorEnabled&&It.fontSubstitution||It.fontFamily,Ot=Math.hypot(ot[2],ot[3]),Mt=Ot*q(Et);let Bt,jt;yt===0?(Bt=ot[4],jt=ot[5]-Mt):(Bt=ot[4]+Mt*Math.sin(yt),jt=ot[5]-Mt*Math.cos(yt));const Jt="calc(var(--scale-factor)*",ht=O.style;z._container===z._rootContainer?(ht.left=`${(100*Bt/z._pageWidth).toFixed(2)}%`,ht.top=`${(100*jt/z._pageHeight).toFixed(2)}%`):(ht.left=`${Jt}${Bt.toFixed(2)}px)`,ht.top=`${Jt}${jt.toFixed(2)}px)`),ht.fontSize=`${Jt}${Ot.toFixed(2)}px)`,ht.fontFamily=Et,st.fontSize=Ot,O.setAttribute("role","presentation"),O.textContent=$.str,O.dir=$.dir,z._fontInspectorEnabled&&(O.dataset.fontName=It.fontSubstitutionLoadedName||$.fontName),yt!==0&&(st.angle=yt*(180/Math.PI));let Tt=!1;if($.str.length>1)Tt=!0;else if($.str!==" "&&$.transform[0]!==$.transform[3]){const Vt=Math.abs($.transform[0]),Ut=Math.abs($.transform[3]);Vt!==Ut&&Math.max(Vt,Ut)/Math.min(Vt,Ut)>1.5&&(Tt=!0)}Tt&&(st.canvasWidth=It.vertical?$.height:$.width),z._textDivProperties.set(O,st),z._isReadableStream&&z._layoutText(O)}function K(z){const{div:$,scale:V,properties:O,ctx:st,prevFontSize:ot,prevFontFamily:yt}=z,{style:It}=$;let Et="";if(O.canvasWidth!==0&&O.hasText){const{fontFamily:Ot}=It,{canvasWidth:Mt,fontSize:Bt}=O;(ot!==Bt||yt!==Ot)&&(st.font=`${Bt*V}px ${Ot}`,z.prevFontSize=Bt,z.prevFontFamily=Ot);const{width:jt}=st.measureText($.textContent);jt>0&&(Et=`scaleX(${Mt*V/jt})`)}O.angle!==0&&(Et=`rotate(${O.angle}deg) ${Et}`),Et.length>0&&(It.transform=Et)}function W(z){if(z._canceled)return;const $=z._textDivs,V=z._capability;if($.length>I){V.resolve();return}if(!z._isReadableStream)for(const O of $)z._layoutText(O);V.resolve()}class nt{constructor({textContentSource:$,container:V,viewport:O,textDivs:st,textDivProperties:ot,textContentItemsStr:yt}){var Bt;this._textContentSource=$,this._isReadableStream=$ instanceof ReadableStream,this._container=this._rootContainer=V,this._textDivs=st||[],this._textContentItemsStr=yt||[],this._fontInspectorEnabled=!!((Bt=globalThis.FontInspector)!=null&&Bt.enabled),this._reader=null,this._textDivProperties=ot||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:O.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:D()};const{pageWidth:It,pageHeight:Et,pageX:Ot,pageY:Mt}=O.rawDims;this._transform=[1,0,0,-1,-Ot,Mt+Et],this._pageWidth=It,this._pageHeight=Et,(0,et.setLayerDimensions)(V,O),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new d.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new d.AbortException("TextLayer task cancelled."))}_processItems($,V){for(const O of $){if(O.str===void 0){if(O.type==="beginMarkedContentProps"||O.type==="beginMarkedContent"){const st=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),O.id!==null&&this._container.setAttribute("id",`${O.id}`),st.append(this._container)}else O.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(O.str),R(this,O,V)}}_layoutText($){const V=this._layoutTextParams.properties=this._textDivProperties.get($);if(this._layoutTextParams.div=$,K(this._layoutTextParams),V.hasText&&this._container.append($),V.hasEOL){const O=document.createElement("br");O.setAttribute("role","presentation"),this._container.append(O)}}_render(){const{promise:$,resolve:V,reject:O}=Promise.withResolvers();let st=Object.create(null);if(this._isReadableStream){const ot=()=>{this._reader.read().then(({value:yt,done:It})=>{if(It){V();return}Object.assign(st,yt.styles),this._processItems(yt.items,st),ot()},O)};this._reader=this._textContentSource.getReader(),ot()}else if(this._textContentSource){const{items:ot,styles:yt}=this._textContentSource;this._processItems(ot,yt),V()}else throw new Error('No "textContentSource" parameter specified.');$.then(()=>{st=null,W(this)},this._capability.reject)}}function vt(z){const $=new nt(z);return $._render(),$}function at({container:z,viewport:$,textDivs:V,textDivProperties:O,mustRotate:st=!0,mustRescale:ot=!0}){if(st&&(0,et.setLayerDimensions)(z,{rotation:$.rotation}),ot){const yt=D(),It={prevFontSize:null,prevFontFamily:null,div:null,scale:$.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:yt};for(const Et of V)It.properties=O.get(Et),It.div=Et,K(It)}}},585:(Lt,_t,lt)=>{lt.d(_t,{PDFDataTransportStream:()=>I});var d=lt(292),et=lt(419);class I{constructor(B,{disableRange:D=!1,disableStream:Q=!1}){(0,d.assert)(B,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:q,initialData:R,progressiveDone:K,contentDispositionFilename:W}=B;if(this._queuedChunks=[],this._progressiveDone=K,this._contentDispositionFilename=W,(R==null?void 0:R.length)>0){const nt=R instanceof Uint8Array&&R.byteLength===R.buffer.byteLength?R.buffer:new Uint8Array(R).buffer;this._queuedChunks.push(nt)}this._pdfDataRangeTransport=B,this._isStreamingSupported=!Q,this._isRangeSupported=!D,this._contentLength=q,this._fullRequestReader=null,this._rangeReaders=[],B.addRangeListener((nt,vt)=>{this._onReceiveData({begin:nt,chunk:vt})}),B.addProgressListener((nt,vt)=>{this._onProgress({loaded:nt,total:vt})}),B.addProgressiveReadListener(nt=>{this._onReceiveData({chunk:nt})}),B.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),B.transportReady()}_onReceiveData({begin:B,chunk:D}){const Q=D instanceof Uint8Array&&D.byteLength===D.buffer.byteLength?D.buffer:new Uint8Array(D).buffer;if(B===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(Q):this._queuedChunks.push(Q);else{const q=this._rangeReaders.some(function(R){return R._begin!==B?!1:(R._enqueue(Q),!0)});(0,d.assert)(q,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var B;return((B=this._fullRequestReader)==null?void 0:B._loaded)??0}_onProgress(B){var D,Q,q,R;B.total===void 0?(Q=(D=this._rangeReaders[0])==null?void 0:D.onProgress)==null||Q.call(D,{loaded:B.loaded}):(R=(q=this._fullRequestReader)==null?void 0:q.onProgress)==null||R.call(q,{loaded:B.loaded,total:B.total})}_onProgressiveDone(){var B;(B=this._fullRequestReader)==null||B.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(B){const D=this._rangeReaders.indexOf(B);D>=0&&this._rangeReaders.splice(D,1)}getFullReader(){(0,d.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const B=this._queuedChunks;return this._queuedChunks=null,new Y(this,B,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(B,D){if(D<=this._progressiveDataLength)return null;const Q=new gt(this,B,D);return this._pdfDataRangeTransport.requestDataRange(B,D),this._rangeReaders.push(Q),Q}cancelAllRequests(B){var D;(D=this._fullRequestReader)==null||D.cancel(B);for(const Q of this._rangeReaders.slice(0))Q.cancel(B);this._pdfDataRangeTransport.abort()}}class Y{constructor(B,D,Q=!1,q=null){this._stream=B,this._done=Q||!1,this._filename=(0,et.isPdfFile)(q)?q:null,this._queuedChunks=D||[],this._loaded=0;for(const R of this._queuedChunks)this._loaded+=R.byteLength;this._requests=[],this._headersReady=Promise.resolve(),B._fullRequestReader=this,this.onProgress=null}_enqueue(B){this._done||(this._requests.length>0?this._requests.shift().resolve({value:B,done:!1}):this._queuedChunks.push(B),this._loaded+=B.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const B=Promise.withResolvers();return this._requests.push(B),B.promise}cancel(B){this._done=!0;for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class gt{constructor(B,D,Q){this._stream=B,this._begin=D,this._end=Q,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(B){if(!this._done){if(this._requests.length===0)this._queuedChunk=B;else{this._requests.shift().resolve({value:B,done:!1});for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const D=this._queuedChunk;return this._queuedChunk=null,{value:D,done:!1}}if(this._done)return{value:void 0,done:!0};const B=Promise.withResolvers();return this._requests.push(B),B.promise}cancel(B){this._done=!0;for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(Lt,_t,lt)=>{var et,I;lt.d(_t,{GlobalWorkerOptions:()=>d});class d{static get workerPort(){return t(this,et)}static set workerPort(gt){if(!(typeof Worker<"u"&&gt instanceof Worker)&&gt!==null)throw new Error("Invalid `workerPort` type.");C(this,et,gt)}static get workerSrc(){return t(this,I)}static set workerSrc(gt){if(typeof gt!="string")throw new Error("Invalid `workerSrc` type.");C(this,I,gt)}}et=new WeakMap,I=new WeakMap,l(d,et,null),l(d,I,"")},284:(Lt,_t,lt)=>{lt.d(_t,{XfaLayer:()=>et});var d=lt(50);class et{static setupStorage(Y,gt,X,B,D){const Q=B.getValue(gt,{value:null});switch(X.name){case"textarea":if(Q.value!==null&&(Y.textContent=Q.value),D==="print")break;Y.addEventListener("input",q=>{B.setValue(gt,{value:q.target.value})});break;case"input":if(X.attributes.type==="radio"||X.attributes.type==="checkbox"){if(Q.value===X.attributes.xfaOn?Y.setAttribute("checked",!0):Q.value===X.attributes.xfaOff&&Y.removeAttribute("checked"),D==="print")break;Y.addEventListener("change",q=>{B.setValue(gt,{value:q.target.checked?q.target.getAttribute("xfaOn"):q.target.getAttribute("xfaOff")})})}else{if(Q.value!==null&&Y.setAttribute("value",Q.value),D==="print")break;Y.addEventListener("input",q=>{B.setValue(gt,{value:q.target.value})})}break;case"select":if(Q.value!==null){Y.setAttribute("value",Q.value);for(const q of X.children)q.attributes.value===Q.value?q.attributes.selected=!0:q.attributes.hasOwnProperty("selected")&&delete q.attributes.selected}Y.addEventListener("input",q=>{const R=q.target.options,K=R.selectedIndex===-1?"":R[R.selectedIndex].value;B.setValue(gt,{value:K})});break}}static setAttributes({html:Y,element:gt,storage:X=null,intent:B,linkService:D}){const{attributes:Q}=gt,q=Y instanceof HTMLAnchorElement;Q.type==="radio"&&(Q.name=`${Q.name}-${B}`);for(const[R,K]of Object.entries(Q))if(K!=null)switch(R){case"class":K.length&&Y.setAttribute(R,K.join(" "));break;case"dataId":break;case"id":Y.setAttribute("data-element-id",K);break;case"style":Object.assign(Y.style,K);break;case"textContent":Y.textContent=K;break;default:(!q||R!=="href"&&R!=="newWindow")&&Y.setAttribute(R,K)}q&&D.addLinkAttributes(Y,Q.href,Q.newWindow),X&&Q.dataId&&this.setupStorage(Y,Q.dataId,gt,X)}static render(Y){var nt,vt;const gt=Y.annotationStorage,X=Y.linkService,B=Y.xfaHtml,D=Y.intent||"display",Q=document.createElement(B.name);B.attributes&&this.setAttributes({html:Q,element:B,intent:D,linkService:X});const q=D!=="richText",R=Y.div;if(R.append(Q),Y.viewport){const at=`matrix(${Y.viewport.transform.join(",")})`;R.style.transform=at}q&&R.setAttribute("class","xfaLayer xfaFont");const K=[];if(B.children.length===0){if(B.value){const at=document.createTextNode(B.value);Q.append(at),q&&d.XfaText.shouldBuildText(B.name)&&K.push(at)}return{textDivs:K}}const W=[[B,-1,Q]];for(;W.length>0;){const[at,z,$]=W.at(-1);if(z+1===at.children.length){W.pop();continue}const V=at.children[++W.at(-1)[1]];if(V===null)continue;const{name:O}=V;if(O==="#text"){const ot=document.createTextNode(V.value);K.push(ot),$.append(ot);continue}const st=(nt=V==null?void 0:V.attributes)!=null&&nt.xmlns?document.createElementNS(V.attributes.xmlns,O):document.createElement(O);if($.append(st),V.attributes&&this.setAttributes({html:st,element:V,storage:gt,intent:D,linkService:X}),((vt=V.children)==null?void 0:vt.length)>0)W.push([V,-1,st]);else if(V.value){const ot=document.createTextNode(V.value);q&&d.XfaText.shouldBuildText(O)&&K.push(ot),st.append(ot)}}for(const at of R.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))at.setAttribute("readOnly",!0);return{textDivs:K}}static update(Y){const gt=`matrix(${Y.viewport.transform.join(",")})`;Y.div.style.transform=gt,Y.div.hidden=!1}}},50:(Lt,_t,lt)=>{lt.d(_t,{XfaText:()=>d});class d{static textContent(I){const Y=[],gt={items:Y,styles:Object.create(null)};function X(B){var q;if(!B)return;let D=null;const Q=B.name;if(Q==="#text")D=B.value;else if(d.shouldBuildText(Q))(q=B==null?void 0:B.attributes)!=null&&q.textContent?D=B.attributes.textContent:B.value&&(D=B.value);else return;if(D!==null&&Y.push({str:D}),!!B.children)for(const R of B.children)X(R)}return X(I),gt}static shouldBuildText(I){return!(I==="textarea"||I==="input"||I==="option"||I==="select")}}},228:(Lt,_t,lt)=>{lt.a(Lt,async(d,et)=>{try{lt.d(_t,{AbortException:()=>I.AbortException,AnnotationEditorLayer:()=>B.AnnotationEditorLayer,AnnotationEditorParamsType:()=>I.AnnotationEditorParamsType,AnnotationEditorType:()=>I.AnnotationEditorType,AnnotationEditorUIManager:()=>D.AnnotationEditorUIManager,AnnotationLayer:()=>Q.AnnotationLayer,AnnotationMode:()=>I.AnnotationMode,CMapCompressionType:()=>I.CMapCompressionType,ColorPicker:()=>q.ColorPicker,DOMSVGFactory:()=>gt.DOMSVGFactory,DrawLayer:()=>R.DrawLayer,FeatureTest:()=>I.FeatureTest,GlobalWorkerOptions:()=>K.GlobalWorkerOptions,ImageKind:()=>I.ImageKind,InvalidPDFException:()=>I.InvalidPDFException,MissingPDFException:()=>I.MissingPDFException,OPS:()=>I.OPS,Outliner:()=>W.Outliner,PDFDataRangeTransport:()=>Y.PDFDataRangeTransport,PDFDateString:()=>gt.PDFDateString,PDFWorker:()=>Y.PDFWorker,PasswordResponses:()=>I.PasswordResponses,PermissionFlag:()=>I.PermissionFlag,PixelsPerInch:()=>gt.PixelsPerInch,RenderingCancelledException:()=>gt.RenderingCancelledException,UnexpectedResponseException:()=>I.UnexpectedResponseException,Util:()=>I.Util,VerbosityLevel:()=>I.VerbosityLevel,XfaLayer:()=>nt.XfaLayer,build:()=>Y.build,createValidAbsoluteUrl:()=>I.createValidAbsoluteUrl,fetchData:()=>gt.fetchData,getDocument:()=>Y.getDocument,getFilenameFromUrl:()=>gt.getFilenameFromUrl,getPdfFilenameFromUrl:()=>gt.getPdfFilenameFromUrl,getXfaPageViewport:()=>gt.getXfaPageViewport,isDataScheme:()=>gt.isDataScheme,isPdfFile:()=>gt.isPdfFile,noContextMenu:()=>gt.noContextMenu,normalizeUnicode:()=>I.normalizeUnicode,renderTextLayer:()=>X.renderTextLayer,setLayerDimensions:()=>gt.setLayerDimensions,shadow:()=>I.shadow,updateTextLayer:()=>X.updateTextLayer,version:()=>Y.version});var I=lt(292),Y=lt(831),gt=lt(419),X=lt(814),B=lt(731),D=lt(830),Q=lt(976),q=lt(259),R=lt(47),K=lt(164),W=lt(61),nt=lt(284),vt=d([Y]);Y=(vt.then?(await vt)():vt)[0];const at="4.1.392",z="fcb76a78d";et()}catch(at){et(at)}})},178:(Lt,_t,lt)=>{var X,xa,D,_a,q,nn;lt.d(_t,{MessageHandler:()=>gt});var d=lt(292);const et={UNKNOWN:0,DATA:1,ERROR:2},I={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Y(K){switch(K instanceof Error||typeof K=="object"&&K!==null||(0,d.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),K.name){case"AbortException":return new d.AbortException(K.message);case"MissingPDFException":return new d.MissingPDFException(K.message);case"PasswordException":return new d.PasswordException(K.message,K.code);case"UnexpectedResponseException":return new d.UnexpectedResponseException(K.message,K.status);case"UnknownErrorException":return new d.UnknownErrorException(K.message,K.details);default:return new d.UnknownErrorException(K.message,K.toString())}}class gt{constructor(W,nt,vt){l(this,X);l(this,D);l(this,q);this.sourceName=W,this.targetName=nt,this.comObj=vt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=at=>{const z=at.data;if(z.targetName!==this.sourceName)return;if(z.stream){S(this,D,_a).call(this,z);return}if(z.callback){const V=z.callbackId,O=this.callbackCapabilities[V];if(!O)throw new Error(`Cannot resolve callback ${V}`);if(delete this.callbackCapabilities[V],z.callback===et.DATA)O.resolve(z.data);else if(z.callback===et.ERROR)O.reject(Y(z.reason));else throw new Error("Unexpected callback case");return}const $=this.actionHandler[z.action];if(!$)throw new Error(`Unknown action from worker: ${z.action}`);if(z.callbackId){const V=this.sourceName,O=z.sourceName;new Promise(function(st){st($(z.data))}).then(function(st){vt.postMessage({sourceName:V,targetName:O,callback:et.DATA,callbackId:z.callbackId,data:st})},function(st){vt.postMessage({sourceName:V,targetName:O,callback:et.ERROR,callbackId:z.callbackId,reason:Y(st)})});return}if(z.streamId){S(this,X,xa).call(this,z);return}$(z.data)},vt.addEventListener("message",this._onComObjOnMessage)}on(W,nt){const vt=this.actionHandler;if(vt[W])throw new Error(`There is already an actionName called "${W}"`);vt[W]=nt}send(W,nt,vt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:W,data:nt},vt)}sendWithPromise(W,nt,vt){const at=this.callbackId++,z=Promise.withResolvers();this.callbackCapabilities[at]=z;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:W,callbackId:at,data:nt},vt)}catch($){z.reject($)}return z.promise}sendWithStream(W,nt,vt,at){const z=this.streamId++,$=this.sourceName,V=this.targetName,O=this.comObj;return new ReadableStream({start:st=>{const ot=Promise.withResolvers();return this.streamControllers[z]={controller:st,startCall:ot,pullCall:null,cancelCall:null,isClosed:!1},O.postMessage({sourceName:$,targetName:V,action:W,streamId:z,data:nt,desiredSize:st.desiredSize},at),ot.promise},pull:st=>{const ot=Promise.withResolvers();return this.streamControllers[z].pullCall=ot,O.postMessage({sourceName:$,targetName:V,stream:I.PULL,streamId:z,desiredSize:st.desiredSize}),ot.promise},cancel:st=>{(0,d.assert)(st instanceof Error,"cancel must have a valid reason");const ot=Promise.withResolvers();return this.streamControllers[z].cancelCall=ot,this.streamControllers[z].isClosed=!0,O.postMessage({sourceName:$,targetName:V,stream:I.CANCEL,streamId:z,reason:Y(st)}),ot.promise}},vt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}X=new WeakSet,xa=function(W){const nt=W.streamId,vt=this.sourceName,at=W.sourceName,z=this.comObj,$=this,V=this.actionHandler[W.action],O={enqueue(st,ot=1,yt){if(this.isCancelled)return;const It=this.desiredSize;this.desiredSize-=ot,It>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),z.postMessage({sourceName:vt,targetName:at,stream:I.ENQUEUE,streamId:nt,chunk:st},yt)},close(){this.isCancelled||(this.isCancelled=!0,z.postMessage({sourceName:vt,targetName:at,stream:I.CLOSE,streamId:nt}),delete $.streamSinks[nt])},error(st){(0,d.assert)(st instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,z.postMessage({sourceName:vt,targetName:at,stream:I.ERROR,streamId:nt,reason:Y(st)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:W.desiredSize,ready:null};O.sinkCapability.resolve(),O.ready=O.sinkCapability.promise,this.streamSinks[nt]=O,new Promise(function(st){st(V(W.data,O))}).then(function(){z.postMessage({sourceName:vt,targetName:at,stream:I.START_COMPLETE,streamId:nt,success:!0})},function(st){z.postMessage({sourceName:vt,targetName:at,stream:I.START_COMPLETE,streamId:nt,reason:Y(st)})})},D=new WeakSet,_a=function(W){const nt=W.streamId,vt=this.sourceName,at=W.sourceName,z=this.comObj,$=this.streamControllers[nt],V=this.streamSinks[nt];switch(W.stream){case I.START_COMPLETE:W.success?$.startCall.resolve():$.startCall.reject(Y(W.reason));break;case I.PULL_COMPLETE:W.success?$.pullCall.resolve():$.pullCall.reject(Y(W.reason));break;case I.PULL:if(!V){z.postMessage({sourceName:vt,targetName:at,stream:I.PULL_COMPLETE,streamId:nt,success:!0});break}V.desiredSize<=0&&W.desiredSize>0&&V.sinkCapability.resolve(),V.desiredSize=W.desiredSize,new Promise(function(O){var st;O((st=V.onPull)==null?void 0:st.call(V))}).then(function(){z.postMessage({sourceName:vt,targetName:at,stream:I.PULL_COMPLETE,streamId:nt,success:!0})},function(O){z.postMessage({sourceName:vt,targetName:at,stream:I.PULL_COMPLETE,streamId:nt,reason:Y(O)})});break;case I.ENQUEUE:if((0,d.assert)($,"enqueue should have stream controller"),$.isClosed)break;$.controller.enqueue(W.chunk);break;case I.CLOSE:if((0,d.assert)($,"close should have stream controller"),$.isClosed)break;$.isClosed=!0,$.controller.close(),S(this,q,nn).call(this,$,nt);break;case I.ERROR:(0,d.assert)($,"error should have stream controller"),$.controller.error(Y(W.reason)),S(this,q,nn).call(this,$,nt);break;case I.CANCEL_COMPLETE:W.success?$.cancelCall.resolve():$.cancelCall.reject(Y(W.reason)),S(this,q,nn).call(this,$,nt);break;case I.CANCEL:if(!V)break;new Promise(function(O){var st;O((st=V.onCancel)==null?void 0:st.call(V,Y(W.reason)))}).then(function(){z.postMessage({sourceName:vt,targetName:at,stream:I.CANCEL_COMPLETE,streamId:nt,success:!0})},function(O){z.postMessage({sourceName:vt,targetName:at,stream:I.CANCEL_COMPLETE,streamId:nt,reason:Y(O)})}),V.sinkCapability.reject(Y(W.reason)),V.isCancelled=!0,delete this.streamSinks[nt];break;default:throw new Error("Unexpected stream case")}},q=new WeakSet,nn=async function(W,nt){var vt,at,z;await Promise.allSettled([(vt=W.startCall)==null?void 0:vt.promise,(at=W.pullCall)==null?void 0:at.promise,(z=W.cancelCall)==null?void 0:z.promise]),delete this.streamControllers[nt]}},651:(Lt,_t,lt)=>{lt.d(_t,{MurmurHash3_64:()=>Y});const d=3285377520,et=4294901760,I=65535;class Y{constructor(X){this.h1=X?X&4294967295:d,this.h2=X?X&4294967295:d}update(X){let B,D;if(typeof X=="string"){B=new Uint8Array(X.length*2),D=0;for(let O=0,st=X.length;O<st;O++){const ot=X.charCodeAt(O);ot<=255?B[D++]=ot:(B[D++]=ot>>>8,B[D++]=ot&255)}}else if(ArrayBuffer.isView(X))B=X.slice(),D=B.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const Q=D>>2,q=D-Q*4,R=new Uint32Array(B.buffer,0,Q);let K=0,W=0,nt=this.h1,vt=this.h2;const at=3432918353,z=461845907,$=at&I,V=z&I;for(let O=0;O<Q;O++)O&1?(K=R[O],K=K*at&et|K*$&I,K=K<<15|K>>>17,K=K*z&et|K*V&I,nt^=K,nt=nt<<13|nt>>>19,nt=nt*5+3864292196):(W=R[O],W=W*at&et|W*$&I,W=W<<15|W>>>17,W=W*z&et|W*V&I,vt^=W,vt=vt<<13|vt>>>19,vt=vt*5+3864292196);switch(K=0,q){case 3:K^=B[Q*4+2]<<16;case 2:K^=B[Q*4+1]<<8;case 1:K^=B[Q*4],K=K*at&et|K*$&I,K=K<<15|K>>>17,K=K*z&et|K*V&I,Q&1?nt^=K:vt^=K}this.h1=nt,this.h2=vt}hexdigest(){let X=this.h1,B=this.h2;return X^=B>>>1,X=X*3981806797&et|X*36045&I,B=B*4283543511&et|((B<<16|X>>>16)*2950163797&et)>>>16,X^=B>>>1,X=X*444984403&et|X*60499&I,B=B*3301882366&et|((B<<16|X>>>16)*3120437893&et)>>>16,X^=B>>>1,(X>>>0).toString(16).padStart(8,"0")+(B>>>0).toString(16).padStart(8,"0")}}},292:(Lt,_t,lt)=>{var o,rn,b,rr;lt.d(_t,{AbortException:()=>le,AnnotationBorderStyleType:()=>vt,AnnotationEditorParamsType:()=>q,AnnotationEditorPrefix:()=>D,AnnotationEditorType:()=>Q,AnnotationMode:()=>B,AnnotationPrefix:()=>f,AnnotationType:()=>nt,BaseException:()=>Jt,CMapCompressionType:()=>z,FONT_IDENTITY_MATRIX:()=>I,FeatureTest:()=>Me,FormatError:()=>ne,IDENTITY_MATRIX:()=>et,ImageKind:()=>W,InvalidPDFException:()=>Vt,LINE_FACTOR:()=>gt,MAX_IMAGE_SIZE_TO_CACHE:()=>Y,MissingPDFException:()=>Ut,OPS:()=>$,PasswordException:()=>ht,PasswordResponses:()=>V,PermissionFlag:()=>R,RenderingIntentFlag:()=>X,TextRenderingMode:()=>K,UnexpectedResponseException:()=>ee,UnknownErrorException:()=>Tt,Util:()=>Se,VerbosityLevel:()=>at,assert:()=>Ot,bytesToString:()=>Ce,createValidAbsoluteUrl:()=>Bt,getUuid:()=>c,getVerbosityLevel:()=>ot,info:()=>yt,isNodeJS:()=>d,normalizeUnicode:()=>n,objectFromMap:()=>be,setVerbosityLevel:()=>st,shadow:()=>jt,string32:()=>ve,stringToBytes:()=>ge,unreachable:()=>Et,warn:()=>It});const d=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),et=[1,0,0,1,0,0],I=[.001,0,0,.001,0,0],Y=1e7,gt=1.35,X={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},B={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},D="pdfjs_internal_editor_",Q={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},q={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},R={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},K={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},W={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},nt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},vt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},at={ERRORS:0,WARNINGS:1,INFOS:5},z={NONE:0,BINARY:1},$={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},V={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let O=at.WARNINGS;function st(u){Number.isInteger(u)&&(O=u)}function ot(){return O}function yt(u){O>=at.INFOS&&console.log(`Info: ${u}`)}function It(u){O>=at.WARNINGS&&console.log(`Warning: ${u}`)}function Et(u){throw new Error(u)}function Ot(u,a){u||Et(a)}function Mt(u){switch(u==null?void 0:u.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Bt(u,a=null,h=null){var i;if(!u)return null;try{if(h&&typeof u=="string"&&(h.addDefaultProtocol&&u.startsWith("www.")&&((i=u.match(/\./g))==null?void 0:i.length)>=2&&(u=`http://${u}`),h.tryConvertEncoding))try{u=se(u)}catch{}const r=a?new URL(u,a):new URL(u);if(Mt(r))return r}catch{}return null}function jt(u,a,h,i=!1){return Object.defineProperty(u,a,{value:h,enumerable:!i,configurable:!0,writable:!1}),h}const Jt=function(){function u(a,h){this.constructor===u&&Et("Cannot initialize BaseException."),this.message=a,this.name=h}return u.prototype=new Error,u.constructor=u,u}();class ht extends Jt{constructor(a,h){super(a,"PasswordException"),this.code=h}}class Tt extends Jt{constructor(a,h){super(a,"UnknownErrorException"),this.details=h}}class Vt extends Jt{constructor(a){super(a,"InvalidPDFException")}}class Ut extends Jt{constructor(a){super(a,"MissingPDFException")}}class ee extends Jt{constructor(a,h){super(a,"UnexpectedResponseException"),this.status=h}}class ne extends Jt{constructor(a){super(a,"FormatError")}}class le extends Jt{constructor(a){super(a,"AbortException")}}function Ce(u){(typeof u!="object"||(u==null?void 0:u.length)===void 0)&&Et("Invalid argument for bytesToString");const a=u.length,h=8192;if(a<h)return String.fromCharCode.apply(null,u);const i=[];for(let r=0;r<a;r+=h){const g=Math.min(r+h,a),E=u.subarray(r,g);i.push(String.fromCharCode.apply(null,E))}return i.join("")}function ge(u){typeof u!="string"&&Et("Invalid argument for stringToBytes");const a=u.length,h=new Uint8Array(a);for(let i=0;i<a;++i)h[i]=u.charCodeAt(i)&255;return h}function ve(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function be(u){const a=Object.create(null);for(const[h,i]of u)a[h]=i;return a}function Wt(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function oe(){try{return new Function(""),!0}catch{return!1}}class Me{static get isLittleEndian(){return jt(this,"isLittleEndian",Wt())}static get isEvalSupported(){return jt(this,"isEvalSupported",oe())}static get isOffscreenCanvasSupported(){return jt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?jt(this,"platform",{isMac:navigator.platform.includes("Mac")}):jt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var a,h;return jt(this,"isCSSRoundSupported",(h=(a=globalThis.CSS)==null?void 0:a.supports)==null?void 0:h.call(a,"width: round(1.5px, 1px)"))}}const re=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class Se{static makeHexColor(a,h,i){return`#${re[a]}${re[h]}${re[i]}`}static scaleMinMax(a,h){let i;a[0]?(a[0]<0&&(i=h[0],h[0]=h[2],h[2]=i),h[0]*=a[0],h[2]*=a[0],a[3]<0&&(i=h[1],h[1]=h[3],h[3]=i),h[1]*=a[3],h[3]*=a[3]):(i=h[0],h[0]=h[1],h[1]=i,i=h[2],h[2]=h[3],h[3]=i,a[1]<0&&(i=h[1],h[1]=h[3],h[3]=i),h[1]*=a[1],h[3]*=a[1],a[2]<0&&(i=h[0],h[0]=h[2],h[2]=i),h[0]*=a[2],h[2]*=a[2]),h[0]+=a[4],h[1]+=a[5],h[2]+=a[4],h[3]+=a[5]}static transform(a,h){return[a[0]*h[0]+a[2]*h[1],a[1]*h[0]+a[3]*h[1],a[0]*h[2]+a[2]*h[3],a[1]*h[2]+a[3]*h[3],a[0]*h[4]+a[2]*h[5]+a[4],a[1]*h[4]+a[3]*h[5]+a[5]]}static applyTransform(a,h){const i=a[0]*h[0]+a[1]*h[2]+h[4],r=a[0]*h[1]+a[1]*h[3]+h[5];return[i,r]}static applyInverseTransform(a,h){const i=h[0]*h[3]-h[1]*h[2],r=(a[0]*h[3]-a[1]*h[2]+h[2]*h[5]-h[4]*h[3])/i,g=(-a[0]*h[1]+a[1]*h[0]+h[4]*h[1]-h[5]*h[0])/i;return[r,g]}static getAxialAlignedBoundingBox(a,h){const i=this.applyTransform(a,h),r=this.applyTransform(a.slice(2,4),h),g=this.applyTransform([a[0],a[3]],h),E=this.applyTransform([a[2],a[1]],h);return[Math.min(i[0],r[0],g[0],E[0]),Math.min(i[1],r[1],g[1],E[1]),Math.max(i[0],r[0],g[0],E[0]),Math.max(i[1],r[1],g[1],E[1])]}static inverseTransform(a){const h=a[0]*a[3]-a[1]*a[2];return[a[3]/h,-a[1]/h,-a[2]/h,a[0]/h,(a[2]*a[5]-a[4]*a[3])/h,(a[4]*a[1]-a[5]*a[0])/h]}static singularValueDecompose2dScale(a){const h=[a[0],a[2],a[1],a[3]],i=a[0]*h[0]+a[1]*h[2],r=a[0]*h[1]+a[1]*h[3],g=a[2]*h[0]+a[3]*h[2],E=a[2]*h[1]+a[3]*h[3],v=(i+E)/2,k=Math.sqrt((i+E)**2-4*(i*E-g*r))/2,U=v+k||1,F=v-k||1;return[Math.sqrt(U),Math.sqrt(F)]}static normalizeRect(a){const h=a.slice(0);return a[0]>a[2]&&(h[0]=a[2],h[2]=a[0]),a[1]>a[3]&&(h[1]=a[3],h[3]=a[1]),h}static intersect(a,h){const i=Math.max(Math.min(a[0],a[2]),Math.min(h[0],h[2])),r=Math.min(Math.max(a[0],a[2]),Math.max(h[0],h[2]));if(i>r)return null;const g=Math.max(Math.min(a[1],a[3]),Math.min(h[1],h[3])),E=Math.min(Math.max(a[1],a[3]),Math.max(h[1],h[3]));return g>E?null:[i,g,r,E]}static bezierBoundingBox(a,h,i,r,g,E,v,k,U){return U?(U[0]=Math.min(U[0],a,v),U[1]=Math.min(U[1],h,k),U[2]=Math.max(U[2],a,v),U[3]=Math.max(U[3],h,k)):U=[Math.min(a,v),Math.min(h,k),Math.max(a,v),Math.max(h,k)],S(this,b,rr).call(this,a,i,g,v,h,r,E,k,3*(-a+3*(i-g)+v),6*(a-2*i+g),3*(i-a),U),S(this,b,rr).call(this,a,i,g,v,h,r,E,k,3*(-h+3*(r-E)+k),6*(h-2*r+E),3*(r-h),U),U}}o=new WeakSet,rn=function(a,h,i,r,g,E,v,k,U,F){if(U<=0||U>=1)return;const G=1-U,p=U*U,_=p*U,H=G*(G*(G*a+3*U*h)+3*p*i)+_*r,w=G*(G*(G*g+3*U*E)+3*p*v)+_*k;F[0]=Math.min(F[0],H),F[1]=Math.min(F[1],w),F[2]=Math.max(F[2],H),F[3]=Math.max(F[3],w)},b=new WeakSet,rr=function(a,h,i,r,g,E,v,k,U,F,G,p){if(Math.abs(U)<1e-12){Math.abs(F)>=1e-12&&S(this,o,rn).call(this,a,h,i,r,g,E,v,k,-G/F,p);return}const _=F**2-4*G*U;if(_<0)return;const H=Math.sqrt(_),w=2*U;S(this,o,rn).call(this,a,h,i,r,g,E,v,k,(-F+H)/w,p),S(this,o,rn).call(this,a,h,i,r,g,E,v,k,(-F-H)/w,p)},l(Se,o),l(Se,b);function se(u){return decodeURIComponent(escape(u))}let J=null,s=null;function n(u){return J||(J=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,s=new Map([["\uFB05","\u017Ft"]])),u.replaceAll(J,(a,h,i)=>h?h.normalize("NFKC"):s.get(i))}function c(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const u=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(u);else for(let a=0;a<32;a++)u[a]=Math.floor(Math.random()*255);return Ce(u)}const f="pdfjs_internal_id_"}},or={};function xs(Lt){var _t=or[Lt];if(_t!==void 0)return _t.exports;var lt=or[Lt]={exports:{}};return Na[Lt](lt,lt.exports,xs),lt.exports}(()=>{var Lt=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",_t=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",lt=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=I=>{I&&I.d<1&&(I.d=1,I.forEach(Y=>Y.r--),I.forEach(Y=>Y.r--?Y.r++:Y()))},et=I=>I.map(Y=>{if(Y!==null&&typeof Y=="object"){if(Y[Lt])return Y;if(Y.then){var gt=[];gt.d=0,Y.then(D=>{X[_t]=D,d(gt)},D=>{X[lt]=D,d(gt)});var X={};return X[Lt]=D=>D(gt),X}}var B={};return B[Lt]=D=>{},B[_t]=Y,B});xs.a=(I,Y,gt)=>{var X;gt&&((X=[]).d=-1);var B=new Set,D=I.exports,Q,q,R,K=new Promise((W,nt)=>{R=nt,q=W});K[_t]=D,K[Lt]=W=>(X&&W(X),B.forEach(W),K.catch(nt=>{})),I.exports=K,Y(W=>{Q=et(W);var nt,vt=()=>Q.map(z=>{if(z[lt])throw z[lt];return z[_t]}),at=new Promise(z=>{nt=()=>z(vt),nt.r=0;var $=V=>V!==X&&!B.has(V)&&(B.add(V),V&&!V.d&&(nt.r++,V.push(nt)));Q.map(V=>V[Lt]($))});return nt.r?at:vt()},W=>(W?R(K[lt]=W):q(D),d(X))),X&&X.d<0&&(X.d=0)}})(),xs.d=(Lt,_t)=>{for(var lt in _t)xs.o(_t,lt)&&!xs.o(Lt,lt)&&Object.defineProperty(Lt,lt,{enumerable:!0,get:_t[lt]})},xs.o=(Lt,_t)=>Object.prototype.hasOwnProperty.call(Lt,_t);var ue=xs(228);ue=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=ue),ue.AbortException,ue.AnnotationEditorLayer,ue.AnnotationEditorParamsType,ue.AnnotationEditorType,ue.AnnotationEditorUIManager,ue.AnnotationLayer,ue.AnnotationMode,ue.CMapCompressionType,ue.ColorPicker,ue.DOMSVGFactory,ue.DrawLayer,ue.FeatureTest;var Ha=ue.GlobalWorkerOptions;ue.ImageKind,ue.InvalidPDFException,ue.MissingPDFException,ue.OPS,ue.Outliner,ue.PDFDataRangeTransport,ue.PDFDateString,ue.PDFWorker,ue.PasswordResponses,ue.PermissionFlag,ue.PixelsPerInch,ue.RenderingCancelledException,ue.UnexpectedResponseException,ue.Util,ue.VerbosityLevel,ue.XfaLayer,ue.build,ue.createValidAbsoluteUrl,ue.fetchData;var Ua=ue.getDocument;ue.getFilenameFromUrl,ue.getPdfFilenameFromUrl,ue.getXfaPageViewport,ue.isDataScheme,ue.isPdfFile,ue.noContextMenu,ue.normalizeUnicode,ue.renderTextLayer,ue.setLayerDimensions,ue.shadow,ue.updateTextLayer,ue.version;var za={exports:{}};(function(Lt,_t){(function(lt,d){Lt.exports=d()})(window,function(){return function(lt){var d={};function et(I){if(d[I])return d[I].exports;var Y=d[I]={i:I,l:!1,exports:{}};return lt[I].call(Y.exports,Y,Y.exports,et),Y.l=!0,Y.exports}return et.m=lt,et.c=d,et.d=function(I,Y,gt){et.o(I,Y)||Object.defineProperty(I,Y,{enumerable:!0,get:gt})},et.r=function(I){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},et.t=function(I,Y){if(1&Y&&(I=et(I)),8&Y||4&Y&&typeof I=="object"&&I&&I.__esModule)return I;var gt=Object.create(null);if(et.r(gt),Object.defineProperty(gt,"default",{enumerable:!0,value:I}),2&Y&&typeof I!="string")for(var X in I)et.d(gt,X,(function(B){return I[B]}).bind(null,X));return gt},et.n=function(I){var Y=I&&I.__esModule?function(){return I.default}:function(){return I};return et.d(Y,"a",Y),Y},et.o=function(I,Y){return Object.prototype.hasOwnProperty.call(I,Y)},et.p="",et(et.s=0)}([function(lt,d,et){et.r(d);var I,Y="fslightbox-",gt="".concat(Y,"styles"),X="".concat(Y,"cursor-grabbing"),B="".concat(Y,"full-dimension"),D="".concat(Y,"flex-centered"),Q="".concat(Y,"open"),q="".concat(Y,"transform-transition"),R="".concat(Y,"absoluted"),K="".concat(Y,"slide-btn"),W="".concat(K,"-container"),nt="".concat(Y,"fade-in"),vt="".concat(Y,"fade-out"),at=nt+"-strong",z=vt+"-strong",$="".concat(Y,"opacity-"),V="".concat($,"1"),O="".concat(Y,"source");function st(i){return(st=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(i)}function ot(i){var r=i.stageIndexes,g=i.core.stageManager,E=i.props.sources.length-1;g.getPreviousSlideIndex=function(){return r.current===0?E:r.current-1},g.getNextSlideIndex=function(){return r.current===E?0:r.current+1},g.updateStageIndexes=E===0?function(){}:E===1?function(){r.current===0?(r.next=1,delete r.previous):(r.previous=0,delete r.next)}:function(){r.previous=g.getPreviousSlideIndex(),r.next=g.getNextSlideIndex()},g.i=E<=2?function(){return!0}:function(v){var k=r.current;if(k===0&&v===E||k===E&&v===0)return!0;var U=k-v;return U===-1||U===0||U===1}}(typeof document>"u"?"undefined":st(document))==="object"&&((I=document.createElement("style")).className=gt,I.appendChild(document.createTextNode(".fslightbox-absoluted{position:absolute;top:0;left:0}.fslightbox-fade-in{animation:fslightbox-fade-in .3s cubic-bezier(0,0,.7,1)}.fslightbox-fade-out{animation:fslightbox-fade-out .3s ease}.fslightbox-fade-in-strong{animation:fslightbox-fade-in-strong .3s cubic-bezier(0,0,.7,1)}.fslightbox-fade-out-strong{animation:fslightbox-fade-out-strong .3s ease}@keyframes fslightbox-fade-in{from{opacity:.65}to{opacity:1}}@keyframes fslightbox-fade-out{from{opacity:.35}to{opacity:0}}@keyframes fslightbox-fade-in-strong{from{opacity:.3}to{opacity:1}}@keyframes fslightbox-fade-out-strong{from{opacity:1}to{opacity:0}}.fslightbox-cursor-grabbing{cursor:grabbing}.fslightbox-full-dimension{width:100%;height:100%}.fslightbox-open{overflow:hidden;height:100%}.fslightbox-flex-centered{display:flex;justify-content:center;align-items:center}.fslightbox-opacity-0{opacity:0!important}.fslightbox-opacity-1{opacity:1!important}.fslightbox-scrollbarfix{padding-right:17px}.fslightbox-transform-transition{transition:transform .3s}.fslightbox-container{font-family:Arial,sans-serif;position:fixed;top:0;left:0;background:linear-gradient(rgba(30,30,30,.9),#000 1810%);touch-action:pinch-zoom;z-index:1000000000;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.fslightbox-container *{box-sizing:border-box}.fslightbox-svg-path{transition:fill .15s ease;fill:#ddd}.fslightbox-nav{height:45px;width:100%;position:absolute;top:0;left:0}.fslightbox-slide-number-container{display:flex;justify-content:center;align-items:center;position:relative;height:100%;font-size:15px;color:#d7d7d7;z-index:0;max-width:55px;text-align:left}.fslightbox-slide-number-container .fslightbox-flex-centered{height:100%}.fslightbox-slash{display:block;margin:0 5px;width:1px;height:12px;transform:rotate(15deg);background:#fff}.fslightbox-toolbar{position:absolute;z-index:3;right:0;top:0;height:100%;display:flex;background:rgba(35,35,35,.65)}.fslightbox-toolbar-button{height:100%;width:45px;cursor:pointer}.fslightbox-toolbar-button:hover .fslightbox-svg-path{fill:#fff}.fslightbox-slide-btn-container{display:flex;align-items:center;padding:12px 12px 12px 6px;position:absolute;top:50%;cursor:pointer;z-index:3;transform:translateY(-50%)}@media (min-width:476px){.fslightbox-slide-btn-container{padding:22px 22px 22px 6px}}@media (min-width:768px){.fslightbox-slide-btn-container{padding:30px 30px 30px 6px}}.fslightbox-slide-btn-container:hover .fslightbox-svg-path{fill:#f1f1f1}.fslightbox-slide-btn{padding:9px;font-size:26px;background:rgba(35,35,35,.65)}@media (min-width:768px){.fslightbox-slide-btn{padding:10px}}@media (min-width:1600px){.fslightbox-slide-btn{padding:11px}}.fslightbox-slide-btn-container-previous{left:0}@media (max-width:475.99px){.fslightbox-slide-btn-container-previous{padding-left:3px}}.fslightbox-slide-btn-container-next{right:0;padding-left:12px;padding-right:3px}@media (min-width:476px){.fslightbox-slide-btn-container-next{padding-left:22px}}@media (min-width:768px){.fslightbox-slide-btn-container-next{padding-left:30px}}@media (min-width:476px){.fslightbox-slide-btn-container-next{padding-right:6px}}.fslightbox-down-event-detector{position:absolute;z-index:1}.fslightbox-slide-swiping-hoverer{z-index:4}.fslightbox-invalid-file-wrapper{font-size:22px;color:#eaebeb;margin:auto}.fslightbox-video{object-fit:cover}.fslightbox-youtube-iframe{border:0}.fslightboxl{display:block;margin:auto;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:67px;height:67px}.fslightboxl div{box-sizing:border-box;display:block;position:absolute;width:54px;height:54px;margin:6px;border:5px solid;border-color:#999 transparent transparent transparent;border-radius:50%;animation:fslightboxl 1.2s cubic-bezier(.5,0,.5,1) infinite}.fslightboxl div:nth-child(1){animation-delay:-.45s}.fslightboxl div:nth-child(2){animation-delay:-.3s}.fslightboxl div:nth-child(3){animation-delay:-.15s}@keyframes fslightboxl{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.fslightbox-source{position:relative;z-index:2;opacity:0}")),document.head.appendChild(I));function yt(i){var r,g=i.props,E=0,v={};this.getSourceTypeFromLocalStorageByUrl=function(U){return r[U]?r[U]:k(U)},this.handleReceivedSourceTypeForUrl=function(U,F){if(v[F]===!1&&(E--,U!=="invalid"?v[F]=U:delete v[F],E===0)){(function(G,p){for(var _ in p)G[_]=p[_]})(r,v);try{localStorage.setItem("fslightbox-types",JSON.stringify(r))}catch{}}};var k=function(U){E++,v[U]=!1};if(g.disableLocalStorage)this.getSourceTypeFromLocalStorageByUrl=function(){},this.handleReceivedSourceTypeForUrl=function(){};else{try{r=JSON.parse(localStorage.getItem("fslightbox-types"))}catch{}r||(r={},this.getSourceTypeFromLocalStorageByUrl=k)}}function It(i,r,g,E){var v=i.data,k=i.elements.sources,U=g/E,F=0;this.adjustSize=function(){if((F=v.maxSourceWidth/U)<v.maxSourceHeight)return g<v.maxSourceWidth&&(F=E),G();F=E>v.maxSourceHeight?v.maxSourceHeight:E,G()};var G=function(){k[r].style.width=F*U+"px",k[r].style.height=F+"px"}}function Et(i,r){var g=this,E=i.collections.sourceSizers,v=i.elements,k=v.sourceAnimationWrappers,U=v.sources,F=i.isl,G=i.resolve;function p(_,H){E[r]=G(It,[r,_,H]),E[r].adjustSize()}this.runActions=function(_,H){F[r]=!0,U[r].classList.add(V),k[r].classList.add(at),k[r].removeChild(k[r].firstChild),p(_,H),g.runActions=p}}function Ot(i,r){var g,E=this,v=i.elements.sources,k=i.props,U=(0,i.resolve)(Et,[r]);this.handleImageLoad=function(F){var G=F.target,p=G.naturalWidth,_=G.naturalHeight;U.runActions(p,_)},this.handleVideoLoad=function(F){var G=F.target,p=G.videoWidth,_=G.videoHeight;g=!0,U.runActions(p,_)},this.handleNotMetaDatedVideoLoad=function(){g||E.handleYoutubeLoad()},this.handleYoutubeLoad=function(){var F=1920,G=1080;k.maxYoutubeDimensions&&(F=k.maxYoutubeDimensions.width,G=k.maxYoutubeDimensions.height),U.runActions(F,G)},this.handleCustomLoad=function(){var F=v[r],G=F.offsetWidth,p=F.offsetHeight;G&&p?U.runActions(G,p):setTimeout(E.handleCustomLoad)}}function Mt(i,r,g){var E=i.elements.sources,v=i.props.customClasses,k=v[r]?v[r]:"";E[r].className=g+" "+k}function Bt(i,r){var g=i.elements.sources,E=i.props.customAttributes;for(var v in E[r])g[r].setAttribute(v,E[r][v])}function jt(i,r){var g=i.collections.sourceLoadHandlers,E=i.elements,v=E.sources,k=E.sourceAnimationWrappers,U=i.props.sources;v[r]=document.createElement("img"),Mt(i,r,O),v[r].src=U[r],v[r].onload=g[r].handleImageLoad,Bt(i,r),k[r].appendChild(v[r])}function Jt(i,r){var g=i.collections.sourceLoadHandlers,E=i.elements,v=E.sources,k=E.sourceAnimationWrappers,U=i.props,F=U.sources,G=U.videosPosters;v[r]=document.createElement("video"),Mt(i,r,O),v[r].src=F[r],v[r].onloadedmetadata=function(_){g[r].handleVideoLoad(_)},v[r].controls=!0,Bt(i,r),G[r]&&(v[r].poster=G[r]);var p=document.createElement("source");p.src=F[r],v[r].appendChild(p),setTimeout(g[r].handleNotMetaDatedVideoLoad,3e3),k[r].appendChild(v[r])}function ht(i,r){var g=i.collections.sourceLoadHandlers,E=i.elements,v=E.sources,k=E.sourceAnimationWrappers,U=i.props.sources;v[r]=document.createElement("iframe"),Mt(i,r,"".concat(O," ").concat(Y,"youtube-iframe"));var F=U[r],G=F.split("?")[1];v[r].src="https://www.youtube.com/embed/".concat(F.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/)[2],"?").concat(G||""),v[r].allowFullscreen=!0,Bt(i,r),k[r].appendChild(v[r]),g[r].handleYoutubeLoad()}function Tt(i,r){var g=i.collections.sourceLoadHandlers,E=i.elements,v=E.sources,k=E.sourceAnimationWrappers,U=i.props.sources;v[r]=U[r],Mt(i,r,"".concat(v[r].className," ").concat(O)),k[r].appendChild(v[r]),g[r].handleCustomLoad()}function Vt(i,r){var g=i.elements,E=g.sources,v=g.sourceAnimationWrappers;i.props.sources,E[r]=document.createElement("div"),E[r].className="".concat(Y,"invalid-file-wrapper ").concat(D),E[r].innerHTML="Invalid source",v[r].classList.add(at),v[r].removeChild(v[r].firstChild),v[r].appendChild(E[r])}function Ut(i){var r=i.collections,g=r.sourceLoadHandlers,E=r.sourcesRenderFunctions,v=i.core.sourceDisplayFacade,k=i.resolve;this.runActionsForSourceTypeAndIndex=function(U,F){var G;switch(U!=="invalid"&&(g[F]=k(Ot,[F])),U){case"image":G=jt;break;case"video":G=Jt;break;case"youtube":G=ht;break;case"custom":G=Tt;break;default:G=Vt}E[F]=function(){return G(i,F)},v.displaySourcesWhichShouldBeDisplayed()}}function ee(){var i,r,g,E={isUrlYoutubeOne:function(k){var U=document.createElement("a");return U.href=k,U.hostname==="www.youtube.com"||U.hostname==="youtu.be"},getTypeFromResponseContentType:function(k){return k.slice(0,k.indexOf("/"))}};function v(){if(g.readyState!==4){if(g.readyState===2){var k;switch(E.getTypeFromResponseContentType(g.getResponseHeader("content-type"))){case"image":k="image";break;case"video":k="video";break;default:k="invalid"}g.onreadystatechange=null,g.abort(),r(k)}}else r("invalid")}this.setUrlToCheck=function(k){i=k},this.getSourceType=function(k){if(E.isUrlYoutubeOne(i))return k("youtube");r=k,(g=new XMLHttpRequest).onreadystatechange=v,g.open("GET",i,!0),g.send()}}function ne(i,r,g){var E=i.props,v=E.types,k=E.type,U=E.sources,F=i.resolve;this.getTypeSetByClientForIndex=function(G){var p;return v&&v[G]?p=v[G]:k&&(p=k),p},this.retrieveTypeWithXhrForIndex=function(G){var p=F(ee);p.setUrlToCheck(U[G]),p.getSourceType(function(_){r.handleReceivedSourceTypeForUrl(_,U[G]),g.runActionsForSourceTypeAndIndex(_,G)})}}function le(i,r){var g=i.core.stageManager,E=i.elements,v=E.smw,k=E.sourceWrappersContainer,U=i.props,F=0,G=document.createElement("div");function p(H){G.style.transform="translateX(".concat(H+F,"px)"),F=0}function _(){return(1+U.slideDistance)*innerWidth}G.className="".concat(R," ").concat(B," ").concat(D),G.s=function(){G.style.display="flex"},G.h=function(){G.style.display="none"},G.a=function(){G.classList.add(q)},G.d=function(){G.classList.remove(q)},G.n=function(){G.style.removeProperty("transform")},G.v=function(H){return F=H,G},G.ne=function(){p(-_())},G.z=function(){p(0)},G.p=function(){p(_())},g.i(r)||G.h(),v[r]=G,k.appendChild(G),function(H,w){var m=H.elements,L=m.smw,N=m.sourceAnimationWrappers,Z=document.createElement("div"),ct=document.createElement("div");ct.className="fslightboxl";for(var mt=0;mt<3;mt++){var St=document.createElement("div");ct.appendChild(St)}Z.appendChild(ct),L[w].appendChild(Z),N[w]=Z}(i,r)}function Ce(i,r,g,E){var v=document.createElementNS("http://www.w3.org/2000/svg","svg");v.setAttributeNS(null,"width",r),v.setAttributeNS(null,"height",r),v.setAttributeNS(null,"viewBox",g);var k=document.createElementNS("http://www.w3.org/2000/svg","path");return k.setAttributeNS(null,"class","".concat(Y,"svg-path")),k.setAttributeNS(null,"d",E),v.appendChild(k),i.appendChild(v),v}function ge(i,r){var g=document.createElement("div");return g.className="".concat(Y,"toolbar-button ").concat(D),g.title=r,i.appendChild(g),g}function ve(i,r){var g=document.createElement("div");g.className="".concat(Y,"toolbar"),r.appendChild(g),function(E,v){var k=E.componentsServices,U=E.data,F=E.fs,G="M4.5 11H3v4h4v-1.5H4.5V11zM3 7h1.5V4.5H7V3H3v4zm10.5 6.5H11V15h4v-4h-1.5v2.5zM11 3v1.5h2.5V7H15V3h-4z",p=ge(v);p.title="Enter fullscreen";var _=Ce(p,"20px","0 0 18 18",G);k.ofs=function(){U.ifs=!0,p.title="Exit fullscreen",_.setAttributeNS(null,"width","24px"),_.setAttributeNS(null,"height","24px"),_.setAttributeNS(null,"viewBox","0 0 950 1024"),_.firstChild.setAttributeNS(null,"d","M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z")},k.xfs=function(){U.ifs=!1,p.title="Enter fullscreen",_.setAttributeNS(null,"width","20px"),_.setAttributeNS(null,"height","20px"),_.setAttributeNS(null,"viewBox","0 0 18 18"),_.firstChild.setAttributeNS(null,"d",G)},p.onclick=F.t}(i,g),function(E,v){var k=ge(v,"Close");k.onclick=E.core.lightboxCloser.closeLightbox,Ce(k,"20px","0 0 24 24","M 4.7070312 3.2929688 L 3.2929688 4.7070312 L 10.585938 12 L 3.2929688 19.292969 L 4.7070312 20.707031 L 12 13.414062 L 19.292969 20.707031 L 20.707031 19.292969 L 13.414062 12 L 20.707031 4.7070312 L 19.292969 3.2929688 L 12 10.585938 L 4.7070312 3.2929688 z")}(i,g)}function be(i){var r=i.props.sources,g=i.elements.container,E=document.createElement("div");E.className="".concat(Y,"nav"),g.appendChild(E),ve(i,E),r.length>1&&function(v,k){var U=v.componentsServices,F=v.props.sources,G=(v.stageIndexes,document.createElement("div"));G.className="".concat(Y,"slide-number-container");var p=document.createElement("div");p.className=D;var _=document.createElement("span");U.setSlideNumber=function(m){return _.innerHTML=m};var H=document.createElement("span");H.className="".concat(Y,"slash");var w=document.createElement("div");w.innerHTML=F.length,G.appendChild(p),p.appendChild(_),p.appendChild(H),p.appendChild(w),k.appendChild(G),setTimeout(function(){p.offsetWidth>55&&(G.style.justifyContent="flex-start")})}(i,E)}function Wt(i,r,g,E){var v=i.elements.container,k=g.charAt(0).toUpperCase()+g.slice(1),U=document.createElement("div");U.className="".concat(W," ").concat(W,"-").concat(g),U.title="".concat(k," slide"),U.onclick=r,function(F,G){var p=document.createElement("div");p.className="".concat(K," ").concat(D),Ce(p,"20px","0 0 20 20",G),F.appendChild(p)}(U,E),v.appendChild(U)}function oe(i){var r=i.core,g=r.lightboxCloser,E=r.slideChangeFacade,v=i.fs;this.listener=function(k){switch(k.key){case"Escape":g.closeLightbox();break;case"ArrowLeft":E.changeToPrevious();break;case"ArrowRight":E.changeToNext();break;case"F11":k.preventDefault(),v.t()}}}function Me(i){var r=i.elements,g=i.sourcePointerProps,E=i.stageIndexes;function v(k,U){r.smw[k].v(g.swipedX)[U]()}this.runActionsForEvent=function(k){var U,F,G;r.container.contains(r.slideSwipingHoverer)||r.container.appendChild(r.slideSwipingHoverer),U=r.container,F=X,(G=U.classList).contains(F)||G.add(F),g.swipedX=k.screenX-g.downScreenX;var p=E.previous,_=E.next;v(E.current,"z"),p!==void 0&&g.swipedX>0?v(p,"ne"):_!==void 0&&g.swipedX<0&&v(_,"p")}}function re(i){var r=i.props.sources,g=i.resolve,E=i.sourcePointerProps,v=g(Me);r.length===1?this.listener=function(){E.swipedX=1}:this.listener=function(k){E.isPointering&&v.runActionsForEvent(k)}}function Se(i){var r=i.core.slideIndexChanger,g=i.elements.smw,E=i.stageIndexes,v=i.sws;function k(F){var G=g[E.current];G.a(),G[F]()}function U(F,G){F!==void 0&&(g[F].s(),g[F][G]())}this.runPositiveSwipedXActions=function(){var F=E.previous;if(F===void 0)k("z");else{k("p");var G=E.next;r.changeTo(F);var p=E.previous;v.d(p),v.b(G),k("z"),U(p,"ne")}},this.runNegativeSwipedXActions=function(){var F=E.next;if(F===void 0)k("z");else{k("ne");var G=E.previous;r.changeTo(F);var p=E.next;v.d(p),v.b(G),k("z"),U(p,"p")}}}function se(i,r){i.contains(r)&&i.removeChild(r)}function J(i){var r=i.core.lightboxCloser,g=i.elements,E=i.resolve,v=i.sourcePointerProps,k=E(Se);this.runNoSwipeActions=function(){se(g.container,g.slideSwipingHoverer),v.isSourceDownEventTarget||r.closeLightbox(),v.isPointering=!1},this.runActions=function(){v.swipedX>0?k.runPositiveSwipedXActions():k.runNegativeSwipedXActions(),se(g.container,g.slideSwipingHoverer),g.container.classList.remove(X),v.isPointering=!1}}function s(i){var r=i.resolve,g=i.sourcePointerProps,E=r(J);this.listener=function(){g.isPointering&&(g.swipedX?E.runActions():E.runNoSwipeActions())}}function n(i){var r=this,g=i.core,E=g.eventsDispatcher,v=g.globalEventsController,k=g.scrollbarRecompensor,U=i.data,F=i.elements,G=i.fs,p=i.props,_=i.sourcePointerProps;this.isLightboxFadingOut=!1,this.runActions=function(){r.isLightboxFadingOut=!0,F.container.classList.add(z),v.removeListeners(),p.exitFullscreenOnClose&&U.ifs&&G.x(),setTimeout(function(){r.isLightboxFadingOut=!1,_.isPointering=!1,F.container.classList.remove(z),document.documentElement.classList.remove(Q),k.removeRecompense(),document.body.removeChild(F.container),E.dispatch("onClose")},270)}}function c(i,r){var g=i.classList;g.contains(r)&&g.remove(r)}function f(i){var r,g,E;g=(r=i).core.eventsDispatcher,E=r.props,g.dispatch=function(v){E[v]&&E[v]()},function(v){var k=v.componentsServices,U=v.data,F=v.fs,G=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"];function p(H){for(var w=0;w<G.length;w++)document[H](G[w],_)}function _(){document.fullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?k.ofs():k.xfs()}F.o=function(){k.ofs();var H=document.documentElement;H.requestFullscreen?H.requestFullscreen():H.mozRequestFullScreen?H.mozRequestFullScreen():H.webkitRequestFullscreen?H.webkitRequestFullscreen():H.msRequestFullscreen&&H.msRequestFullscreen()},F.x=function(){k.xfs(),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},F.t=function(){U.ifs?F.x():F.o()},F.l=function(){p("addEventListener")},F.q=function(){p("removeEventListener")}}(i),function(v){var k=v.core,U=k.globalEventsController,F=k.windowResizeActioner,G=v.fs,p=v.resolve,_=p(oe),H=p(re),w=p(s);U.attachListeners=function(){document.addEventListener("pointermove",H.listener),document.addEventListener("pointerup",w.listener),addEventListener("resize",F.runActions),document.addEventListener("keydown",_.listener),G.l()},U.removeListeners=function(){document.removeEventListener("pointermove",H.listener),document.removeEventListener("pointerup",w.listener),removeEventListener("resize",F.runActions),document.removeEventListener("keydown",_.listener),G.q()}}(i),function(v){var k=v.core.lightboxCloser,U=(0,v.resolve)(n);k.closeLightbox=function(){U.isLightboxFadingOut||U.runActions()}}(i),function(v){var k=v.data,U=v.core.scrollbarRecompensor;function F(){document.body.offsetHeight>innerHeight&&(document.body.style.marginRight=k.scrollbarWidth+"px")}U.addRecompense=function(){document.readyState==="complete"?F():addEventListener("load",function(){F(),U.addRecompense=F})},U.removeRecompense=function(){document.body.style.removeProperty("margin-right")}}(i),function(v){var k=v.core,U=k.slideChangeFacade,F=k.slideIndexChanger,G=k.stageManager;v.props.sources.length>1?(U.changeToPrevious=function(){F.jumpTo(G.getPreviousSlideIndex())},U.changeToNext=function(){F.jumpTo(G.getNextSlideIndex())}):(U.changeToPrevious=function(){},U.changeToNext=function(){})}(i),function(v){var k=v.componentsServices,U=v.core,F=U.slideIndexChanger,G=U.sourceDisplayFacade,p=U.stageManager,_=v.elements,H=_.smw,w=_.sourceAnimationWrappers,m=v.isl,L=v.stageIndexes,N=v.sws;F.changeTo=function(Z){L.current=Z,p.updateStageIndexes(),k.setSlideNumber(Z+1),G.displaySourcesWhichShouldBeDisplayed()},F.jumpTo=function(Z){var ct=L.previous,mt=L.current,St=L.next,$t=m[mt],te=m[Z];F.changeTo(Z);for(var Zt=0;Zt<H.length;Zt++)H[Zt].d();N.d(mt),N.c(),requestAnimationFrame(function(){requestAnimationFrame(function(){var Ae=L.previous,fe=L.next;function Re(){p.i(mt)?mt===L.previous?H[mt].ne():mt===L.next&&H[mt].p():(H[mt].h(),H[mt].n())}$t&&w[mt].classList.add(vt),te&&w[L.current].classList.add(nt),N.a(),Ae!==void 0&&Ae!==mt&&H[Ae].ne(),H[L.current].n(),fe!==void 0&&fe!==mt&&H[fe].p(),N.b(ct),N.b(St),m[mt]?setTimeout(Re,260):Re()})})}}(i),function(v){var k=v.core.sourcesPointerDown,U=v.elements,F=U.smw,G=U.sources,p=v.sourcePointerProps,_=v.stageIndexes;k.listener=function(H){H.target.tagName!=="VIDEO"&&H.preventDefault(),p.isPointering=!0,p.downScreenX=H.screenX,p.swipedX=0;var w=G[_.current];w&&w.contains(H.target)?p.isSourceDownEventTarget=!0:p.isSourceDownEventTarget=!1;for(var m=0;m<F.length;m++)F[m].d()}}(i),function(v){var k=v.collections.sourcesRenderFunctions,U=v.core.sourceDisplayFacade,F=v.props,G=v.stageIndexes;function p(_){k[_]&&(k[_](),delete k[_])}U.displaySourcesWhichShouldBeDisplayed=function(){if(F.loadOnlyCurrentSource)p(G.current);else for(var _ in G)p(G[_])}}(i),function(v){var k=v.core.stageManager,U=v.elements,F=U.smw,G=U.sourceAnimationWrappers,p=v.isl,_=v.stageIndexes,H=v.sws;H.a=function(){for(var w in _)F[_[w]].s()},H.b=function(w){w===void 0||k.i(w)||(F[w].h(),F[w].n())},H.c=function(){for(var w in _)H.d(_[w])},H.d=function(w){if(p[w]){var m=G[w];c(m,at),c(m,nt),c(m,vt)}}}(i),function(v){var k=v.collections.sourceSizers,U=v.core.windowResizeActioner,F=v.data,G=v.elements.smw,p=v.stageIndexes;U.runActions=function(){innerWidth<992?F.maxSourceWidth=innerWidth:F.maxSourceWidth=.9*innerWidth,F.maxSourceHeight=.9*innerHeight;for(var _=0;_<G.length;_++)G[_].d(),k[_]&&k[_].adjustSize();var H=p.previous,w=p.next;H!==void 0&&G[H].ne(),w!==void 0&&G[w].p()}}(i)}function o(i){var r=i.componentsServices,g=i.core,E=g.eventsDispatcher,v=g.globalEventsController,k=g.scrollbarRecompensor,U=g.sourceDisplayFacade,F=g.stageManager,G=g.windowResizeActioner,p=i.data,_=i.elements,H=(i.props,i.stageIndexes),w=i.sws;function m(){var L,N;p.i=!0,p.scrollbarWidth=function(){var Z=document.createElement("div"),ct=Z.style,mt=document.createElement("div");ct.visibility="hidden",ct.width="100px",ct.msOverflowStyle="scrollbar",ct.overflow="scroll",mt.style.width="100%",document.body.appendChild(Z);var St=Z.offsetWidth;Z.appendChild(mt);var $t=mt.offsetWidth;return document.body.removeChild(Z),St-$t}(),f(i),_.container=document.createElement("div"),_.container.className="".concat(Y,"container ").concat(B," ").concat(at),function(Z){var ct=Z.elements;ct.slideSwipingHoverer=document.createElement("div"),ct.slideSwipingHoverer.className="".concat(Y,"slide-swiping-hoverer ").concat(B," ").concat(R)}(i),be(i),function(Z){var ct=Z.core.sourcesPointerDown,mt=Z.elements,St=Z.props.sources,$t=document.createElement("div");$t.className="".concat(R," ").concat(B),mt.container.appendChild($t),$t.addEventListener("pointerdown",ct.listener),mt.sourceWrappersContainer=$t;for(var te=0;te<St.length;te++)le(Z,te)}(i),i.props.sources.length>1&&(N=(L=i).core.slideChangeFacade,Wt(L,N.changeToPrevious,"previous","M18.271,9.212H3.615l4.184-4.184c0.306-0.306,0.306-0.801,0-1.107c-0.306-0.306-0.801-0.306-1.107,0L1.21,9.403C1.194,9.417,1.174,9.421,1.158,9.437c-0.181,0.181-0.242,0.425-0.209,0.66c0.005,0.038,0.012,0.071,0.022,0.109c0.028,0.098,0.075,0.188,0.142,0.271c0.021,0.026,0.021,0.061,0.045,0.085c0.015,0.016,0.034,0.02,0.05,0.033l5.484,5.483c0.306,0.307,0.801,0.307,1.107,0c0.306-0.305,0.306-0.801,0-1.105l-4.184-4.185h14.656c0.436,0,0.788-0.353,0.788-0.788S18.707,9.212,18.271,9.212z"),Wt(L,N.changeToNext,"next","M1.729,9.212h14.656l-4.184-4.184c-0.307-0.306-0.307-0.801,0-1.107c0.305-0.306,0.801-0.306,1.106,0l5.481,5.482c0.018,0.014,0.037,0.019,0.053,0.034c0.181,0.181,0.242,0.425,0.209,0.66c-0.004,0.038-0.012,0.071-0.021,0.109c-0.028,0.098-0.075,0.188-0.143,0.271c-0.021,0.026-0.021,0.061-0.045,0.085c-0.015,0.016-0.034,0.02-0.051,0.033l-5.483,5.483c-0.306,0.307-0.802,0.307-1.106,0c-0.307-0.305-0.307-0.801,0-1.105l4.184-4.185H1.729c-0.436,0-0.788-0.353-0.788-0.788S1.293,9.212,1.729,9.212z")),function(Z){for(var ct=Z.props.sources,mt=Z.resolve,St=mt(yt),$t=mt(Ut),te=mt(ne,[St,$t]),Zt=0;Zt<ct.length;Zt++)if(typeof ct[Zt]=="string"){var Ae=te.getTypeSetByClientForIndex(Zt);if(Ae)$t.runActionsForSourceTypeAndIndex(Ae,Zt);else{var fe=St.getSourceTypeFromLocalStorageByUrl(ct[Zt]);fe?$t.runActionsForSourceTypeAndIndex(fe,Zt):te.retrieveTypeWithXhrForIndex(Zt)}}else $t.runActionsForSourceTypeAndIndex("custom",Zt)}(i),E.dispatch("onInit")}i.open=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=H.previous,Z=H.current,ct=H.next;H.current=L,p.i||ot(i),F.updateStageIndexes(),p.i?(w.c(),w.a(),w.b(N),w.b(Z),w.b(ct),E.dispatch("onShow")):m(),U.displaySourcesWhichShouldBeDisplayed(),r.setSlideNumber(L+1),document.body.appendChild(_.container),document.documentElement.classList.add(Q),k.addRecompense(),v.attachListeners(),G.runActions(),_.smw[H.current].n(),E.dispatch("onOpen")}}function A(i,r,g){return(A=b()?Reflect.construct.bind():function(E,v,k){var U=[null];U.push.apply(U,v);var F=new(Function.bind.apply(E,U));return k&&y(F,k.prototype),F}).apply(null,arguments)}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(i,r){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,E){return g.__proto__=E,g})(i,r)}function u(i){return function(r){if(Array.isArray(r))return a(r)}(i)||function(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}(i)||function(r,g){if(r){if(typeof r=="string")return a(r,g);var E=Object.prototype.toString.call(r).slice(8,-1);if(E==="Object"&&r.constructor&&(E=r.constructor.name),E==="Map"||E==="Set")return Array.from(r);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return a(r,g)}}(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function a(i,r){(r==null||r>i.length)&&(r=i.length);for(var g=0,E=new Array(r);g<r;g++)E[g]=i[g];return E}function h(){for(var i=document.getElementsByTagName("a"),r=function(v){if(!i[v].hasAttribute("data-fslightbox"))return"continue";var k=i[v].hasAttribute("data-href")?i[v].getAttribute("data-href"):i[v].getAttribute("href");if(!k)return console.warn('The "data-fslightbox" attribute was set without the "href" attribute.'),"continue";var U=i[v].getAttribute("data-fslightbox");fsLightboxInstances[U]||(fsLightboxInstances[U]=new FsLightbox);var F=null;k.charAt(0)==="#"?(F=document.getElementById(k.substring(1)).cloneNode(!0)).removeAttribute("id"):F=k,fsLightboxInstances[U].props.sources.push(F),fsLightboxInstances[U].elements.a.push(i[v]);var G=fsLightboxInstances[U].props.sources.length-1;i[v].onclick=function(N){N.preventDefault(),fsLightboxInstances[U].open(G)},L("types","data-type"),L("videosPosters","data-video-poster"),L("customClasses","data-class"),L("customClasses","data-custom-class");for(var p=["href","data-fslightbox","data-href","data-type","data-video-poster","data-class","data-custom-class"],_=i[v].attributes,H=fsLightboxInstances[U].props.customAttributes,w=0;w<_.length;w++)if(p.indexOf(_[w].name)===-1&&_[w].name.substr(0,5)==="data-"){H[G]||(H[G]={});var m=_[w].name.substr(5);H[G][m]=_[w].value}function L(N,Z){i[v].hasAttribute(Z)&&(fsLightboxInstances[U].props[N][G]=i[v].getAttribute(Z))}},g=0;g<i.length;g++)r(g);var E=Object.keys(fsLightboxInstances);window.fsLightbox=fsLightboxInstances[E[E.length-1]]}window.FsLightbox=function(){var i=this;this.props={sources:[],customAttributes:[],customClasses:[],types:[],videosPosters:[],slideDistance:.3},this.data={isFullscreenOpen:!1,maxSourceWidth:0,maxSourceHeight:0,scrollbarWidth:0},this.isl=[],this.sourcePointerProps={downScreenX:null,isPointering:!1,isSourceDownEventTarget:!1,swipedX:0},this.stageIndexes={},this.elements={a:[],container:null,slideSwipingHoverer:null,smw:[],sourceWrappersContainer:null,sources:[],sourceAnimationWrappers:[]},this.componentsServices={setSlideNumber:function(){}},this.resolve=function(r){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return g.unshift(i),A(r,u(g))},this.collections={sourceLoadHandlers:[],sourcesRenderFunctions:[],sourceSizers:[]},this.core={eventsDispatcher:{},globalEventsController:{},lightboxCloser:{},lightboxUpdater:{},scrollbarRecompensor:{},slideChangeFacade:{},slideIndexChanger:{},sourcesPointerDown:{},sourceDisplayFacade:{},stageManager:{},windowResizeActioner:{}},this.fs={},this.sws={},o(this),this.close=function(){return i.core.lightboxCloser.closeLightbox()}},window.fsLightboxInstances={},h(),window.refreshFsLightbox=function(){for(var i in fsLightboxInstances){var r=fsLightboxInstances[i].props;fsLightboxInstances[i]=new FsLightbox,fsLightboxInstances[i].props=r,fsLightboxInstances[i].props.sources=[],fsLightboxInstances[i].elements.a=[]}h()}}])})})(za);const Ba="https://cdn.jsdelivr.net/gh/daimular-ito11/ui-demo-v2/dist/cmaps/",Va="https://cdn.jsdelivr.net/gh/daimular-ito11/ui-demo-v2/dist/pdf.worker.mjs";class $a{constructor(_t,lt=1){if(!_t||!_t.dataset.url)throw new Error("invalid element!");this.element=_t,this.url=_t.dataset.url,this.scale=lt,this.data=[]}loading(_t){_t?this.element.classList.add("pdf-preview__loading"):this.element.classList.remove("pdf-preview__loading")}async fetchFile(){return this.loading(!0),fetch(this.url,{headers:{"Content-Type":"application/pdf"}}).then(_t=>_t.blob()).then(_t=>this.blobtoDataUrl(_t)).then(_t=>this.draw(_t))}blobtoDataUrl(_t){return new Promise(lt=>{const d=new FileReader;d.readAsDataURL(_t),d.onload=()=>{lt(d.result.replace("data:application/pdf;base64,",""))}})}draw(_t){Ha.workerSrc=Va,Ua({data:atob(_t),cMapUrl:Ba,cMapPacked:!0}).promise.then(async lt=>{for(let d=1;d<=lt.numPages;d++)await this.getPage(d,lt)},lt=>{console.error(lt)}).then(()=>{const lt=document.createElement("img");lt.setAttribute("class","pdf-preview__image"),lt.onload=()=>{this.element.addEventListener("click",this.display(this.data)),this.element.appendChild(lt),this.loading(!1)},lt.src=this.data[0]})}display(_t){var lt=new FsLightbox;return lt.props.sources=_t,refreshFsLightbox(),()=>{lt.open()}}async getPage(_t,lt){const d=this.scale,et=this.data;return new Promise(I=>{lt.getPage(_t).then(function(Y){var gt=Y.getViewport({scale:d}),X=document.createElement("canvas"),B=X.getContext("2d");X.height=gt.height,X.width=gt.width;var D={canvasContext:B,viewport:gt},Q=Y.render(D);Q.promise.then(async()=>{et.push(X.toDataURL("image/png")),I()})})})}}document.querySelectorAll('[data-role="pdf-preview"]').forEach(Lt=>{new $a(Lt).fetchFile()});const hr=document.querySelector('[data-role="zip-search_input"]'),xi=document.querySelector('[data-role="zip-search_btn"'),Ga=document.querySelector("#prefecture"),qa=document.querySelector("#city"),Wa=document.querySelector("#street"),ja=document.querySelector("#js-zip_error"),Ka="https://api.zipaddress.net/";var on="",_i="";hr&&xi&&(hr.addEventListener("input",Ya),xi.addEventListener("click",Ja));async function Xa(){const Lt=`${Ka}?zipcode=${on}`;return fetch(Lt).then(_t=>_t.json()).then(_t=>_t.code!==200?{data:_t.message,error:!0}:{data:_t.data,error:!1})}function Ya(Lt){const _t=Lt.target.value;xi.disabled=!0,_i="",_t.length===7?(on=_t,xi.disabled=!1):_t.length!=0&&(_i="7\u6841\u306E\u6570\u5B57\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\u3002"),lr()}async function Ja(){var Lt;if(on.length===7){const _t=await Xa();if(_t.error){_i=_t.data,lr();return}Ga.value=hn[Lt=_t.data.pref]??(hn[Lt]=""),qa.value=_t.data.city,Wa.value=_t.data.town}}function lr(){ja.textContent=_i}const hn={\u5317\u6D77\u9053:1,\u9752\u68EE\u770C:2,\u5CA9\u624B\u770C:3,\u5BAE\u57CE\u770C:4,\u79CB\u7530\u770C:5,\u5C71\u5F62\u770C:6,\u798F\u5CF6\u770C:7,\u8328\u57CE\u770C:8,\u6803\u6728\u770C:9,\u7FA4\u99AC\u770C:10,\u57FC\u7389\u770C:11,\u5343\u8449\u770C:12,\u6771\u4EAC\u90FD:13,\u795E\u5948\u5DDD\u770C:14,\u65B0\u6F5F\u770C:15,\u5BCC\u5C71\u770C:16,\u77F3\u5DDD\u770C:17,\u798F\u4E95\u770C:18,\u5C71\u68A8\u770C:19,\u9577\u91CE\u770C:20,\u5C90\u961C\u770C:21,\u9759\u5CA1\u770C:22,\u611B\u77E5\u770C:23,\u4E09\u91CD\u770C:24,\u6ECB\u8CC0\u770C:25,\u4EAC\u90FD\u5E9C:26,\u5927\u962A\u5E9C:27,\u5175\u5EAB\u770C:28,\u5948\u826F\u770C:29,\u548C\u6B4C\u5C71\u770C:30,\u9CE5\u53D6\u770C:31,\u5CF6\u6839\u770C:32,\u5CA1\u5C71\u770C:33,\u5E83\u5CF6\u770C:34,\u5C71\u53E3\u770C:35,\u5FB3\u5CF6\u770C:36,\u9999\u5DDD\u770C:37,\u611B\u5A9B\u770C:38,\u9AD8\u77E5\u770C:39,\u798F\u5CA1\u770C:40,\u4F50\u8CC0\u770C:41,\u9577\u5D0E\u770C:42,\u718A\u672C\u770C:43,\u5927\u5206\u770C:44,\u5BAE\u5D0E\u770C:45,\u9E7F\u5150\u5CF6\u770C:46,\u6C96\u7E04\u770C:47}})();
